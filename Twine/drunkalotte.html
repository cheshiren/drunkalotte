<!DOCTYPE html><!-- saved from url=(0014)about:internet -->
<html class="init-no-js">
<head>
<meta charset="UTF-8" />
<title>SugarCube</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<!--

SugarCube (v2.0.0-beta.8): A free (gratis and libre) story format, based on TiddlyWiki.

Copyright © 2013–2015 Thomas Michael Edwards <tmedwards@motoslave.net>.
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met: 

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer. 
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution. 

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<!--

Build Info:
  * Built on 09 Feb 2016 at 22:39:46, +0500
  * Made in Twee 1.4.3

-->
<script id="script-init" type="text/javascript">
if(!document.head||!document.querySelector||!document.addEventListener||!JSON||!Object.getPrototypeOf||!Object.freeze){document.documentElement.className="init-lacking";}else{document.documentElement.className="init-loading";
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */
if("document" in self){if(!("classList" in document.createElement("_"))){(function(j){"use strict";if(!("Element" in j)){return}var a="classList",f="prototype",m=j.Element[f],b=Object,k=String[f].trim||function(){return this.replace(/^\s+|\s+$/g,"")},c=Array[f].indexOf||function(q){var p=0,o=this.length;for(;p<o;p++){if(p in this&&this[p]===q){return p}}return -1},n=function(o,p){this.name=o;this.code=DOMException[o];this.message=p},g=function(p,o){if(o===""){throw new n("SYNTAX_ERR","An invalid or illegal string was specified")}if(/\s/.test(o)){throw new n("INVALID_CHARACTER_ERR","String contains an invalid character")}return c.call(p,o)},d=function(s){var r=k.call(s.getAttribute("class")||""),q=r?r.split(/\s+/):[],p=0,o=q.length;for(;p<o;p++){this.push(q[p])}this._updateClassName=function(){s.setAttribute("class",this.toString())}},e=d[f]=[],i=function(){return new d(this)};n[f]=Error[f];e.item=function(o){return this[o]||null};e.contains=function(o){o+="";return g(this,o)!==-1};e.add=function(){var s=arguments,r=0,p=s.length,q,o=false;do{q=s[r]+"";if(g(this,q)===-1){this.push(q);o=true}}while(++r<p);if(o){this._updateClassName()}};e.remove=function(){var t=arguments,s=0,p=t.length,r,o=false,q;do{r=t[s]+"";q=g(this,r);while(q!==-1){this.splice(q,1);o=true;q=g(this,r)}}while(++s<p);if(o){this._updateClassName()}};e.toggle=function(p,q){p+="";var o=this.contains(p),r=o?q!==true&&"remove":q!==false&&"add";if(r){this[r](p)}if(q===true||q===false){return q}else{return !o}};e.toString=function(){return this.join(" ")};if(b.defineProperty){var l={get:i,enumerable:true,configurable:true};try{b.defineProperty(m,a,l)}catch(h){if(h.number===-2146823252){l.enumerable=false;b.defineProperty(m,a,l)}}}else{if(b[f].__defineGetter__){m.__defineGetter__(a,i)}}}(self))}else{(function(){var b=document.createElement("_");b.classList.add("c1","c2");if(!b.classList.contains("c2")){var c=function(e){var d=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(h){var g,f=arguments.length;for(g=0;g<f;g++){h=arguments[g];d.call(this,h)}}};c("add");c("remove")}b.classList.toggle("c3",false);if(b.classList.contains("c3")){var a=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(d,e){if(1 in arguments&&!this.contains(d)===!e){return e}else{return a.call(this,d)}}}b=null}())}};
/*! es5-shim: v4.1.13 (https://github.com/es-shims/es5-shim) | @license es5-shim Copyright 2009-2015 by contributors, MIT License | see https://github.com/es-shims/es5-shim/blob/v4.1.13/LICENSE */
(function(e,t){"use strict";if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){var e=Array;var t=e.prototype;var r=Object;var n=r.prototype;var i=Function.prototype;var a=String;var o=a.prototype;var l=Number;var u=l.prototype;var f=t.slice;var s=t.splice;var c=t.push;var v=t.unshift;var p=t.concat;var h=i.call;var g=Math.max;var y=Math.min;var d=n.toString;var w=typeof Symbol==="function"&&typeof Symbol.toStringTag==="symbol";var m;var b=Function.prototype.toString,T=function tryFunctionObject(e){try{b.call(e);return true}catch(t){return false}},x="[object Function]",O="[object GeneratorFunction]";m=function isCallable(e){if(typeof e!=="function"){return false}if(w){return T(e)}var t=d.call(e);return t===x||t===O};var S;var j=RegExp.prototype.exec,E=function tryRegexExec(e){try{j.call(e);return true}catch(t){return false}},I="[object RegExp]";S=function isRegex(e){if(typeof e!=="object"){return false}return w?E(e):d.call(e)===I};var D;var k=String.prototype.valueOf,N=function tryStringObject(e){try{k.call(e);return true}catch(t){return false}},F="[object String]";D=function isString(e){if(typeof e==="string"){return true}if(typeof e!=="object"){return false}return w?N(e):d.call(e)===F};var M=function(e){var t=r.defineProperty&&function(){try{var e={};r.defineProperty(e,"x",{enumerable:false,value:e});for(var t in e){return false}return e.x===e}catch(n){return false}}();var n;if(t){n=function(e,t,n,i){if(!i&&t in e){return}r.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:n})}}else{n=function(e,t,r,n){if(!n&&t in e){return}e[t]=r}}return function defineProperties(t,r,i){for(var a in r){if(e.call(r,a)){n(t,a,r[a],i)}}}}(n.hasOwnProperty);var R=function isPrimitive(e){var t=typeof e;return e===null||t!=="object"&&t!=="function"};var A={ToInteger:function ToInteger(e){var t=+e;if(t!==t){t=0}else if(t!==0&&t!==1/0&&t!==-(1/0)){t=(t>0||-1)*Math.floor(Math.abs(t))}return t},ToPrimitive:function ToPrimitive(e){var t,r,n;if(R(e)){return e}r=e.valueOf;if(m(r)){t=r.call(e);if(R(t)){return t}}n=e.toString;if(m(n)){t=n.call(e);if(R(t)){return t}}throw new TypeError},ToObject:function(e){if(e==null){throw new TypeError("can't convert "+e+" to object")}return r(e)},ToUint32:function ToUint32(e){return e>>>0}};var U=function Empty(){};M(i,{bind:function bind(e){var t=this;if(!m(t)){throw new TypeError("Function.prototype.bind called on incompatible "+t)}var n=f.call(arguments,1);var i;var a=function(){if(this instanceof i){var a=t.apply(this,p.call(n,f.call(arguments)));if(r(a)===a){return a}return this}else{return t.apply(e,p.call(n,f.call(arguments)))}};var o=g(0,t.length-n.length);var l=[];for(var u=0;u<o;u++){c.call(l,"$"+u)}i=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this, arguments); }")(a);if(t.prototype){U.prototype=t.prototype;i.prototype=new U;U.prototype=null}return i}});var $=h.bind(n.hasOwnProperty);var C=h.bind(n.toString);var P=h.bind(o.slice);var Z=h.bind(o.split);var J=e.isArray||function isArray(e){return C(e)==="[object Array]"};var z=[].unshift(0)!==1;M(t,{unshift:function(){v.apply(this,arguments);return this.length}},z);M(e,{isArray:J});var B=r("a");var G=B[0]!=="a"||!(0 in B);var H=function properlyBoxed(e){var t=true;var r=true;if(e){e.call("foo",function(e,r,n){if(typeof n!=="object"){t=false}});e.call([1],function(){"use strict";r=typeof this==="string"},"x")}return!!e&&t&&r};M(t,{forEach:function forEach(e){var t=A.ToObject(this);var r=G&&D(this)?Z(this,""):t;var n=-1;var i=r.length>>>0;var a;if(arguments.length>1){a=arguments[1]}if(!m(e)){throw new TypeError("Array.prototype.forEach callback must be a function")}while(++n<i){if(n in r){if(typeof a!=="undefined"){e.call(a,r[n],n,t)}else{e(r[n],n,t)}}}}},!H(t.forEach));M(t,{map:function map(t){var r=A.ToObject(this);var n=G&&D(this)?Z(this,""):r;var i=n.length>>>0;var a=e(i);var o;if(arguments.length>1){o=arguments[1]}if(!m(t)){throw new TypeError("Array.prototype.map callback must be a function")}for(var l=0;l<i;l++){if(l in n){if(typeof o!=="undefined"){a[l]=t.call(o,n[l],l,r)}else{a[l]=t(n[l],l,r)}}}return a}},!H(t.map));M(t,{filter:function filter(e){var t=A.ToObject(this);var r=G&&D(this)?Z(this,""):t;var n=r.length>>>0;var i=[];var a;var o;if(arguments.length>1){o=arguments[1]}if(!m(e)){throw new TypeError("Array.prototype.filter callback must be a function")}for(var l=0;l<n;l++){if(l in r){a=r[l];if(typeof o==="undefined"?e(a,l,t):e.call(o,a,l,t)){c.call(i,a)}}}return i}},!H(t.filter));M(t,{every:function every(e){var t=A.ToObject(this);var r=G&&D(this)?Z(this,""):t;var n=r.length>>>0;var i;if(arguments.length>1){i=arguments[1]}if(!m(e)){throw new TypeError("Array.prototype.every callback must be a function")}for(var a=0;a<n;a++){if(a in r&&!(typeof i==="undefined"?e(r[a],a,t):e.call(i,r[a],a,t))){return false}}return true}},!H(t.every));M(t,{some:function some(e){var t=A.ToObject(this);var r=G&&D(this)?Z(this,""):t;var n=r.length>>>0;var i;if(arguments.length>1){i=arguments[1]}if(!m(e)){throw new TypeError("Array.prototype.some callback must be a function")}for(var a=0;a<n;a++){if(a in r&&(typeof i==="undefined"?e(r[a],a,t):e.call(i,r[a],a,t))){return true}}return false}},!H(t.some));var L=false;if(t.reduce){L=typeof t.reduce.call("es5",function(e,t,r,n){return n})==="object"}M(t,{reduce:function reduce(e){var t=A.ToObject(this);var r=G&&D(this)?Z(this,""):t;var n=r.length>>>0;if(!m(e)){throw new TypeError("Array.prototype.reduce callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduce of empty array with no initial value")}var i=0;var a;if(arguments.length>=2){a=arguments[1]}else{do{if(i in r){a=r[i++];break}if(++i>=n){throw new TypeError("reduce of empty array with no initial value")}}while(true)}for(;i<n;i++){if(i in r){a=e(a,r[i],i,t)}}return a}},!L);var X=false;if(t.reduceRight){X=typeof t.reduceRight.call("es5",function(e,t,r,n){return n})==="object"}M(t,{reduceRight:function reduceRight(e){var t=A.ToObject(this);var r=G&&D(this)?Z(this,""):t;var n=r.length>>>0;if(!m(e)){throw new TypeError("Array.prototype.reduceRight callback must be a function")}if(n===0&&arguments.length===1){throw new TypeError("reduceRight of empty array with no initial value")}var i;var a=n-1;if(arguments.length>=2){i=arguments[1]}else{do{if(a in r){i=r[a--];break}if(--a<0){throw new TypeError("reduceRight of empty array with no initial value")}}while(true)}if(a<0){return i}do{if(a in r){i=e(i,r[a],a,t)}}while(a--);return i}},!X);var Y=t.indexOf&&[0,1].indexOf(1,2)!==-1;M(t,{indexOf:function indexOf(e){var t=G&&D(this)?Z(this,""):A.ToObject(this);var r=t.length>>>0;if(r===0){return-1}var n=0;if(arguments.length>1){n=A.ToInteger(arguments[1])}n=n>=0?n:g(0,r+n);for(;n<r;n++){if(n in t&&t[n]===e){return n}}return-1}},Y);var q=t.lastIndexOf&&[0,1].lastIndexOf(0,-3)!==-1;M(t,{lastIndexOf:function lastIndexOf(e){var t=G&&D(this)?Z(this,""):A.ToObject(this);var r=t.length>>>0;if(r===0){return-1}var n=r-1;if(arguments.length>1){n=y(n,A.ToInteger(arguments[1]))}n=n>=0?n:r-Math.abs(n);for(;n>=0;n--){if(n in t&&e===t[n]){return n}}return-1}},q);var K=function(){var e=[1,2];var t=e.splice();return e.length===2&&J(t)&&t.length===0}();M(t,{splice:function splice(e,t){if(arguments.length===0){return[]}else{return s.apply(this,arguments)}}},!K);var Q=function(){var e={};t.splice.call(e,0,0,1);return e.length===1}();M(t,{splice:function splice(e,t){if(arguments.length===0){return[]}var r=arguments;this.length=g(A.ToInteger(this.length),0);if(arguments.length>0&&typeof t!=="number"){r=f.call(arguments);if(r.length<2){c.call(r,this.length-e)}else{r[1]=A.ToInteger(t)}}return s.apply(this,r)}},!Q);var V=function(){var t=new e(1e5);t[8]="x";t.splice(1,1);return t.indexOf("x")===7}();var W=function(){var e=256;var t=[];t[e]="a";t.splice(e+1,0,"b");return t[e]==="a"}();M(t,{splice:function splice(e,t){var r=A.ToObject(this);var n=[];var i=A.ToUint32(r.length);var o=A.ToInteger(e);var l=o<0?g(i+o,0):y(o,i);var u=y(g(A.ToInteger(t),0),i-l);var s=0;var c;while(s<u){c=a(l+s);if($(r,c)){n[s]=r[c]}s+=1}var v=f.call(arguments,2);var p=v.length;var h;if(p<u){s=l;while(s<i-u){c=a(s+u);h=a(s+p);if($(r,c)){r[h]=r[c]}else{delete r[h]}s+=1}s=i;while(s>i-u+p){delete r[s-1];s-=1}}else if(p>u){s=i-u;while(s>l){c=a(s+u-1);h=a(s+p-1);if($(r,c)){r[h]=r[c]}else{delete r[h]}s-=1}}s=l;for(var d=0;d<v.length;++d){r[s]=v[d];s+=1}r.length=i-u+p;return n}},!V||!W);var _=!{toString:null}.propertyIsEnumerable("toString");var ee=function(){}.propertyIsEnumerable("prototype");var te=!$("x","0");var re=function(e){var t=e.constructor;return t&&t.prototype===e};var ne={$window:true,$console:true,$parent:true,$self:true,$frames:true,$frameElement:true,$webkitIndexedDB:true,$webkitStorageInfo:true};var ie=function(){if(typeof window==="undefined"){return false}for(var e in window){if(!ne["$"+e]&&$(window,e)&&window[e]!==null&&typeof window[e]==="object"){try{re(window[e])}catch(t){return true}}}return false}();var ae=function(e){if(typeof window==="undefined"||!ie){return re(e)}try{return re(e)}catch(t){return false}};var oe=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];var le=oe.length;var ue=function isArguments(e){return C(e)==="[object Arguments]"};var fe=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&!J(e)&&m(e.callee)};var se=ue(arguments)?ue:fe;M(r,{keys:function keys(e){var t=m(e);var r=se(e);var n=e!==null&&typeof e==="object";var i=n&&D(e);if(!n&&!t&&!r){throw new TypeError("Object.keys called on a non-object")}var o=[];var l=ee&&t;if(i&&te||r){for(var u=0;u<e.length;++u){c.call(o,a(u))}}if(!r){for(var f in e){if(!(l&&f==="prototype")&&$(e,f)){c.call(o,a(f))}}}if(_){var s=ae(e);for(var v=0;v<le;v++){var p=oe[v];if(!(s&&p==="constructor")&&$(e,p)){c.call(o,p)}}}return o}});var ce=r.keys&&function(){return r.keys(arguments).length===2}(1,2);var ve=r.keys&&function(){var e=r.keys(arguments);return arguments.length!==1||e.length!==1||e[0]!==1}(1);var pe=r.keys;M(r,{keys:function keys(e){if(se(e)){return pe(f.call(e))}else{return pe(e)}}},!ce||ve);var he=-621987552e5;var ge="-000001";var ye=Date.prototype.toISOString&&new Date(he).toISOString().indexOf(ge)===-1;var de=Date.prototype.toISOString&&new Date(-1).toISOString()!=="1969-12-31T23:59:59.999Z";M(Date.prototype,{toISOString:function toISOString(){var e,t,r,n,i;if(!isFinite(this)){throw new RangeError("Date.prototype.toISOString called on non-finite value.")}n=this.getUTCFullYear();i=this.getUTCMonth();n+=Math.floor(i/12);i=(i%12+12)%12;e=[i+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()];n=(n<0?"-":n>9999?"+":"")+P("00000"+Math.abs(n),0<=n&&n<=9999?-4:-6);t=e.length;while(t--){r=e[t];if(r<10){e[t]="0"+r}}return n+"-"+f.call(e,0,2).join("-")+"T"+f.call(e,2).join(":")+"."+P("000"+this.getUTCMilliseconds(),-3)+"Z"}},ye||de);var we=function(){try{return Date.prototype.toJSON&&new Date(NaN).toJSON()===null&&new Date(he).toJSON().indexOf(ge)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return true}})}catch(e){return false}}();if(!we){Date.prototype.toJSON=function toJSON(e){var t=r(this);var n=A.ToPrimitive(t);if(typeof n==="number"&&!isFinite(n)){return null}var i=t.toISOString;if(!m(i)){throw new TypeError("toISOString property is not callable")}return i.call(t)}}var me=Date.parse("+033658-09-27T01:46:40.000Z")===1e15;var be=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z"))||!isNaN(Date.parse("2012-12-31T23:59:60.000Z"));var Te=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));if(Te||be||!me){Date=function(e){var t=function Date(r,n,i,o,l,u,f){var s=arguments.length;var c;if(this instanceof e){c=s===1&&a(r)===r?new e(t.parse(r)):s>=7?new e(r,n,i,o,l,u,f):s>=6?new e(r,n,i,o,l,u):s>=5?new e(r,n,i,o,l):s>=4?new e(r,n,i,o):s>=3?new e(r,n,i):s>=2?new e(r,n):s>=1?new e(r):new e}else{c=e.apply(this,arguments)}if(!R(c)){M(c,{constructor:t},true)}return c};var r=new RegExp("^"+"(\\d{4}|[+-]\\d{6})"+"(?:-(\\d{2})"+"(?:-(\\d{2})"+"(?:"+"T(\\d{2})"+":(\\d{2})"+"(?:"+":(\\d{2})"+"(?:(\\.\\d{1,}))?"+")?"+"("+"Z|"+"(?:"+"([-+])"+"(\\d{2})"+":(\\d{2})"+")"+")?)?)?)?"+"$");var n=[0,31,59,90,120,151,181,212,243,273,304,334,365];var i=function dayFromMonth(e,t){var r=t>1?1:0;return n[t]+Math.floor((e-1969+r)/4)-Math.floor((e-1901+r)/100)+Math.floor((e-1601+r)/400)+365*(e-1970)};var o=function toUTC(t){return l(new e(1970,0,1,0,0,0,t))};for(var u in e){if($(e,u)){t[u]=e[u]}}M(t,{now:e.now,UTC:e.UTC},true);t.prototype=e.prototype;M(t.prototype,{constructor:t},true);var f=function parse(t){var n=r.exec(t);if(n){var a=l(n[1]),u=l(n[2]||1)-1,f=l(n[3]||1)-1,s=l(n[4]||0),c=l(n[5]||0),v=l(n[6]||0),p=Math.floor(l(n[7]||0)*1e3),h=Boolean(n[4]&&!n[8]),g=n[9]==="-"?1:-1,y=l(n[10]||0),d=l(n[11]||0),w;if(s<(c>0||v>0||p>0?24:25)&&c<60&&v<60&&p<1e3&&u>-1&&u<12&&y<24&&d<60&&f>-1&&f<i(a,u+1)-i(a,u)){w=((i(a,u)+f)*24+s+y*g)*60;w=((w+c+d*g)*60+v)*1e3+p;if(h){w=o(w)}if(-864e13<=w&&w<=864e13){return w}}return NaN}return e.parse.apply(this,arguments)};M(t,{parse:f});return t}(Date)}if(!Date.now){Date.now=function now(){return(new Date).getTime()}}var xe=u.toFixed&&(8e-5.toFixed(3)!=="0.000"||.9.toFixed(0)!=="1"||1.255.toFixed(2)!=="1.25"||0xde0b6b3a7640080.toFixed(0)!=="1000000000000000128");var Oe={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function multiply(e,t){var r=-1;var n=t;while(++r<Oe.size){n+=e*Oe.data[r];Oe.data[r]=n%Oe.base;n=Math.floor(n/Oe.base)}},divide:function divide(e){var t=Oe.size,r=0;while(--t>=0){r+=Oe.data[t];Oe.data[t]=Math.floor(r/e);r=r%e*Oe.base}},numToString:function numToString(){var e=Oe.size;var t="";while(--e>=0){if(t!==""||e===0||Oe.data[e]!==0){var r=a(Oe.data[e]);if(t===""){t=r}else{t+=P("0000000",0,7-r.length)+r}}}return t},pow:function pow(e,t,r){return t===0?r:t%2===1?pow(e,t-1,r*e):pow(e*e,t/2,r)},log:function log(e){var t=0;var r=e;while(r>=4096){t+=12;r/=4096}while(r>=2){t+=1;r/=2}return t}};M(u,{toFixed:function toFixed(e){var t,r,n,i,o,u,f,s;t=l(e);t=t!==t?0:Math.floor(t);if(t<0||t>20){throw new RangeError("Number.toFixed called with invalid number of decimals")}r=l(this);if(r!==r){return"NaN"}if(r<=-1e21||r>=1e21){return a(r)}n="";if(r<0){n="-";r=-r}i="0";if(r>1e-21){o=Oe.log(r*Oe.pow(2,69,1))-69;u=o<0?r*Oe.pow(2,-o,1):r/Oe.pow(2,o,1);u*=4503599627370496;o=52-o;if(o>0){Oe.multiply(0,u);f=t;while(f>=7){Oe.multiply(1e7,0);f-=7}Oe.multiply(Oe.pow(10,f,1),0);f=o-1;while(f>=23){Oe.divide(1<<23);f-=23}Oe.divide(1<<f);Oe.multiply(1,1);Oe.divide(2);i=Oe.numToString()}else{Oe.multiply(0,u);Oe.multiply(1<<-o,0);i=Oe.numToString()+P("0.00000000000000000000",2,2+t)}}if(t>0){s=i.length;if(s<=t){i=n+P("0.0000000000000000000",0,t-s+2)+i}else{i=n+P(i,0,s-t)+"."+P(i,s-t)}}else{i=n+i}return i}},xe);if("ab".split(/(?:ab)*/).length!==2||".".split(/(.?)(.?)/).length!==4||"tesst".split(/(s)*/)[1]==="t"||"test".split(/(?:)/,-1).length!==4||"".split(/.?/).length||".".split(/()()/).length>1){(function(){var e=typeof/()??/.exec("")[1]==="undefined";o.split=function(t,r){var n=this;if(typeof t==="undefined"&&r===0){return[]}if(!S(t)){return Z(this,t,r)}var i=[];var a=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),o=0,l,u,s,v;var p=new RegExp(t.source,a+"g");n+="";if(!e){l=new RegExp("^"+p.source+"$(?!\\s)",a)}var h=typeof r==="undefined"?-1>>>0:A.ToUint32(r);u=p.exec(n);while(u){s=u.index+u[0].length;if(s>o){c.call(i,P(n,o,u.index));if(!e&&u.length>1){u[0].replace(l,function(){for(var e=1;e<arguments.length-2;e++){if(typeof arguments[e]==="undefined"){u[e]=void 0}}})}if(u.length>1&&u.index<n.length){c.apply(i,f.call(u,1))}v=u[0].length;o=s;if(i.length>=h){break}}if(p.lastIndex===u.index){p.lastIndex++}u=p.exec(n)}if(o===n.length){if(v||!p.test("")){c.call(i,"")}}else{c.call(i,P(n,o))}return i.length>h?P(i,0,h):i}})()}else if("0".split(void 0,0).length){o.split=function split(e,t){if(typeof e==="undefined"&&t===0){return[]}return Z(this,e,t)}}var Se=o.replace;var je=function(){var e=[];"x".replace(/x(.)?/g,function(t,r){c.call(e,r)});return e.length===1&&typeof e[0]==="undefined"}();if(!je){o.replace=function replace(e,t){var r=m(t);var n=S(e)&&/\)[*?]/.test(e.source);if(!r||!n){return Se.call(this,e,t)}else{var i=function(r){var n=arguments.length;var i=e.lastIndex;e.lastIndex=0;var a=e.exec(r)||[];e.lastIndex=i;c.call(a,arguments[n-2],arguments[n-1]);return t.apply(this,a)};return Se.call(this,e,i)}}}var Ee=o.substr;var Ie="".substr&&"0b".substr(-1)!=="b";M(o,{substr:function substr(e,t){var r=e;if(e<0){r=g(this.length+e,0)}return Ee.call(this,r,t)}},Ie);var De="	\n\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003"+"\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028"+"\u2029\ufeff";var ke="\u200b";var Ne="["+De+"]";var Fe=new RegExp("^"+Ne+Ne+"*");var Me=new RegExp(Ne+Ne+"*$");var Re=o.trim&&(De.trim()||!ke.trim());M(o,{trim:function trim(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}return a(this).replace(Fe,"").replace(Me,"")}},Re);if(parseInt(De+"08")!==8||parseInt(De+"0x16")!==22){parseInt=function(e){var t=/^0[xX]/;return function parseInt(r,n){var i=a(r).trim();var o=l(n)||(t.test(i)?16:10);return e(i,o)}}(parseInt)}});
/*! es6-shim: v0.33.4 (https://github.com/paulmillr/es6-shim) | @license es6-shim Copyright 2013-2015 by Paul Miller (http://paulmillr.com) and contributors, MIT License | see https://github.com/paulmillr/es6-shim/blob/0.33.4/LICENSE | Details and documentation: https://github.com/paulmillr/es6-shim/ */
(function(e,t){if(typeof define==="function"&&define.amd){define(t)}else if(typeof exports==="object"){module.exports=t()}else{e.returnExports=t()}})(this,function(){"use strict";var e=Function.call.bind(Function.apply);var t=Function.call.bind(Function.call);var r=Array.isArray;var n=function notThunker(t){return function notThunk(){return!e(t,this,arguments)}};var o=function(e){try{e();return false}catch(t){return true}};var i=function valueOrFalseIfThrows(e){try{return e()}catch(t){return false}};var a=n(o);var u=function(){return!o(function(){Object.defineProperty({},"x",{})})};var s=!!Object.defineProperty&&u();var f=function foo(){}.name==="foo";var c=Function.call.bind(Array.prototype.forEach);var l=Function.call.bind(Array.prototype.reduce);var p=Function.call.bind(Array.prototype.filter);var v=Function.call.bind(Array.prototype.every);var y=function createDataProperty(e,t,r){if(s){Object.defineProperty(e,t,{configurable:true,enumerable:true,writable:true,value:r})}else{e[t]=r}};var h=function createDataPropertyOrThrow(e,t,r){y(e,t,r);if(!oe.SameValue(e[t],r)){throw new TypeError("property is nonconfigurable")}};var g=function(e,t,r,n){if(!n&&t in e){return}if(s){Object.defineProperty(e,t,{configurable:true,enumerable:false,writable:true,value:r})}else{e[t]=r}};var b=function(e,t){c(Object.keys(t),function(r){var n=t[r];g(e,r,n,false)})};var d=Object.create||function(e,t){var r=function Prototype(){};r.prototype=e;var n=new r;if(typeof t!=="undefined"){Object.keys(t).forEach(function(e){V.defineByDescriptor(n,e,t[e])})}return n};var m=function(e,t){if(!Object.setPrototypeOf){return false}return i(function(){var r=function Subclass(t){var r=new e(t);Object.setPrototypeOf(r,Subclass.prototype);return r};Object.setPrototypeOf(r,e);r.prototype=d(e.prototype,{constructor:{value:r}});return t(r)})};var O=function(){return String.prototype.startsWith&&o(function(){"/a/".startsWith(/a/)})};var w=function(){return String.prototype.startsWith&&"abc".startsWith("a",Infinity)===false}();var j=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}throw new Error("unable to locate global object")};var S=j();var T=S.isFinite;var I=function(){return this===null}.call(null);var E=O()&&w;var M=Function.call.bind(String.prototype.indexOf);var P=Function.call.bind(Object.prototype.toString);var x=Function.call.bind(Array.prototype.concat);var N=Function.call.bind(String.prototype.slice);var C=Function.call.bind(Array.prototype.push);var A=Function.apply.bind(Array.prototype.push);var R=Function.call.bind(Array.prototype.shift);var _=Math.max;var k=Math.min;var F=Math.floor;var D=Math.abs;var z=Math.log;var L=Math.sqrt;var q=Function.call.bind(Object.prototype.hasOwnProperty);var G;var W=function(){};var H=S.Symbol||{};var B=H.species||"@@species";var V={getter:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}Object.defineProperty(e,t,{configurable:true,enumerable:false,get:r})},proxy:function(e,t,r){if(!s){throw new TypeError("getters require true ES5 support")}var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,{configurable:n.configurable,enumerable:n.enumerable,get:function getKey(){return e[t]},set:function setKey(r){e[t]=r}})},redefine:function(e,t,r){if(s){var n=Object.getOwnPropertyDescriptor(e,t);n.value=r;Object.defineProperty(e,t,n)}else{e[t]=r}},defineByDescriptor:function(e,t,r){if(s){Object.defineProperty(e,t,r)}else if("value"in r){e[t]=r.value}},preserveToString:function(e,t){g(e,"toString",t.toString.bind(t),true)}};var $=function wrapConstructor(e,t,r){V.preserveToString(t,e);if(Object.setPrototypeOf){Object.setPrototypeOf(e,t)}c(Object.getOwnPropertyNames(e),function(n){if(n in W||r[n]){return}V.proxy(e,n,t)});t.prototype=e.prototype;V.redefine(e.prototype,"constructor",t)};var J=function(){return this};var U=function(e){if(s&&!q(e,B)){V.getter(e,B,J)}};var K={primitive:function(e){return e===null||typeof e!=="function"&&typeof e!=="object"},object:function(e){return e!==null&&typeof e==="object"},string:function(e){return P(e)==="[object String]"},regex:function(e){return P(e)==="[object RegExp]"},symbol:function(e){return typeof S.Symbol==="function"&&typeof e==="symbol"}};var X=Number.isNaN||function isNaN(e){return e!==e};var Z=Number.isFinite||function isFinite(e){return typeof e==="number"&&T(e)};var Q=function overrideNative(e,t,r){var n=e[t];g(e,t,r,true);V.preserveToString(e[t],n)};var Y=K.symbol(H.iterator)?H.iterator:"_es6-shim iterator_";if(S.Set&&typeof(new S.Set)["@@iterator"]==="function"){Y="@@iterator"}var ee=function(e,t){var r=t||function iterator(){return this};g(e,Y,r);if(!e[Y]&&K.symbol(Y)){e[Y]=r}};var te=function isArguments(e){return P(e)==="[object Arguments]"};var re=function isArguments(e){return e!==null&&typeof e==="object"&&typeof e.length==="number"&&e.length>=0&&P(e)!=="[object Array]"&&P(e.callee)==="[object Function]"};var ne=te(arguments)?te:re;var oe={Call:function Call(t,r){var n=arguments.length>2?arguments[2]:[];if(!oe.IsCallable(t)){throw new TypeError(t+" is not a function")}return e(t,r,n)},RequireObjectCoercible:function(e,t){if(e==null){throw new TypeError(t||"Cannot call method on "+e)}},TypeIsObject:function(e){return e!=null&&Object(e)===e},ToObject:function(e,t){oe.RequireObjectCoercible(e,t);return Object(e)},IsCallable:function(e){return typeof e==="function"&&P(e)==="[object Function]"},IsConstructor:function(e){return oe.IsCallable(e)},ToInt32:function(e){return oe.ToNumber(e)>>0},ToUint32:function(e){return oe.ToNumber(e)>>>0},ToNumber:function(e){if(P(e)==="[object Symbol]"){throw new TypeError("Cannot convert a Symbol value to a number")}return+e},ToInteger:function(e){var t=oe.ToNumber(e);if(X(t)){return 0}if(t===0||!Z(t)){return t}return(t>0?1:-1)*F(D(t))},ToLength:function(e){var t=oe.ToInteger(e);if(t<=0){return 0}if(t>Number.MAX_SAFE_INTEGER){return Number.MAX_SAFE_INTEGER}return t},SameValue:function(e,t){if(e===t){if(e===0){return 1/e===1/t}return true}return X(e)&&X(t)},SameValueZero:function(e,t){return e===t||X(e)&&X(t)},IsIterable:function(e){return oe.TypeIsObject(e)&&(typeof e[Y]!=="undefined"||ne(e))},GetIterator:function(e){if(ne(e)){return new G(e,"value")}var r=oe.GetMethod(e,Y);if(!oe.IsCallable(r)){throw new TypeError("value is not an iterable")}var n=t(r,e);if(!oe.TypeIsObject(n)){throw new TypeError("bad iterator")}return n},GetMethod:function(e,t){var r=oe.ToObject(e)[t];if(r===void 0||r===null){return void 0}if(!oe.IsCallable(r)){throw new TypeError("Method not callable: "+t)}return r},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,r){var n=oe.GetMethod(e,"return");if(n===void 0){return}var o,i;try{o=t(n,e)}catch(a){i=a}if(r){return}if(i){throw i}if(!oe.TypeIsObject(o)){throw new TypeError("Iterator's return method returned a non-object.")}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!oe.TypeIsObject(t)){throw new TypeError("bad iterator")}return t},IteratorStep:function(e){var t=oe.IteratorNext(e);var r=oe.IteratorComplete(t);return r?false:t},Construct:function(e,t,r,n){if(r===void 0){r=e}if(!n){return gr.construct(e,t,r)}var o=r.prototype;if(!oe.TypeIsObject(o)){o=Object.prototype}var i=d(o);var a=oe.Call(e,i,t);return oe.TypeIsObject(a)?a:i},SpeciesConstructor:function(e,t){var r=e.constructor;if(r===void 0){return t}if(!oe.TypeIsObject(r)){throw new TypeError("Bad constructor")}var n=r[B];if(n===void 0||n===null){return t}if(!oe.IsConstructor(n)){throw new TypeError("Bad @@species")}return n},CreateHTML:function(e,t,r,n){var o=String(e);var i="<"+t;if(r!==""){var a=String(n);var u=a.replace(/"/g,"&quot;");i+=" "+r+'="'+u+'"'}var s=i+">";var f=s+o;return f+"</"+t+">"}};var ie=function(e,t,r,n){if(!oe.TypeIsObject(e)){throw new TypeError("Constructor requires `new`: "+t.name)}var o=t.prototype;if(!oe.TypeIsObject(o)){o=r}e=d(o);for(var i in n){if(q(n,i)){var a=n[i];g(e,i,a,true)}}return e};if(String.fromCodePoint&&String.fromCodePoint.length!==1){var ae=String.fromCodePoint;Q(String,"fromCodePoint",function fromCodePoint(t){return e(ae,this,arguments)})}var ue={fromCodePoint:function fromCodePoint(e){var t=[];var r;for(var n=0,o=arguments.length;n<o;n++){r=Number(arguments[n]);if(!oe.SameValue(r,oe.ToInteger(r))||r<0||r>1114111){throw new RangeError("Invalid code point "+r)}if(r<65536){C(t,String.fromCharCode(r))}else{r-=65536;C(t,String.fromCharCode((r>>10)+55296));C(t,String.fromCharCode(r%1024+56320))}}return t.join("")},raw:function raw(e){var t=oe.ToObject(e,"bad callSite");var r=oe.ToObject(t.raw,"bad raw value");var n=r.length;var o=oe.ToLength(n);if(o<=0){return""}var i=[];var a=0;var u,s,f,c;while(a<o){u=String(a);f=String(r[u]);C(i,f);if(a+1>=o){break}s=a+1<arguments.length?arguments[a+1]:"";c=String(s);C(i,c);a++}return i.join("")}};b(String,ue);if(String.raw({raw:{0:"x",1:"y",length:2}})!=="xy"){Q(String,"raw",ue.raw)}var se=function repeat(e,t){if(t<1){return""}if(t%2){return repeat(e,t-1)+e}var r=repeat(e,t/2);return r+r};var fe=Infinity;var ce={repeat:function repeat(e){oe.RequireObjectCoercible(this);var t=String(this);var r=oe.ToInteger(e);if(r<0||r>=fe){throw new RangeError("repeat count must be less than infinity and not overflow maximum string size")}return se(t,r)},startsWith:function startsWith(e){oe.RequireObjectCoercible(this);var t=String(this);if(K.regex(e)){throw new TypeError('Cannot call method "startsWith" with a regex')}var r=String(e);var n=arguments.length>1?arguments[1]:void 0;var o=_(oe.ToInteger(n),0);return N(t,o,o+r.length)===r},endsWith:function endsWith(e){oe.RequireObjectCoercible(this);var t=String(this);if(K.regex(e)){throw new TypeError('Cannot call method "endsWith" with a regex')}var r=String(e);var n=t.length;var o=arguments.length>1?arguments[1]:void 0;var i=typeof o==="undefined"?n:oe.ToInteger(o);var a=k(_(i,0),n);return N(t,a-r.length,a)===r},includes:function includes(e){if(K.regex(e)){throw new TypeError('"includes" does not accept a RegExp')}var t;if(arguments.length>1){t=arguments[1]}return M(this,e,t)!==-1},codePointAt:function codePointAt(e){oe.RequireObjectCoercible(this);var t=String(this);var r=oe.ToInteger(e);var n=t.length;if(r>=0&&r<n){var o=t.charCodeAt(r);var i=r+1===n;if(o<55296||o>56319||i){return o}var a=t.charCodeAt(r+1);if(a<56320||a>57343){return o}return(o-55296)*1024+(a-56320)+65536}}};b(String.prototype,ce);if("a".includes("a",Infinity)!==false){Q(String.prototype,"includes",ce.includes)}var le="\x85".trim().length!==1;if(le){delete String.prototype.trim;var pe=["	\n\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join("");var ve=new RegExp("(^["+pe+"]+)|(["+pe+"]+$)","g");b(String.prototype,{trim:function trim(){if(typeof this==="undefined"||this===null){throw new TypeError("can't convert "+this+" to object")}return String(this).replace(ve,"")}})}var ye=function(e){oe.RequireObjectCoercible(e);this._s=String(e);this._i=0};ye.prototype.next=function(){var e=this._s,t=this._i;if(typeof e==="undefined"||t>=e.length){this._s=void 0;return{value:void 0,done:true}}var r=e.charCodeAt(t),n,o;if(r<55296||r>56319||t+1===e.length){o=1}else{n=e.charCodeAt(t+1);o=n<56320||n>57343?1:2}this._i=t+o;return{value:e.substr(t,o),done:false}};ee(ye.prototype);ee(String.prototype,function(){return new ye(this)});if(!E){Q(String.prototype,"startsWith",ce.startsWith);Q(String.prototype,"endsWith",ce.endsWith)}var he={from:function from(e){var r=this;var n=arguments.length>1?arguments[1]:void 0;var o,i;if(n===void 0){o=false}else{if(!oe.IsCallable(n)){throw new TypeError("Array.from: when provided, the second argument must be a function")}i=arguments.length>2?arguments[2]:void 0;o=true}var a=ne(e)||oe.GetMethod(e,Y);var u,s,f;if(a!==void 0){s=oe.IsConstructor(r)?Object(new r):[];var c=oe.GetIterator(e);var l,p;f=0;while(true){l=oe.IteratorStep(c);if(l===false){break}p=l.value;try{if(o){p=i!==undefined?t(n,i,p,f):n(p,f)}s[f]=p}catch(v){oe.IteratorClose(c,true);throw v}f+=1}u=f}else{var y=oe.ToObject(e);u=oe.ToLength(y.length);s=oe.IsConstructor(r)?Object(new r(u)):new Array(u);var h;for(f=0;f<u;++f){h=y[f];if(o){h=i!==undefined?t(n,i,h,f):n(h,f)}s[f]=h}}s.length=u;return s},of:function of(){var e=arguments.length;var t=this;var n=r(t)||!oe.IsCallable(t)?new Array(e):oe.Construct(t,[e]);for(var o=0;o<e;++o){h(n,o,arguments[o])}n.length=e;return n}};b(Array,he);U(Array);var ge=function(e){return{value:e,done:arguments.length===0}};G=function(e,t){this.i=0;this.array=e;this.kind=t};b(G.prototype,{next:function(){var e=this.i,t=this.array;if(!(this instanceof G)){throw new TypeError("Not an ArrayIterator")}if(typeof t!=="undefined"){var r=oe.ToLength(t.length);for(;e<r;e++){var n=this.kind;var o;if(n==="key"){o=e}else if(n==="value"){o=t[e]}else if(n==="entry"){o=[e,t[e]]}this.i=e+1;return{value:o,done:false}}}this.array=void 0;return{value:void 0,done:true}}});ee(G.prototype);var be=function(e,t){b(this,{object:e,array:de(e),kind:t})};var de=function getAllKeys(e){var t=[];for(var r in e){C(t,r)}return t};b(be.prototype,{next:function next(){var e;var t=this.array;if(!(this instanceof be)){throw new TypeError("Not an ObjectIterator")}while(t.length>0){e=R(t);if(!(e in this.object)){continue}if(this.kind==="key"){return ge(e)}else if(this.kind==="value"){return ge(this.object[e])}else{return ge([e,this.object[e]])}}return ge()}});ee(be.prototype);var me=Array.of===he.of||function(){var e=function Foo(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&t.length===2}();if(!me){Q(Array,"of",he.of)}var Oe={copyWithin:function copyWithin(e,t){var r=arguments[2];var n=oe.ToObject(this);var o=oe.ToLength(n.length);var i=oe.ToInteger(e);var a=oe.ToInteger(t);var u=i<0?_(o+i,0):k(i,o);var s=a<0?_(o+a,0):k(a,o);r=typeof r==="undefined"?o:oe.ToInteger(r);var f=r<0?_(o+r,0):k(r,o);var c=k(f-s,o-u);var l=1;if(s<u&&u<s+c){l=-1;s+=c-1;u+=c-1}while(c>0){if(q(n,s)){n[u]=n[s]}else{delete n[s]}s+=l;u+=l;c-=1}return n},fill:function fill(e){var t=arguments.length>1?arguments[1]:void 0;var r=arguments.length>2?arguments[2]:void 0;var n=oe.ToObject(this);var o=oe.ToLength(n.length);t=oe.ToInteger(typeof t==="undefined"?0:t);r=oe.ToInteger(typeof r==="undefined"?o:r);var i=t<0?_(o+t,0):k(t,o);var a=r<0?o+r:r;for(var u=i;u<o&&u<a;++u){n[u]=e}return n},find:function find(e){var r=oe.ToObject(this);var n=oe.ToLength(r.length);if(!oe.IsCallable(e)){throw new TypeError("Array#find: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0,a;i<n;i++){a=r[i];if(o){if(t(e,o,a,i,r)){return a}}else if(e(a,i,r)){return a}}},findIndex:function findIndex(e){var r=oe.ToObject(this);var n=oe.ToLength(r.length);if(!oe.IsCallable(e)){throw new TypeError("Array#findIndex: predicate must be a function")}var o=arguments.length>1?arguments[1]:null;for(var i=0;i<n;i++){if(o){if(t(e,o,r[i],i,r)){return i}}else if(e(r[i],i,r)){return i}}return-1},keys:function keys(){return new G(this,"key")},values:function values(){return new G(this,"value")},entries:function entries(){return new G(this,"entry")}};if(Array.prototype.keys&&!oe.IsCallable([1].keys().next)){delete Array.prototype.keys}if(Array.prototype.entries&&!oe.IsCallable([1].entries().next)){delete Array.prototype.entries}if(Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[Y]){b(Array.prototype,{values:Array.prototype[Y]});if(K.symbol(H.unscopables)){Array.prototype[H.unscopables].values=true}}if(f&&Array.prototype.values&&Array.prototype.values.name!=="values"){var we=Array.prototype.values;Q(Array.prototype,"values",function values(){return t(we,this)});g(Array.prototype,Y,Array.prototype.values,true)}b(Array.prototype,Oe);ee(Array.prototype,function(){return this.values()});if(Object.getPrototypeOf){ee(Object.getPrototypeOf([].values()))}var je=function(){return i(function(){return Array.from({length:-1}).length===0})}();var Se=function(){var e=Array.from([0].entries());return e.length===1&&r(e[0])&&e[0][0]===0&&e[0][1]===0}();if(!je||!Se){Q(Array,"from",he.from)}var Te=function(){return i(function(){return Array.from([0],undefined)})}();if(!Te){var Ie=Array.from;Q(Array,"from",function from(r){if(arguments.length>0&&typeof arguments[1]!=="undefined"){return e(Ie,this,arguments)}else{return t(Ie,this,r)}})}var Ee=function(e,r){var n={length:-1};n[r?(-1>>>0)-1:0]=true;return i(function(){t(e,n,function(){throw new RangeError("should not reach here")},[])})};if(!Ee(Array.prototype.forEach)){var Me=Array.prototype.forEach;Q(Array.prototype,"forEach",function forEach(t){return e(Me,this.length>=0?this:[],arguments)},true)}if(!Ee(Array.prototype.map)){var Pe=Array.prototype.map;Q(Array.prototype,"map",function map(t){return e(Pe,this.length>=0?this:[],arguments)},true)}if(!Ee(Array.prototype.filter)){var xe=Array.prototype.filter;Q(Array.prototype,"filter",function filter(t){return e(xe,this.length>=0?this:[],arguments)},true)}if(!Ee(Array.prototype.some)){var Ne=Array.prototype.some;Q(Array.prototype,"some",function some(t){return e(Ne,this.length>=0?this:[],arguments)},true)}if(!Ee(Array.prototype.every)){var Ce=Array.prototype.every;Q(Array.prototype,"every",function every(t){return e(Ce,this.length>=0?this:[],arguments)},true)}if(!Ee(Array.prototype.reduce)){var Ae=Array.prototype.reduce;Q(Array.prototype,"reduce",function reduce(t){return e(Ae,this.length>=0?this:[],arguments)},true)}if(!Ee(Array.prototype.reduceRight,true)){var Re=Array.prototype.reduceRight;Q(Array.prototype,"reduceRight",function reduceRight(t){return e(Re,this.length>=0?this:[],arguments)},true)}if(Number("0o10")!==8||Number("0b10")!==2){var _e=Number;var ke=Function.bind.call(Function.call,RegExp.prototype.test,/^0b/i);var Fe=Function.bind.call(Function.call,RegExp.prototype.test,/^0o/i);var De=function(e){var t;if(typeof e.valueOf==="function"){t=e.valueOf();if(K.primitive(t)){return t}}if(typeof e.toString==="function"){t=e.toString();if(K.primitive(t)){return t}}throw new TypeError("No default value")};var ze=function Number(e){var t=K.primitive(e)?e:De(e,"number");if(typeof t==="string"){if(ke(t)){t=parseInt(N(t,2),2)}else if(Fe(t)){t=parseInt(N(t,2),8)}}if(this instanceof Number){return new _e(t)}return _e(t)};$(_e,ze,{});Number=ze;V.redefine(S,"Number",ze)}var Le=Math.pow(2,53)-1;b(Number,{MAX_SAFE_INTEGER:Le,MIN_SAFE_INTEGER:-Le,EPSILON:2.220446049250313e-16,parseInt:S.parseInt,parseFloat:S.parseFloat,isFinite:Z,isInteger:function isInteger(e){return Z(e)&&oe.ToInteger(e)===e},isSafeInteger:function isSafeInteger(e){return Number.isInteger(e)&&D(e)<=Number.MAX_SAFE_INTEGER},isNaN:X});g(Number,"parseInt",S.parseInt,Number.parseInt!==S.parseInt);if(![,1].find(function(e,t){return t===0})){Q(Array.prototype,"find",Oe.find)}if([,1].findIndex(function(e,t){return t===0})!==0){Q(Array.prototype,"findIndex",Oe.findIndex)}var qe=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable);var Ge=function sliceArgs(){var e=Number(this);var t=arguments.length;var r=t-e;var n=new Array(r<0?0:r);for(var o=e;o<t;++o){n[o-e]=arguments[o]}return n};var We=function assignTo(e){return function assignToSource(t,r){t[r]=e[r];return t}};var He=function(e,t){var r=Object.keys(Object(t));var n;if(oe.IsCallable(Object.getOwnPropertySymbols)){n=p(Object.getOwnPropertySymbols(Object(t)),qe(t))}return l(x(r,n||[]),We(t),e)};var Be={assign:function(t,r){var n=oe.ToObject(t,"Cannot convert undefined or null to object");return l(e(Ge,1,arguments),He,n)},is:function is(e,t){return oe.SameValue(e,t)}};var Ve=Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return e[1]==="y"}}();if(Ve){Q(Object,"assign",Be.assign)}b(Object,Be);if(s){var $e={setPrototypeOf:function(e,r){var n;var o=function(e,t){if(!oe.TypeIsObject(e)){throw new TypeError("cannot set prototype on a non-object")}if(!(t===null||oe.TypeIsObject(t))){throw new TypeError("can only set prototype to an object or null"+t)}};var i=function(e,r){o(e,r);t(n,e,r);return e};try{n=e.getOwnPropertyDescriptor(e.prototype,r).set;t(n,{},null)}catch(a){if(e.prototype!=={}[r]){return}n=function(e){this[r]=e};i.polyfill=i(i({},null),e.prototype)instanceof e}return i}(Object,"__proto__")};b(Object,$e)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&Object.getPrototypeOf(Object.setPrototypeOf({},null))!==null&&Object.getPrototypeOf(Object.create(null))===null){(function(){var e=Object.create(null);var t=Object.getPrototypeOf,r=Object.setPrototypeOf;Object.getPrototypeOf=function(r){var n=t(r);return n===e?null:n};Object.setPrototypeOf=function(t,n){var o=n===null?e:n;return r(t,o)};Object.setPrototypeOf.polyfill=false})()}var Je=!o(function(){Object.keys("foo")});if(!Je){var Ue=Object.keys;Q(Object,"keys",function keys(e){return Ue(oe.ToObject(e))})}if(Object.getOwnPropertyNames){var Ke=!o(function(){Object.getOwnPropertyNames("foo")});if(!Ke){var Xe=typeof window==="object"?Object.getOwnPropertyNames(window):[];var Ze=Object.getOwnPropertyNames;Q(Object,"getOwnPropertyNames",function getOwnPropertyNames(e){var t=oe.ToObject(e);if(P(t)==="[object Window]"){try{return Ze(t)}catch(r){return x([],Xe)}}return Ze(t)})}}if(Object.getOwnPropertyDescriptor){var Qe=!o(function(){Object.getOwnPropertyDescriptor("foo","bar")});if(!Qe){var Ye=Object.getOwnPropertyDescriptor;Q(Object,"getOwnPropertyDescriptor",function getOwnPropertyDescriptor(e,t){return Ye(oe.ToObject(e),t)})}}if(Object.seal){var et=!o(function(){Object.seal("foo")});if(!et){var tt=Object.seal;Q(Object,"seal",function seal(e){if(!K.object(e)){return e}return tt(e)})}}if(Object.isSealed){var rt=!o(function(){Object.isSealed("foo")});if(!rt){var nt=Object.isSealed;Q(Object,"isSealed",function isSealed(e){if(!K.object(e)){return true}return nt(e)})}}if(Object.freeze){var ot=!o(function(){Object.freeze("foo")});if(!ot){var it=Object.freeze;Q(Object,"freeze",function freeze(e){if(!K.object(e)){return e}return it(e)})}}if(Object.isFrozen){var at=!o(function(){Object.isFrozen("foo")});if(!at){var ut=Object.isFrozen;Q(Object,"isFrozen",function isFrozen(e){if(!K.object(e)){return true}return ut(e)})}}if(Object.preventExtensions){var st=!o(function(){Object.preventExtensions("foo")});if(!st){var ft=Object.preventExtensions;Q(Object,"preventExtensions",function preventExtensions(e){if(!K.object(e)){return e}return ft(e)})}}if(Object.isExtensible){var ct=!o(function(){Object.isExtensible("foo")});if(!ct){var lt=Object.isExtensible;Q(Object,"isExtensible",function isExtensible(e){if(!K.object(e)){return false}return lt(e)})}}if(Object.getPrototypeOf){var pt=!o(function(){Object.getPrototypeOf("foo")});if(!pt){var vt=Object.getPrototypeOf;Q(Object,"getPrototypeOf",function getPrototypeOf(e){return vt(oe.ToObject(e))})}}if(!RegExp.prototype.flags&&s){var yt=function flags(){if(!oe.TypeIsObject(this)){throw new TypeError("Method called on incompatible type: must be an object.")}var e="";if(this.global){e+="g"}if(this.ignoreCase){e+="i"}if(this.multiline){e+="m"}if(this.unicode){e+="u"}if(this.sticky){e+="y"}return e};V.getter(RegExp.prototype,"flags",yt)}var ht=i(function(){return String(new RegExp(/a/g,"i"))==="/a/i"});if(!ht&&s){var gt=RegExp;var bt=function RegExp(e,t){var r=this instanceof RegExp;if(!r&&(K.regex(e)||e&&e.constructor===RegExp)){return e}if(K.regex(e)&&K.string(t)){return new RegExp(e.source,t)}return new gt(e,t)};$(gt,bt,{$input:true});RegExp=bt;V.redefine(S,"RegExp",bt)}if(s){var dt={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};c(Object.keys(dt),function(e){if(e in RegExp&&!(dt[e]in RegExp)){V.getter(RegExp,dt[e],function get(){return RegExp[e]})}})}U(RegExp);var mt=1/Number.EPSILON;var Ot=function roundTiesToEven(e){return e+mt-mt};var wt=Math.pow(2,-23);var jt=Math.pow(2,127)*(2-wt);var St=Math.pow(2,-126);var Tt=Number.prototype.clz;delete Number.prototype.clz;var It={acosh:function acosh(e){var t=Number(e);if(Number.isNaN(t)||e<1){return NaN}if(t===1){return 0}if(t===Infinity){return t}return z(t/Math.E+L(t+1)*L(t-1)/Math.E)+1},asinh:function asinh(e){var t=Number(e);if(t===0||!T(t)){return t}return t<0?-Math.asinh(-t):z(t+L(t*t+1))},atanh:function atanh(e){var t=Number(e);if(Number.isNaN(t)||t<-1||t>1){return NaN}if(t===-1){return-Infinity}if(t===1){return Infinity}if(t===0){return t}return.5*z((1+t)/(1-t))},cbrt:function cbrt(e){var t=Number(e);if(t===0){return t}var r=t<0,n;if(r){t=-t}if(t===Infinity){n=Infinity}else{n=Math.exp(z(t)/3);n=(t/(n*n)+2*n)/3}return r?-n:n},clz32:function clz32(e){var r=Number(e);var n=oe.ToUint32(r);if(n===0){return 32}return Tt?t(Tt,n):31-F(z(n+.5)*Math.LOG2E)},cosh:function cosh(e){var t=Number(e);if(t===0){return 1}if(Number.isNaN(t)){return NaN}if(!T(t)){return Infinity}if(t<0){t=-t}if(t>21){return Math.exp(t)/2}return(Math.exp(t)+Math.exp(-t))/2},expm1:function expm1(e){var t=Number(e);if(t===-Infinity){return-1}if(!T(t)||t===0){return t}if(D(t)>.5){return Math.exp(t)-1}var r=t;var n=0;var o=1;while(n+r!==n){n+=r;o+=1;r*=t/o}return n},hypot:function hypot(e,t){var r=0;var n=0;for(var o=0;o<arguments.length;++o){var i=D(Number(arguments[o]));if(n<i){r*=n/i*(n/i);r+=1;n=i}else{r+=i>0?i/n*(i/n):i}}return n===Infinity?Infinity:n*L(r)},log2:function log2(e){return z(e)*Math.LOG2E},log10:function log10(e){return z(e)*Math.LOG10E},log1p:function log1p(e){var t=Number(e);if(t<-1||Number.isNaN(t)){return NaN}if(t===0||t===Infinity){return t}if(t===-1){return-Infinity}return 1+t-1===0?t:t*(z(1+t)/(1+t-1))},sign:function sign(e){var t=Number(e);if(t===0){return t}if(Number.isNaN(t)){return t}return t<0?-1:1},sinh:function sinh(e){var t=Number(e);if(!T(t)||t===0){return t}if(D(t)<1){return(Math.expm1(t)-Math.expm1(-t))/2}return(Math.exp(t-1)-Math.exp(-t-1))*Math.E/2},tanh:function tanh(e){var t=Number(e);if(Number.isNaN(t)||t===0){return t}if(t===Infinity){return 1}if(t===-Infinity){return-1}var r=Math.expm1(t);var n=Math.expm1(-t);if(r===Infinity){return 1}if(n===Infinity){return-1}return(r-n)/(Math.exp(t)+Math.exp(-t))},trunc:function trunc(e){var t=Number(e);return t<0?-F(-t):F(t)},imul:function imul(e,t){var r=oe.ToUint32(e);var n=oe.ToUint32(t);var o=r>>>16&65535;var i=r&65535;var a=n>>>16&65535;var u=n&65535;return i*u+(o*u+i*a<<16>>>0)|0},fround:function fround(e){var t=Number(e);if(t===0||t===Infinity||t===-Infinity||X(t)){return t}var r=Math.sign(t);var n=D(t);if(n<St){return r*Ot(n/St/wt)*St*wt}var o=(1+wt/Number.EPSILON)*n;var i=o-(o-n);if(i>jt||X(i)){return r*Infinity}return r*i}};b(Math,It);g(Math,"log1p",It.log1p,Math.log1p(-1e-17)!==-1e-17);g(Math,"asinh",It.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7));g(Math,"tanh",It.tanh,Math.tanh(-2e-17)!==-2e-17);g(Math,"acosh",It.acosh,Math.acosh(Number.MAX_VALUE)===Infinity);g(Math,"cbrt",It.cbrt,Math.abs(1-Math.cbrt(1e-300)/1e-100)/Number.EPSILON>8);g(Math,"sinh",It.sinh,Math.sinh(-2e-17)!==-2e-17);var Et=Math.expm1(10);g(Math,"expm1",It.expm1,Et>22025.465794806718||Et<22025.465794806718);var Mt=Math.round;var Pt=Math.round(.5-Number.EPSILON/4)===0&&Math.round(-.5+Number.EPSILON/3.99)===1;var xt=mt+1;var Nt=2*mt-1;var Ct=[xt,Nt].every(function(e){return Math.round(e)===e});g(Math,"round",function round(e){var t=F(e);var r=t===-1?-0:t+1;return e-t<.5?t:r},!Pt||!Ct);V.preserveToString(Math.round,Mt);var At=Math.imul;if(Math.imul(4294967295,5)!==-5){Math.imul=It.imul;V.preserveToString(Math.imul,At)}if(Math.imul.length!==2){Q(Math,"imul",function imul(t,r){return e(At,Math,arguments)})}var Rt=function(){var e=S.setTimeout;if(typeof e!=="function"){return}oe.IsPromise=function(e){if(!oe.TypeIsObject(e)){return false}if(typeof e._promise==="undefined"){return false}return true};var r=function(e){if(!oe.IsConstructor(e)){throw new TypeError("Bad promise constructor")}var t=this;var r=function(e,r){if(t.resolve!==void 0||t.reject!==void 0){throw new TypeError("Bad Promise implementation!")}t.resolve=e;t.reject=r};t.promise=new e(r);if(!(oe.IsCallable(t.resolve)&&oe.IsCallable(t.reject))){throw new TypeError("Bad promise constructor")}};var n;if(typeof window!=="undefined"&&oe.IsCallable(window.postMessage)){n=function(){var e=[];var t="zero-timeout-message";var r=function(r){C(e,r);window.postMessage(t,"*")};var n=function(r){if(r.source===window&&r.data===t){r.stopPropagation();if(e.length===0){return}var n=R(e);n()}};window.addEventListener("message",n,true);return r}}var o=function(){var e=S.Promise;return e&&e.resolve&&function(t){return e.resolve().then(t)}};var i=oe.IsCallable(S.setImmediate)?S.setImmediate.bind(S):typeof process==="object"&&process.nextTick?process.nextTick:o()||(oe.IsCallable(n)?n():function(t){e(t,0)});var a=1;var u=2;var s=3;var f=4;var l=5;var p=function(e,t){var r=e.capabilities;var n=e.handler;var o,i=false,s;if(n===a){o=t}else if(n===u){o=t;i=true}else{try{o=n(t)}catch(f){o=f;i=true}}s=i?r.reject:r.resolve;s(o)};var v=function(e,t){c(e,function(e){i(function(){p(e,t)})})};var y=function(e,t){var r=e._promise;var n=r.fulfillReactions;r.result=t;r.fulfillReactions=void 0;r.rejectReactions=void 0;r.state=f;v(n,t)};var h=function(e,t){var r=e._promise;var n=r.rejectReactions;r.result=t;r.fulfillReactions=void 0;r.rejectReactions=void 0;r.state=l;v(n,t)};var g=function(e){var t=false;var r=function(r){var n;if(t){return}t=true;if(r===e){return h(e,new TypeError("Self resolution"))}if(!oe.TypeIsObject(r)){return y(e,r)}try{n=r.then}catch(o){return h(e,o)}if(!oe.IsCallable(n)){return y(e,r)}i(function(){d(e,r,n)})};var n=function(r){if(t){return}t=true;return h(e,r)};return{resolve:r,reject:n}};var d=function(e,r,n){var o=g(e);var i=o.resolve;var a=o.reject;try{t(n,r,i,a)}catch(u){a(u)}};var m=function(e){if(!oe.TypeIsObject(e)){throw new TypeError("Promise is not object")}var t=e[B];if(t!==void 0&&t!==null){return t}return e};var O=function Promise(e){if(!(this instanceof Promise)){throw new TypeError('Constructor Promise requires "new"')}if(this&&this._promise){throw new TypeError("Bad construction")}if(!oe.IsCallable(e)){throw new TypeError("not a valid resolver")}var t=ie(this,Promise,w,{_promise:{result:void 0,state:s,fulfillReactions:[],rejectReactions:[]}});var r=g(t);var n=r.reject;try{e(r.resolve,n)}catch(o){n(o)}return t};var w=O.prototype;var j=function(e,t,r,n){var o=false;return function(i){if(o){return}o=true;t[e]=i;if(--n.count===0){var a=r.resolve;a(t)}}};var T=function(e,t,r){var n=e.iterator;var o=[],i={count:1},a,u;var s=0;while(true){try{a=oe.IteratorStep(n);if(a===false){e.done=true;break}u=a.value}catch(f){e.done=true;throw f}o[s]=void 0;var c=t.resolve(u);var l=j(s,o,r,i);i.count++;c.then(l,r.reject);s+=1}if(--i.count===0){var p=r.resolve;p(o)}return r.promise};var I=function(e,t,r){var n=e.iterator,o,i,a;while(true){try{o=oe.IteratorStep(n);if(o===false){e.done=true;break}i=o.value}catch(u){e.done=true;throw u}a=t.resolve(i);a.then(r.resolve,r.reject)}return r.promise};b(O,{all:function all(e){var t=m(this);var n=new r(t);var o,i;try{o=oe.GetIterator(e);i={iterator:o,done:false};return T(i,t,n)}catch(a){if(i&&!i.done){try{oe.IteratorClose(o,true)}catch(u){a=u}}var s=n.reject;s(a);return n.promise}},race:function race(e){var t=m(this);var n=new r(t);var o,i;try{o=oe.GetIterator(e);i={iterator:o,done:false};return I(i,t,n)}catch(a){if(i&&!i.done){try{oe.IteratorClose(o,true)}catch(u){a=u}}var s=n.reject;s(a);return n.promise}},reject:function reject(e){var t=this;var n=new r(t);var o=n.reject;o(e);return n.promise},resolve:function resolve(e){var t=this;if(oe.IsPromise(e)){var n=e.constructor;if(n===t){return e}}var o=new r(t);var i=o.resolve;i(e);return o.promise}});b(w,{"catch":function(e){return this.then(void 0,e)},then:function then(e,t){var n=this;if(!oe.IsPromise(n)){throw new TypeError("not a promise")}var o=oe.SpeciesConstructor(n,O);var c=new r(o);if(!oe.IsCallable(e)){e=a}if(!oe.IsCallable(t)){t=u}var v={capabilities:c,handler:e};var y={capabilities:c,handler:t
};var h=n._promise,g;if(h.state===s){C(h.fulfillReactions,v);C(h.rejectReactions,y)}else if(h.state===f){g=h.result;i(function(){p(v,g)})}else if(h.state===l){g=h.result;i(function(){p(y,g)})}else{throw new TypeError("unexpected Promise state")}return c.promise}});return O}();if(S.Promise){delete S.Promise.accept;delete S.Promise.defer;delete S.Promise.prototype.chain}if(typeof Rt==="function"){b(S,{Promise:Rt});var _t=m(S.Promise,function(e){return e.resolve(42).then(function(){})instanceof e});var kt=!o(function(){S.Promise.reject(42).then(null,5).then(null,W)});var Ft=o(function(){S.Promise.call(3,W)});var Dt=function(e){var t=e.resolve(5);t.constructor={};var r=e.resolve(t);return t===r}(S.Promise);if(!_t||!kt||!Ft||Dt){Promise=Rt;Q(S,"Promise",Rt)}U(Promise)}var zt=function(e){var t=Object.keys(l(e,function(e,t){e[t]=true;return e},{}));return e.join(":")===t.join(":")};var Lt=zt(["z","a","bb"]);var qt=zt(["z",1,"a","3",2]);if(s){var Gt=function fastkey(e){if(!Lt){return null}var t=typeof e;if(t==="undefined"||e===null){return"^"+String(e)}else if(t==="string"){return"$"+e}else if(t==="number"){if(!qt){return"n"+e}return e}else if(t==="boolean"){return"b"+e}return null};var Wt=function emptyObject(){return Object.create?Object.create(null):{}};var Ht=function addIterableToMap(e,n,o){if(r(o)||K.string(o)){c(o,function(e){n.set(e[0],e[1])})}else if(o instanceof e){t(e.prototype.forEach,o,function(e,t){n.set(t,e)})}else{var i,a;if(o!==null&&typeof o!=="undefined"){a=n.set;if(!oe.IsCallable(a)){throw new TypeError("bad map")}i=oe.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=oe.IteratorStep(i);if(u===false){break}var s=u.value;try{if(!oe.TypeIsObject(s)){throw new TypeError("expected iterable of pairs")}t(a,n,s[0],s[1])}catch(f){oe.IteratorClose(i,true);throw f}}}}};var Bt=function addIterableToSet(e,n,o){if(r(o)||K.string(o)){c(o,function(e){n.add(e)})}else if(o instanceof e){t(e.prototype.forEach,o,function(e){n.add(e)})}else{var i,a;if(o!==null&&typeof o!=="undefined"){a=n.add;if(!oe.IsCallable(a)){throw new TypeError("bad set")}i=oe.GetIterator(o)}if(typeof i!=="undefined"){while(true){var u=oe.IteratorStep(i);if(u===false){break}var s=u.value;try{t(a,n,s)}catch(f){oe.IteratorClose(i,true);throw f}}}}};var Vt={Map:function(){var e={};var r=function MapEntry(e,t){this.key=e;this.value=t;this.next=null;this.prev=null};r.prototype.isRemoved=function isRemoved(){return this.key===e};var n=function isMap(e){return!!e._es6map};var o=function requireMapSlot(e,t){if(!oe.TypeIsObject(e)||!n(e)){throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+String(e))}};var i=function MapIterator(e,t){o(e,"[[MapIterator]]");this.head=e._head;this.i=this.head;this.kind=t};i.prototype={next:function next(){var e=this.i,t=this.kind,r=this.head,n;if(typeof this.i==="undefined"){return{value:void 0,done:true}}while(e.isRemoved()&&e!==r){e=e.prev}while(e.next!==r){e=e.next;if(!e.isRemoved()){if(t==="key"){n=e.key}else if(t==="value"){n=e.value}else{n=[e.key,e.value]}this.i=e;return{value:n,done:false}}}this.i=void 0;return{value:void 0,done:true}}};ee(i.prototype);var a=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}if(this&&this._es6map){throw new TypeError("Bad construction")}var e=ie(this,Map,u,{_es6map:true,_head:null,_storage:Wt(),_size:0});var t=new r(null,null);t.next=t.prev=t;e._head=t;if(arguments.length>0){Ht(Map,e,arguments[0])}return e};var u=a.prototype;V.getter(u,"size",function(){if(typeof this._size==="undefined"){throw new TypeError("size method called on incompatible Map")}return this._size});b(u,{get:function get(e){o(this,"get");var t=Gt(e);if(t!==null){var r=this._storage[t];if(r){return r.value}else{return}}var n=this._head,i=n;while((i=i.next)!==n){if(oe.SameValueZero(i.key,e)){return i.value}}},has:function has(e){o(this,"has");var t=Gt(e);if(t!==null){return typeof this._storage[t]!=="undefined"}var r=this._head,n=r;while((n=n.next)!==r){if(oe.SameValueZero(n.key,e)){return true}}return false},set:function set(e,t){o(this,"set");var n=this._head,i=n,a;var u=Gt(e);if(u!==null){if(typeof this._storage[u]!=="undefined"){this._storage[u].value=t;return this}else{a=this._storage[u]=new r(e,t);i=n.prev}}while((i=i.next)!==n){if(oe.SameValueZero(i.key,e)){i.value=t;return this}}a=a||new r(e,t);if(oe.SameValue(-0,e)){a.key=+0}a.next=this._head;a.prev=this._head.prev;a.prev.next=a;a.next.prev=a;this._size+=1;return this},"delete":function(t){o(this,"delete");var r=this._head,n=r;var i=Gt(t);if(i!==null){if(typeof this._storage[i]==="undefined"){return false}n=this._storage[i].prev;delete this._storage[i]}while((n=n.next)!==r){if(oe.SameValueZero(n.key,t)){n.key=n.value=e;n.prev.next=n.next;n.next.prev=n.prev;this._size-=1;return true}}return false},clear:function clear(){o(this,"clear");this._size=0;this._storage=Wt();var t=this._head,r=t,n=r.next;while((r=n)!==t){r.key=r.value=e;n=r.next;r.next=r.prev=t}t.next=t.prev=t},keys:function keys(){o(this,"keys");return new i(this,"key")},values:function values(){o(this,"values");return new i(this,"value")},entries:function entries(){o(this,"entries");return new i(this,"key+value")},forEach:function forEach(e){o(this,"forEach");var r=arguments.length>1?arguments[1]:null;var n=this.entries();for(var i=n.next();!i.done;i=n.next()){if(r){t(e,r,i.value[1],i.value[0],this)}else{e(i.value[1],i.value[0],this)}}}});ee(u,u.entries);return a}(),Set:function(){var e=function isSet(e){return e._es6set&&typeof e._storage!=="undefined"};var r=function requireSetSlot(t,r){if(!oe.TypeIsObject(t)||!e(t)){throw new TypeError("Set.prototype."+r+" called on incompatible receiver "+String(t))}};var n=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}if(this&&this._es6set){throw new TypeError("Bad construction")}var e=ie(this,Set,o,{_es6set:true,"[[SetData]]":null,_storage:Wt()});if(!e._es6set){throw new TypeError("bad set")}if(arguments.length>0){Bt(Set,e,arguments[0])}return e};var o=n.prototype;var i=function ensureMap(e){if(!e["[[SetData]]"]){var t=e["[[SetData]]"]=new Vt.Map;c(Object.keys(e._storage),function(e){if(e==="^null"){e=null}else if(e==="^undefined"){e=void 0}else{var r=e.charAt(0);if(r==="$"){e=N(e,1)}else if(r==="n"){e=+N(e,1)}else if(r==="b"){e=e==="btrue"}else{e=+e}}t.set(e,e)});e._storage=null}};V.getter(n.prototype,"size",function(){r(this,"size");i(this);return this["[[SetData]]"].size});b(n.prototype,{has:function has(e){r(this,"has");var t;if(this._storage&&(t=Gt(e))!==null){return!!this._storage[t]}i(this);return this["[[SetData]]"].has(e)},add:function add(e){r(this,"add");var t;if(this._storage&&(t=Gt(e))!==null){this._storage[t]=true;return this}i(this);this["[[SetData]]"].set(e,e);return this},"delete":function(e){r(this,"delete");var t;if(this._storage&&(t=Gt(e))!==null){var n=q(this._storage,t);return delete this._storage[t]&&n}i(this);return this["[[SetData]]"]["delete"](e)},clear:function clear(){r(this,"clear");if(this._storage){this._storage=Wt()}else{this["[[SetData]]"].clear()}},values:function values(){r(this,"values");i(this);return this["[[SetData]]"].values()},entries:function entries(){r(this,"entries");i(this);return this["[[SetData]]"].entries()},forEach:function forEach(e){r(this,"forEach");var n=arguments.length>1?arguments[1]:null;var o=this;i(o);this["[[SetData]]"].forEach(function(r,i){if(n){t(e,n,i,i,o)}else{e(i,i,o)}})}});g(n.prototype,"keys",n.prototype.values,true);ee(n.prototype,n.prototype.values);return n}()};if(S.Map||S.Set){var $t=i(function(){return new Map([[1,2]]).get(1)===2});if(!$t){var Jt=S.Map;S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new Jt;if(arguments.length>0){Ht(Map,e,arguments[0])}Object.setPrototypeOf(e,S.Map.prototype);g(e,"constructor",Map,true);return e};S.Map.prototype=d(Jt.prototype);V.preserveToString(S.Map,Jt)}var Ut=new Map;var Kt=function(e){e["delete"](0);e["delete"](-0);e.set(0,3);e.get(-0,4);return e.get(0)===3&&e.get(-0)===4}(Ut);var Xt=Ut.set(1,2)===Ut;if(!Kt||!Xt){var Zt=Map.prototype.set;Q(Map.prototype,"set",function set(e,r){t(Zt,this,e===0?0:e,r);return this})}if(!Kt){var Qt=Map.prototype.get;var Yt=Map.prototype.has;b(Map.prototype,{get:function get(e){return t(Qt,this,e===0?0:e)},has:function has(e){return t(Yt,this,e===0?0:e)}},true);V.preserveToString(Map.prototype.get,Qt);V.preserveToString(Map.prototype.has,Yt)}var er=new Set;var tr=function(e){e["delete"](0);e.add(-0);return!e.has(0)}(er);var rr=er.add(1)===er;if(!tr||!rr){var nr=Set.prototype.add;Set.prototype.add=function add(e){t(nr,this,e===0?0:e);return this};V.preserveToString(Set.prototype.add,nr)}if(!tr){var or=Set.prototype.has;Set.prototype.has=function has(e){return t(or,this,e===0?0:e)};V.preserveToString(Set.prototype.has,or);var ir=Set.prototype["delete"];Set.prototype["delete"]=function SetDelete(e){return t(ir,this,e===0?0:e)};V.preserveToString(Set.prototype["delete"],ir)}var ar=m(S.Map,function(e){var t=new e([]);t.set(42,42);return t instanceof e});var ur=Object.setPrototypeOf&&!ar;var sr=function(){try{return!(S.Map()instanceof S.Map)}catch(e){return e instanceof TypeError}}();if(S.Map.length!==0||ur||!sr){var fr=S.Map;S.Map=function Map(){if(!(this instanceof Map)){throw new TypeError('Constructor Map requires "new"')}var e=new fr;if(arguments.length>0){Ht(Map,e,arguments[0])}Object.setPrototypeOf(e,Map.prototype);g(e,"constructor",Map,true);return e};S.Map.prototype=fr.prototype;V.preserveToString(S.Map,fr)}var cr=m(S.Set,function(e){var t=new e([]);t.add(42,42);return t instanceof e});var lr=Object.setPrototypeOf&&!cr;var pr=function(){try{return!(S.Set()instanceof S.Set)}catch(e){return e instanceof TypeError}}();if(S.Set.length!==0||lr||!pr){var vr=S.Set;S.Set=function Set(){if(!(this instanceof Set)){throw new TypeError('Constructor Set requires "new"')}var e=new vr;if(arguments.length>0){Bt(Set,e,arguments[0])}Object.setPrototypeOf(e,Set.prototype);g(e,"constructor",Set,true);return e};S.Set.prototype=vr.prototype;V.preserveToString(S.Set,vr)}var yr=!i(function(){return(new Map).keys().next().done});if(typeof S.Map.prototype.clear!=="function"||(new S.Set).size!==0||(new S.Map).size!==0||typeof S.Map.prototype.keys!=="function"||typeof S.Set.prototype.keys!=="function"||typeof S.Map.prototype.forEach!=="function"||typeof S.Set.prototype.forEach!=="function"||a(S.Map)||a(S.Set)||typeof(new S.Map).keys().next!=="function"||yr||!ar){delete S.Map;delete S.Set;b(S,{Map:Vt.Map,Set:Vt.Set},true)}if(S.Set.prototype.keys!==S.Set.prototype.values){g(S.Set.prototype,"keys",S.Set.prototype.values,true)}ee(Object.getPrototypeOf((new S.Map).keys()));ee(Object.getPrototypeOf((new S.Set).keys()));if(f&&S.Set.prototype.has.name!=="has"){var hr=S.Set.prototype.has;Q(S.Set.prototype,"has",function has(e){return t(hr,this,e)})}}b(S,Vt);U(S.Map);U(S.Set)}if(!S.Reflect){g(S,"Reflect",{})}var gr=S.Reflect;var br=function throwUnlessTargetIsObject(e){if(!oe.TypeIsObject(e)){throw new TypeError("target must be an object")}};var dr={apply:function apply(){return e(oe.Call,null,arguments)},construct:function construct(e,t){if(!oe.IsConstructor(e)){throw new TypeError("First argument must be a constructor.")}var r=arguments.length<3?e:arguments[2];if(!oe.IsConstructor(r)){throw new TypeError("new.target must be a constructor.")}return oe.Construct(e,t,r,"internal")},deleteProperty:function deleteProperty(e,t){br(e);if(s){var r=Object.getOwnPropertyDescriptor(e,t);if(r&&!r.configurable){return false}}return delete e[t]},enumerate:function enumerate(e){br(e);return new be(e,"key")},has:function has(e,t){br(e);return t in e}};if(Object.getOwnPropertyNames){Object.assign(dr,{ownKeys:function ownKeys(e){br(e);var t=Object.getOwnPropertyNames(e);if(oe.IsCallable(Object.getOwnPropertySymbols)){A(t,Object.getOwnPropertySymbols(e))}return t}})}var mr=function ConvertExceptionToBoolean(e){return!o(e)};if(Object.preventExtensions){Object.assign(dr,{isExtensible:function isExtensible(e){br(e);return Object.isExtensible(e)},preventExtensions:function preventExtensions(e){br(e);return mr(function(){Object.preventExtensions(e)})}})}if(s){var Or=function get(e,r,n){var o=Object.getOwnPropertyDescriptor(e,r);if(!o){var i=Object.getPrototypeOf(e);if(i===null){return undefined}return Or(i,r,n)}if("value"in o){return o.value}if(o.get){return t(o.get,n)}return undefined};var wr=function set(e,r,n,o){var i=Object.getOwnPropertyDescriptor(e,r);if(!i){var a=Object.getPrototypeOf(e);if(a!==null){return wr(a,r,n,o)}i={value:void 0,writable:true,enumerable:true,configurable:true}}if("value"in i){if(!i.writable){return false}if(!oe.TypeIsObject(o)){return false}var u=Object.getOwnPropertyDescriptor(o,r);if(u){return gr.defineProperty(o,r,{value:n})}else{return gr.defineProperty(o,r,{value:n,writable:true,enumerable:true,configurable:true})}}if(i.set){t(i.set,o,n);return true}return false};Object.assign(dr,{defineProperty:function defineProperty(e,t,r){br(e);return mr(function(){Object.defineProperty(e,t,r)})},getOwnPropertyDescriptor:function getOwnPropertyDescriptor(e,t){br(e);return Object.getOwnPropertyDescriptor(e,t)},get:function get(e,t){br(e);var r=arguments.length>2?arguments[2]:e;return Or(e,t,r)},set:function set(e,t,r){br(e);var n=arguments.length>3?arguments[3]:e;return wr(e,t,r,n)}})}if(Object.getPrototypeOf){var jr=Object.getPrototypeOf;dr.getPrototypeOf=function getPrototypeOf(e){br(e);return jr(e)}}if(Object.setPrototypeOf&&dr.getPrototypeOf){var Sr=function(e,t){while(t){if(e===t){return true}t=dr.getPrototypeOf(t)}return false};Object.assign(dr,{setPrototypeOf:function setPrototypeOf(e,t){br(e);if(t!==null&&!oe.TypeIsObject(t)){throw new TypeError("proto must be an object or null")}if(t===gr.getPrototypeOf(e)){return true}if(gr.isExtensible&&!gr.isExtensible(e)){return false}if(Sr(e,t)){return false}Object.setPrototypeOf(e,t);return true}})}var Tr=function(e,t){if(!oe.IsCallable(S.Reflect[e])){g(S.Reflect,e,t)}else{var r=i(function(){S.Reflect[e](1);S.Reflect[e](NaN);S.Reflect[e](true);return true});if(r){Q(S.Reflect,e,t)}}};Object.keys(dr).forEach(function(e){Tr(e,dr[e])});if(f&&S.Reflect.getPrototypeOf.name!=="getPrototypeOf"){var Ir=S.Reflect.getPrototypeOf;Q(S.Reflect,"getPrototypeOf",function getPrototypeOf(e){return t(Ir,S.Reflect,e)})}if(S.Reflect.setPrototypeOf){if(i(function(){S.Reflect.setPrototypeOf(1,{});return true})){Q(S.Reflect,"setPrototypeOf",dr.setPrototypeOf)}}if(S.Reflect.defineProperty){if(!i(function(){var e=!S.Reflect.defineProperty(1,"test",{value:1});var t=typeof Object.preventExtensions!=="function"||!S.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})){Q(S.Reflect,"defineProperty",dr.defineProperty)}}if(S.Reflect.construct){if(!i(function(){var e=function F(){};return S.Reflect.construct(function(){},[],e)instanceof e})){Q(S.Reflect,"construct",dr.construct)}}if(String(new Date(NaN))!=="Invalid Date"){var Er=Date.prototype.toString;var Mr=function toString(){var e=+this;if(e!==e){return"Invalid Date"}return t(Er,this)};Q(Date.prototype,"toString",Mr)}var Pr={anchor:function anchor(e){return oe.CreateHTML(this,"a","name",e)},big:function big(){return oe.CreateHTML(this,"big","","")},blink:function blink(){return oe.CreateHTML(this,"blink","","")},bold:function bold(){return oe.CreateHTML(this,"b","","")},fixed:function fixed(){return oe.CreateHTML(this,"tt","","")},fontcolor:function fontcolor(e){return oe.CreateHTML(this,"font","color",e)},fontsize:function fontsize(e){return oe.CreateHTML(this,"font","size",e)},italics:function italics(){return oe.CreateHTML(this,"i","","")},link:function link(e){return oe.CreateHTML(this,"a","href",e)},small:function small(){return oe.CreateHTML(this,"small","","")},strike:function strike(){return oe.CreateHTML(this,"strike","","")},sub:function sub(){return oe.CreateHTML(this,"sub","","")},sup:function sub(){return oe.CreateHTML(this,"sup","","")}};c(Object.keys(Pr),function(e){var r=String.prototype[e];var n=false;if(oe.IsCallable(r)){var o=t(r,"",' " ');var i=x([],o.match(/"/g)).length;n=o!==o.toLowerCase()||i>2}else{n=true}if(n){Q(String.prototype,e,Pr[e])}});var xr=function(){if(!K.symbol(H.iterator)){return false}var e=typeof JSON==="object"&&typeof JSON.stringify==="function"?JSON.stringify:null;if(!e){return false}if(typeof e(H())!=="undefined"){return true}if(e([H()])!=="[null]"){return true}var t={a:H()};t[H()]=true;if(e(t)!=="{}"){return true}return false}();var Nr=i(function(){if(!K.symbol(H.iterator)){return true}return JSON.stringify(Object(H()))==="{}"&&JSON.stringify([Object(H())])==="[{}]"});if(xr||!Nr){var Cr=JSON.stringify;Q(JSON,"stringify",function stringify(e){if(typeof e==="symbol"){return}var n;if(arguments.length>1){n=arguments[1]}var o=[e];if(!r(n)){var i=oe.IsCallable(n)?n:null;var a=function(e,r){var o=n?t(n,this,e,r):r;if(typeof o!=="symbol"){if(K.symbol(o)){return We({})(o)}else{return o}}};o.push(a)}else{o.push(n)}if(arguments.length>2){o.push(arguments[2])}return Cr.apply(this,o)})}return S});
/*! jQuery v2.1.4 | (c) 2005, 2015 jQuery Foundation, Inc. | jquery.org/license */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k={},l=a.document,m="2.1.4",n=function(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(n.isPlainObject(d)||(e=n.isArray(d)))?(e?(e=!1,f=c&&n.isArray(c)?c:[]):f=c&&n.isPlainObject(c)?c:{},g[b]=n.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!n.isArray(a)&&a-parseFloat(a)+1>=0},isPlainObject:function(a){return"object"!==n.type(a)||a.nodeType||n.isWindow(a)?!1:a.constructor&&!j.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?h[i.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=n.trim(a),a&&(1===a.indexOf("use strict")?(b=l.createElement("script"),b.text=a,l.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){return null==b?-1:g.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(c=a[b],b=a,a=c),n.isFunction(a)?(e=d.call(arguments,2),f=function(){return a.apply(b||this,e.concat(d.call(arguments)))},f.guid=a.guid=a.guid||n.guid++,f):void 0},now:Date.now,support:k}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});function s(a){var b="length"in a&&a.length,c=n.type(a);return"function"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u="sizzle"+1*new Date,v=a.document,w=0,x=0,y=ha(),z=ha(),A=ha(),B=function(a,b){return a===b&&(l=!0),0},C=1<<31,D={}.hasOwnProperty,E=[],F=E.pop,G=E.push,H=E.push,I=E.slice,J=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",N=M.replace("w","w#"),O="\\["+L+"*("+M+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+L+"*\\]",P=":("+M+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+O+")*)|.*)\\)|)",Q=new RegExp(L+"+","g"),R=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),S=new RegExp("^"+L+"*,"+L+"*"),T=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),U=new RegExp("="+L+"*([^\\]'\"]*?)"+L+"*\\]","g"),V=new RegExp(P),W=new RegExp("^"+N+"$"),X={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+O),PSEUDO:new RegExp("^"+P),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,_=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,aa=/[+~]/,ba=/'|\\/g,ca=new RegExp("\\\\([\\da-f]{1,6}"+L+"?|("+L+")|.)","ig"),da=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)},ea=function(){m()};try{H.apply(E=I.call(v.childNodes),v.childNodes),E[v.childNodes.length].nodeType}catch(fa){H={apply:E.length?function(a,b){G.apply(a,I.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function ga(a,b,d,e){var f,h,j,k,l,o,r,s,w,x;if((b?b.ownerDocument||b:v)!==n&&m(b),b=b||n,d=d||[],k=b.nodeType,"string"!=typeof a||!a||1!==k&&9!==k&&11!==k)return d;if(!e&&p){if(11!==k&&(f=_.exec(a)))if(j=f[1]){if(9===k){if(h=b.getElementById(j),!h||!h.parentNode)return d;if(h.id===j)return d.push(h),d}else if(b.ownerDocument&&(h=b.ownerDocument.getElementById(j))&&t(b,h)&&h.id===j)return d.push(h),d}else{if(f[2])return H.apply(d,b.getElementsByTagName(a)),d;if((j=f[3])&&c.getElementsByClassName)return H.apply(d,b.getElementsByClassName(j)),d}if(c.qsa&&(!q||!q.test(a))){if(s=r=u,w=b,x=1!==k&&a,1===k&&"object"!==b.nodeName.toLowerCase()){o=g(a),(r=b.getAttribute("id"))?s=r.replace(ba,"\\$&"):b.setAttribute("id",s),s="[id='"+s+"'] ",l=o.length;while(l--)o[l]=s+ra(o[l]);w=aa.test(a)&&pa(b.parentNode)||b,x=o.join(",")}if(x)try{return H.apply(d,w.querySelectorAll(x)),d}catch(y){}finally{r||b.removeAttribute("id")}}}return i(a.replace(R,"$1"),b,d,e)}function ha(){var a=[];function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}return b}function ia(a){return a[u]=!0,a}function ja(a){var b=n.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function ka(a,b){var c=a.split("|"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function la(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||C)-(~a.sourceIndex||C);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function ma(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function na(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function oa(a){return ia(function(b){return b=+b,ia(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function pa(a){return a&&"undefined"!=typeof a.getElementsByTagName&&a}c=ga.support={},f=ga.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},m=ga.setDocument=function(a){var b,e,g=a?a.ownerDocument||a:v;return g!==n&&9===g.nodeType&&g.documentElement?(n=g,o=g.documentElement,e=g.defaultView,e&&e!==e.top&&(e.addEventListener?e.addEventListener("unload",ea,!1):e.attachEvent&&e.attachEvent("onunload",ea)),p=!f(g),c.attributes=ja(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=ja(function(a){return a.appendChild(g.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=$.test(g.getElementsByClassName),c.getById=ja(function(a){return o.appendChild(a).id=u,!g.getElementsByName||!g.getElementsByName(u).length}),c.getById?(d.find.ID=function(a,b){if("undefined"!=typeof b.getElementById&&p){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ca,da);return function(a){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a):c.qsa?b.querySelectorAll(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return p?b.getElementsByClassName(a):void 0},r=[],q=[],(c.qsa=$.test(g.querySelectorAll))&&(ja(function(a){o.appendChild(a).innerHTML="<a id='"+u+"'></a><select id='"+u+"-\f]' msallowcapture=''><option selected=''></option></select>",a.querySelectorAll("[msallowcapture^='']").length&&q.push("[*^$]="+L+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||q.push("\\["+L+"*(?:value|"+K+")"),a.querySelectorAll("[id~="+u+"-]").length||q.push("~="),a.querySelectorAll(":checked").length||q.push(":checked"),a.querySelectorAll("a#"+u+"+*").length||q.push(".#.+[+~]")}),ja(function(a){var b=g.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&q.push("name"+L+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||q.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),q.push(",.*:")})),(c.matchesSelector=$.test(s=o.matches||o.webkitMatchesSelector||o.mozMatchesSelector||o.oMatchesSelector||o.msMatchesSelector))&&ja(function(a){c.disconnectedMatch=s.call(a,"div"),s.call(a,"[s!='']:x"),r.push("!=",P)}),q=q.length&&new RegExp(q.join("|")),r=r.length&&new RegExp(r.join("|")),b=$.test(o.compareDocumentPosition),t=b||$.test(o.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},B=b?function(a,b){if(a===b)return l=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===g||a.ownerDocument===v&&t(v,a)?-1:b===g||b.ownerDocument===v&&t(v,b)?1:k?J(k,a)-J(k,b):0:4&d?-1:1)}:function(a,b){if(a===b)return l=!0,0;var c,d=0,e=a.parentNode,f=b.parentNode,h=[a],i=[b];if(!e||!f)return a===g?-1:b===g?1:e?-1:f?1:k?J(k,a)-J(k,b):0;if(e===f)return la(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)i.unshift(c);while(h[d]===i[d])d++;return d?la(h[d],i[d]):h[d]===v?-1:i[d]===v?1:0},g):n},ga.matches=function(a,b){return ga(a,null,null,b)},ga.matchesSelector=function(a,b){if((a.ownerDocument||a)!==n&&m(a),b=b.replace(U,"='$1']"),!(!c.matchesSelector||!p||r&&r.test(b)||q&&q.test(b)))try{var d=s.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return ga(b,n,null,[a]).length>0},ga.contains=function(a,b){return(a.ownerDocument||a)!==n&&m(a),t(a,b)},ga.attr=function(a,b){(a.ownerDocument||a)!==n&&m(a);var e=d.attrHandle[b.toLowerCase()],f=e&&D.call(d.attrHandle,b.toLowerCase())?e(a,b,!p):void 0;return void 0!==f?f:c.attributes||!p?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},ga.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},ga.uniqueSort=function(a){var b,d=[],e=0,f=0;if(l=!c.detectDuplicates,k=!c.sortStable&&a.slice(0),a.sort(B),l){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return k=null,a},e=ga.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=ga.selectors={cacheLength:50,createPseudo:ia,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ca,da),a[3]=(a[3]||a[4]||a[5]||"").replace(ca,da),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||ga.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&ga.error(a[0]),a},PSEUDO:function(a){var b,c=!a[6]&&a[2];return X.CHILD.test(a[0])?null:(a[3]?a[2]=a[4]||a[5]||"":c&&V.test(c)&&(b=g(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ca,da).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=y[a+" "];return b||(b=new RegExp("(^|"+L+")"+a+"("+L+"|$)"))&&y(a,function(a){return b.test("string"==typeof a.className&&a.className||"undefined"!=typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=ga.attr(d,a);return null==e?"!="===b:b?(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&e.indexOf(c)>-1:"$="===b?c&&e.slice(-c.length)===c:"~="===b?(" "+e.replace(Q," ")+" ").indexOf(c)>-1:"|="===b?e===c||e.slice(0,c.length+1)===c+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){k=q[u]||(q[u]={}),j=k[a]||[],n=j[0]===w&&j[1],m=j[0]===w&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[w,n,m];break}}else if(s&&(j=(b[u]||(b[u]={}))[a])&&j[0]===w)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(s&&((l[u]||(l[u]={}))[a]=[w,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||ga.error("unsupported pseudo: "+a);return e[u]?e(b):e.length>1?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?ia(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=J(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:ia(function(a){var b=[],c=[],d=h(a.replace(R,"$1"));return d[u]?ia(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),b[0]=null,!c.pop()}}),has:ia(function(a){return function(b){return ga(a,b).length>0}}),contains:ia(function(a){return a=a.replace(ca,da),function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:ia(function(a){return W.test(a||"")||ga.error("unsupported lang: "+a),a=a.replace(ca,da).toLowerCase(),function(b){var c;do if(c=p?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===o},focus:function(a){return a===n.activeElement&&(!n.hasFocus||n.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return Z.test(a.nodeName)},input:function(a){return Y.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:oa(function(){return[0]}),last:oa(function(a,b){return[b-1]}),eq:oa(function(a,b,c){return[0>c?c+b:c]}),even:oa(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:oa(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:oa(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:oa(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=ma(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=na(b);function qa(){}qa.prototype=d.filters=d.pseudos,d.setFilters=new qa,g=ga.tokenize=function(a,b){var c,e,f,g,h,i,j,k=z[a+" "];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=S.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=T.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(R," ")}),h=h.slice(c.length));for(g in d.filter)!(e=X[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?ga.error(a):z(a,i).slice(0)};function ra(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function sa(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=x++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[w,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[u]||(b[u]={}),(h=i[d])&&h[0]===w&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function ta(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function ua(a,b,c){for(var d=0,e=b.length;e>d;d++)ga(a,b[d],c);return c}function va(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function wa(a,b,c,d,e,f){return d&&!d[u]&&(d=wa(d)),e&&!e[u]&&(e=wa(e,f)),ia(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||ua(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:va(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=va(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?J(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=va(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):H.apply(g,r)})}function xa(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],h=g||d.relative[" "],i=g?1:0,k=sa(function(a){return a===b},h,!0),l=sa(function(a){return J(b,a)>-1},h,!0),m=[function(a,c,d){var e=!g&&(d||c!==j)||((b=c).nodeType?k(a,c,d):l(a,c,d));return b=null,e}];f>i;i++)if(c=d.relative[a[i].type])m=[sa(ta(m),c)];else{if(c=d.filter[a[i].type].apply(null,a[i].matches),c[u]){for(e=++i;f>e;e++)if(d.relative[a[e].type])break;return wa(i>1&&ta(m),i>1&&ra(a.slice(0,i-1).concat({value:" "===a[i-2].type?"*":""})).replace(R,"$1"),c,e>i&&xa(a.slice(i,e)),f>e&&xa(a=a.slice(e)),f>e&&ra(a))}m.push(c)}return ta(m)}function ya(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,h,i,k){var l,m,o,p=0,q="0",r=f&&[],s=[],t=j,u=f||e&&d.find.TAG("*",k),v=w+=null==t?1:Math.random()||.1,x=u.length;for(k&&(j=g!==n&&g);q!==x&&null!=(l=u[q]);q++){if(e&&l){m=0;while(o=a[m++])if(o(l,g,h)){i.push(l);break}k&&(w=v)}c&&((l=!o&&l)&&p--,f&&r.push(l))}if(p+=q,c&&q!==p){m=0;while(o=b[m++])o(r,s,g,h);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=F.call(i));s=va(s)}H.apply(i,s),k&&!f&&s.length>0&&p+b.length>1&&ga.uniqueSort(i)}return k&&(w=v,j=t),r};return c?ia(f):f}return h=ga.compile=function(a,b){var c,d=[],e=[],f=A[a+" "];if(!f){b||(b=g(a)),c=b.length;while(c--)f=xa(b[c]),f[u]?d.push(f):e.push(f);f=A(a,ya(e,d)),f.selector=a}return f},i=ga.select=function(a,b,e,f){var i,j,k,l,m,n="function"==typeof a&&a,o=!f&&g(a=n.selector||a);if(e=e||[],1===o.length){if(j=o[0]=o[0].slice(0),j.length>2&&"ID"===(k=j[0]).type&&c.getById&&9===b.nodeType&&p&&d.relative[j[1].type]){if(b=(d.find.ID(k.matches[0].replace(ca,da),b)||[])[0],!b)return e;n&&(b=b.parentNode),a=a.slice(j.shift().value.length)}i=X.needsContext.test(a)?0:j.length;while(i--){if(k=j[i],d.relative[l=k.type])break;if((m=d.find[l])&&(f=m(k.matches[0].replace(ca,da),aa.test(j[0].type)&&pa(b.parentNode)||b))){if(j.splice(i,1),a=f.length&&ra(j),!a)return H.apply(e,f),e;break}}}return(n||h(a,o))(f,b,!p,e,aa.test(a)&&pa(b.parentNode)||b),e},c.sortStable=u.split("").sort(B).join("")===u,c.detectDuplicates=!!l,m(),c.sortDetached=ja(function(a){return 1&a.compareDocumentPosition(n.createElement("div"))}),ja(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||ka("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&ja(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||ka("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),ja(function(a){return null==a.getAttribute("disabled")})||ka(K,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),ga}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return g.call(b,a)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;c>b;b++)if(n.contains(e[b],this))return!0}));for(b=0;c>b;b++)n.find(a,e[b],d);return d=this.pushStack(c>1?n.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,A=n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:z.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:l,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=l.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=l,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?"undefined"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};A.prototype=n.fn,y=n(l);var B=/^(?:parents|prev(?:Until|All))/,C={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=void 0!==c;while((a=a[b])&&9!==a.nodeType)if(1===a.nodeType){if(e&&n(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b=n(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(n.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?"string"==typeof a?g.call(n(a),this[0]):g.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function D(a,b){while((a=a[b])&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return D(a,"nextSibling")},prev:function(a){return D(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return a.contentDocument||n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),this.length>1&&(C[a]||n.unique(e),B.test(a)&&e.reverse()),this.pushStack(e)}});var E=/\S+/g,F={};function G(a){var b=F[a]={};return n.each(a.match(E)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a="string"==typeof a?F[a]||G(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(b=a.memory&&l,c=!0,g=e||0,e=0,f=h.length,d=!0;h&&f>g;g++)if(h[g].apply(l[0],l[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,h&&(i?i.length&&j(i.shift()):b?h=[]:k.disable())},k={add:function(){if(h){var c=h.length;!function g(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&g(c)})}(arguments),d?f=h.length:b&&(e=c,j(b))}return this},remove:function(){return h&&n.each(arguments,function(a,b){var c;while((c=n.inArray(b,h,c))>-1)h.splice(c,1),d&&(f>=c&&f--,g>=c&&g--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],f=0,this},disable:function(){return h=i=b=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,b||k.disable(),this},locked:function(){return!i},fireWith:function(a,b){return!h||c&&!i||(b=b||[],b=[a,b.slice?b.slice():b],d?i.push(b):j(b)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!c}};return k},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var H;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){(a===!0?--n.readyWait:n.isReady)||(n.isReady=!0,a!==!0&&--n.readyWait>0||(H.resolveWith(l,[n]),n.fn.triggerHandler&&(n(l).triggerHandler("ready"),n(l).off("ready"))))}});function I(){l.removeEventListener("DOMContentLoaded",I,!1),a.removeEventListener("load",I,!1),n.ready()}n.ready.promise=function(b){return H||(H=n.Deferred(),"complete"===l.readyState?setTimeout(n.ready):(l.addEventListener("DOMContentLoaded",I,!1),a.addEventListener("load",I,!1))),H.promise(b)},n.ready.promise();var J=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};n.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};function K(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=n.expando+K.uid++}K.uid=1,K.accepts=n.acceptData,K.prototype={key:function(a){if(!K.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=K.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,n.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(n.isEmptyObject(f))n.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,n.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{n.isArray(b)?d=b.concat(b.map(n.camelCase)):(e=n.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(E)||[])),c=d.length;while(c--)delete g[d[c]]}},hasData:function(a){return!n.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var L=new K,M=new K,N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(O,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}M.set(a,b,c)}else c=void 0;return c}n.extend({hasData:function(a){return M.hasData(a)||L.hasData(a)},data:function(a,b,c){
return M.access(a,b,c)},removeData:function(a,b){M.remove(a,b)},_data:function(a,b,c){return L.access(a,b,c)},_removeData:function(a,b){L.remove(a,b)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=M.get(f),1===f.nodeType&&!L.get(f,"hasDataAttrs"))){c=g.length;while(c--)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d])));L.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){M.set(this,a)}):J(this,function(b){var c,d=n.camelCase(a);if(f&&void 0===b){if(c=M.get(f,a),void 0!==c)return c;if(c=M.get(f,d),void 0!==c)return c;if(c=P(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=M.get(this,d);M.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&M.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){M.remove(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=L.get(a,b),c&&(!d||n.isArray(c)?d=L.access(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return L.get(a,c)||L.access(a,c,{empty:n.Callbacks("once memory").add(function(){L.remove(a,[b+"queue",c])})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};"string"!=typeof a&&(b=a,a=void 0),a=a||"fx";while(g--)c=L.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,R=["Top","Right","Bottom","Left"],S=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},T=/^(?:checkbox|radio)$/i;!function(){var a=l.createDocumentFragment(),b=a.appendChild(l.createElement("div")),c=l.createElement("input");c.setAttribute("type","radio"),c.setAttribute("checked","checked"),c.setAttribute("name","t"),b.appendChild(c),k.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var U="undefined";k.focusinBubbles="onfocusin"in a;var V=/^key/,W=/^(?:mouse|pointer|contextmenu)|click/,X=/^(?:focusinfocus|focusoutblur)$/,Y=/^([^.]*)(?:\.(.+)|)$/;function Z(){return!0}function $(){return!1}function _(){try{return l.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.get(a);if(r){c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=n.guid++),(i=r.events)||(i=r.events={}),(g=r.handle)||(g=r.handle=function(b){return typeof n!==U&&n.event.triggered!==b.type?n.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(E)||[""],j=b.length;while(j--)h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o&&(l=n.event.special[o]||{},o=(e?l.delegateType:l.bindType)||o,l=n.event.special[o]||{},k=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},f),(m=i[o])||(m=i[o]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,p,g)!==!1||a.addEventListener&&a.addEventListener(o,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),n.event.global[o]=!0)}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=L.hasData(a)&&L.get(a);if(r&&(i=r.events)){b=(b||"").match(E)||[""],j=b.length;while(j--)if(h=Y.exec(b[j])||[],o=q=h[1],p=(h[2]||"").split(".").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=i[o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;while(f--)k=m[f],!e&&q!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete i[o])}else for(o in i)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(i)&&(delete r.handle,L.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,m,o,p=[d||l],q=j.call(b,"type")?b.type:b,r=j.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||l,3!==d.nodeType&&8!==d.nodeType&&!X.test(q+n.event.triggered)&&(q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),k=q.indexOf(":")<0&&"on"+q,b=b[n.expando]?b:new n.Event(q,"object"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=r.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),o=n.event.special[q]||{},e||!o.trigger||o.trigger.apply(d,c)!==!1)){if(!e&&!o.noBubble&&!n.isWindow(d)){for(i=o.delegateType||q,X.test(i+q)||(g=g.parentNode);g;g=g.parentNode)p.push(g),h=g;h===(d.ownerDocument||l)&&p.push(h.defaultView||h.parentWindow||a)}f=0;while((g=p[f++])&&!b.isPropagationStopped())b.type=f>1?i:o.bindType||q,m=(L.get(g,"events")||{})[b.type]&&L.get(g,"handle"),m&&m.apply(g,c),m=k&&g[k],m&&m.apply&&n.acceptData(g)&&(b.result=m.apply(g,c),b.result===!1&&b.preventDefault());return b.type=q,e||b.isDefaultPrevented()||o._default&&o._default.apply(p.pop(),c)!==!1||!n.acceptData(d)||k&&n.isFunction(d[q])&&!n.isWindow(d)&&(h=d[k],h&&(d[k]=null),n.event.triggered=q,d[q](),n.event.triggered=void 0,h&&(d[k]=h)),b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(L.get(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,c=0;while((g=f.handlers[c++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(g.namespace))&&(a.handleObj=g,a.data=g.data,e=((n.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),void 0!==e&&(a.result=e)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?n(e,this).index(i)>=0:n.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||l,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=W.test(e)?this.mouseHooks:V.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=l),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==_()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===_()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&n.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.returnValue===!1?Z:$):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:$,isPropagationStopped:$,isImmediatePropagationStopped:$,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=Z,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=Z,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=Z,a&&a.stopImmediatePropagation&&a.stopImmediatePropagation(),this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),k.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=L.access(d,b);e||d.addEventListener(a,c,!0),L.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=L.access(d,b)-1;e?L.access(d,b,e):(d.removeEventListener(a,c,!0),L.remove(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=$;else if(!d)return this;return 1===e&&(f=d,d=function(a){return n().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||"function"==typeof b)&&(c=b,b=void 0),c===!1&&(c=$),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});var aa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ba=/<([\w:]+)/,ca=/<|&#?\w+;/,da=/<(?:script|style|link)/i,ea=/checked\s*(?:[^=]|=\s*.checked.)/i,fa=/^$|\/(?:java|ecma)script/i,ga=/^true\/(.*)/,ha=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ia={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ia.optgroup=ia.option,ia.tbody=ia.tfoot=ia.colgroup=ia.caption=ia.thead,ia.th=ia.td;function ja(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function ka(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function la(a){var b=ga.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function ma(a,b){for(var c=0,d=a.length;d>c;c++)L.set(a[c],"globalEval",!b||L.get(b[c],"globalEval"))}function na(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(L.hasData(a)&&(f=L.access(a),g=L.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)n.event.add(b,e,j[e][c])}M.hasData(a)&&(h=M.access(a),i=n.extend({},h),M.set(b,i))}}function oa(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&n.nodeName(a,b)?n.merge([a],c):c}function pa(a,b){var c=b.nodeName.toLowerCase();"input"===c&&T.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}n.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=n.contains(a.ownerDocument,a);if(!(k.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(g=oa(h),f=oa(a),d=0,e=f.length;e>d;d++)pa(f[d],g[d]);if(b)if(c)for(f=f||oa(a),g=g||oa(h),d=0,e=f.length;e>d;d++)na(f[d],g[d]);else na(a,h);return g=oa(h,"script"),g.length>0&&ma(g,!i&&oa(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,o=a.length;o>m;m++)if(e=a[m],e||0===e)if("object"===n.type(e))n.merge(l,e.nodeType?[e]:e);else if(ca.test(e)){f=f||k.appendChild(b.createElement("div")),g=(ba.exec(e)||["",""])[1].toLowerCase(),h=ia[g]||ia._default,f.innerHTML=h[1]+e.replace(aa,"<$1></$2>")+h[2],j=h[0];while(j--)f=f.lastChild;n.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));k.textContent="",m=0;while(e=l[m++])if((!d||-1===n.inArray(e,d))&&(i=n.contains(e.ownerDocument,e),f=oa(k.appendChild(e),"script"),i&&ma(f),c)){j=0;while(e=f[j++])fa.test(e.type||"")&&c.push(e)}return k},cleanData:function(a){for(var b,c,d,e,f=n.event.special,g=0;void 0!==(c=a[g]);g++){if(n.acceptData(c)&&(e=c[L.expando],e&&(b=L.cache[e]))){if(b.events)for(d in b.events)f[d]?n.event.remove(c,d):n.removeEvent(c,d,b.handle);L.cache[e]&&delete L.cache[e]}delete M.cache[c[M.expando]]}}}),n.fn.extend({text:function(a){return J(this,function(a){return void 0===a?n.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=ja(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=ja(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(oa(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&ma(oa(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(n.cleanData(oa(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return J(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!da.test(a)&&!ia[(ba.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(aa,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(oa(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(oa(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,l=this.length,m=this,o=l-1,p=a[0],q=n.isFunction(p);if(q||l>1&&"string"==typeof p&&!k.checkClone&&ea.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(l&&(c=n.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(f=n.map(oa(c,"script"),ka),g=f.length;l>j;j++)h=c,j!==o&&(h=n.clone(h,!0,!0),g&&n.merge(f,oa(h,"script"))),b.call(this[j],h,j);if(g)for(i=f[f.length-1].ownerDocument,n.map(f,la),j=0;g>j;j++)h=f[j],fa.test(h.type||"")&&!L.access(h,"globalEval")&&n.contains(i,h)&&(h.src?n._evalUrl&&n._evalUrl(h.src):n.globalEval(h.textContent.replace(ha,"")))}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=[],e=n(a),g=e.length-1,h=0;g>=h;h++)c=h===g?this:this.clone(!0),n(e[h])[b](c),f.apply(d,c.get());return this.pushStack(d)}});var qa,ra={};function sa(b,c){var d,e=n(c.createElement(b)).appendTo(c.body),f=a.getDefaultComputedStyle&&(d=a.getDefaultComputedStyle(e[0]))?d.display:n.css(e[0],"display");return e.detach(),f}function ta(a){var b=l,c=ra[a];return c||(c=sa(a,b),"none"!==c&&c||(qa=(qa||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=qa[0].contentDocument,b.write(),b.close(),c=sa(a,b),qa.detach()),ra[a]=c),c}var ua=/^margin/,va=new RegExp("^("+Q+")(?!px)[a-z%]+$","i"),wa=function(b){return b.ownerDocument.defaultView.opener?b.ownerDocument.defaultView.getComputedStyle(b,null):a.getComputedStyle(b,null)};function xa(a,b,c){var d,e,f,g,h=a.style;return c=c||wa(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),va.test(g)&&ua.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function ya(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d=l.documentElement,e=l.createElement("div"),f=l.createElement("div");if(f.style){f.style.backgroundClip="content-box",f.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===f.style.backgroundClip,e.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",e.appendChild(f);function g(){f.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",f.innerHTML="",d.appendChild(e);var g=a.getComputedStyle(f,null);b="1%"!==g.top,c="4px"===g.width,d.removeChild(e)}a.getComputedStyle&&n.extend(k,{pixelPosition:function(){return g(),b},boxSizingReliable:function(){return null==c&&g(),c},reliableMarginRight:function(){var b,c=f.appendChild(l.createElement("div"));return c.style.cssText=f.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",c.style.marginRight=c.style.width="0",f.style.width="1px",d.appendChild(e),b=!parseFloat(a.getComputedStyle(c,null).marginRight),d.removeChild(e),f.removeChild(c),b}})}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var za=/^(none|table(?!-c[ea]).+)/,Aa=new RegExp("^("+Q+")(.*)$","i"),Ba=new RegExp("^([+-])=("+Q+")","i"),Ca={position:"absolute",visibility:"hidden",display:"block"},Da={letterSpacing:"0",fontWeight:"400"},Ea=["Webkit","O","Moz","ms"];function Fa(a,b){if(b in a)return b;var c=b[0].toUpperCase()+b.slice(1),d=b,e=Ea.length;while(e--)if(b=Ea[e]+c,b in a)return b;return d}function Ga(a,b,c){var d=Aa.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Ha(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=n.css(a,c+R[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+R[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+R[f]+"Width",!0,e))):(g+=n.css(a,"padding"+R[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+R[f]+"Width",!0,e)));return g}function Ia(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=wa(a),g="border-box"===n.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=xa(a,b,f),(0>e||null==e)&&(e=a.style[b]),va.test(e))return e;d=g&&(k.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Ha(a,b,c||(g?"border":"content"),d,f)+"px"}function Ja(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=L.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&S(d)&&(f[g]=L.access(d,"olddisplay",ta(d.nodeName)))):(e=S(d),"none"===c&&e||L.set(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=xa(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;return b=n.cssProps[h]||(n.cssProps[h]=Fa(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Ba.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||n.cssNumber[h]||(c+="px"),k.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Fa(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=xa(a,b,d)),"normal"===e&&b in Da&&(e=Da[b]),""===c||c?(f=parseFloat(e),c===!0||n.isNumeric(f)?f||0:e):e}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?za.test(n.css(a,"display"))&&0===a.offsetWidth?n.swap(a,Ca,function(){return Ia(a,b,d)}):Ia(a,b,d):void 0},set:function(a,c,d){var e=d&&wa(a);return Ga(a,c,d?Ha(a,b,d,"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}}),n.cssHooks.marginRight=ya(k.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},xa,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+R[d]+b]=f[d]||f[d-2]||f[0];return e}},ua.test(a)||(n.cssHooks[a+b].set=Ga)}),n.fn.extend({css:function(a,b){return J(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=wa(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,arguments.length>1)},show:function(){return Ja(this,!0)},hide:function(){return Ja(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){S(this)?n(this).show():n(this).hide()})}});function Ka(a,b,c,d,e){return new Ka.prototype.init(a,b,c,d,e)}n.Tween=Ka,Ka.prototype={constructor:Ka,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=Ka.propHooks[this.prop];return a&&a.get?a.get(this):Ka.propHooks._default.get(this)},run:function(a){var b,c=Ka.propHooks[this.prop];return this.options.duration?this.pos=b=n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):Ka.propHooks._default.set(this),this}},Ka.prototype.init.prototype=Ka.prototype,Ka.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},Ka.propHooks.scrollTop=Ka.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=Ka.prototype.init,n.fx.step={};var La,Ma,Na=/^(?:toggle|show|hide)$/,Oa=new RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),Pa=/queueHooks$/,Qa=[Va],Ra={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Oa.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&Oa.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function Sa(){return setTimeout(function(){La=void 0}),La=n.now()}function Ta(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=R[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function Ua(a,b,c){for(var d,e=(Ra[b]||[]).concat(Ra["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function Va(a,b,c){var d,e,f,g,h,i,j,k,l=this,m={},o=a.style,p=a.nodeType&&S(a),q=L.get(a,"fxshow");c.queue||(h=n._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,l.always(function(){l.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[o.overflow,o.overflowX,o.overflowY],j=n.css(a,"display"),k="none"===j?L.get(a,"olddisplay")||ta(a.nodeName):j,"inline"===k&&"none"===n.css(a,"float")&&(o.display="inline-block")),c.overflow&&(o.overflow="hidden",l.always(function(){o.overflow=c.overflow[0],o.overflowX=c.overflow[1],o.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Na.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(p?"hide":"show")){if("show"!==e||!q||void 0===q[d])continue;p=!0}m[d]=q&&q[d]||n.style(a,d)}else j=void 0;if(n.isEmptyObject(m))"inline"===("none"===j?ta(a.nodeName):j)&&(o.display=j);else{q?"hidden"in q&&(p=q.hidden):q=L.access(a,"fxshow",{}),f&&(q.hidden=!p),p?n(a).show():l.done(function(){n(a).hide()}),l.done(function(){var b;L.remove(a,"fxshow");for(b in m)n.style(a,b,m[b])});for(d in m)g=Ua(p?q[d]:0,d,l),d in q||(q[d]=g.start,p&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function Wa(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function Xa(a,b,c){var d,e,f=0,g=Qa.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=La||Sa(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:La||Sa(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(Wa(k,j.opts.specialEasing);g>f;f++)if(d=Qa[f].call(j,a,k,j.opts))return d;return n.map(k,Ua,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(Xa,{tweener:function(a,b){n.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],Ra[c]=Ra[c]||[],Ra[c].unshift(b)},prefilter:function(a,b){b?Qa.unshift(a):Qa.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(S).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=Xa(this,n.extend({},a),f);(e||L.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=L.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Pa.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=L.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(Ta(b,!0),a,d,e)}}),n.each({slideDown:Ta("show"),slideUp:Ta("hide"),slideToggle:Ta("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=0,c=n.timers;for(La=n.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||n.fx.stop(),La=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){Ma||(Ma=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(Ma),Ma=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=l.createElement("input"),b=l.createElement("select"),c=b.appendChild(l.createElement("option"));a.type="checkbox",k.checkOn=""!==a.value,k.optSelected=c.selected,b.disabled=!0,k.optDisabled=!c.disabled,a=l.createElement("input"),a.value="t",a.type="radio",k.radioValue="t"===a.value}();var Ya,Za,$a=n.expr.attrHandle;n.fn.extend({attr:function(a,b){return J(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===U?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?Za:Ya)),
void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(E);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!k.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),Za={set:function(a,b,c){return b===!1?n.removeAttr(a,c):a.setAttribute(c,c),c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=$a[b]||n.find.attr;$a[b]=function(a,b,d){var e,f;return d||(f=$a[b],$a[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,$a[b]=f),e}});var _a=/^(?:input|select|textarea|button)$/i;n.fn.extend({prop:function(a,b){return J(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[n.propFix[a]||a]})}}),n.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||_a.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),k.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this});var ab=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ab," "):" ")){f=0;while(e=b[f++])d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(E)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(ab," "):"")){f=0;while(e=b[f++])while(d.indexOf(" "+e+" ")>=0)d=d.replace(" "+e+" "," ");g=a?n.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c){var b,d=0,e=n(this),f=a.match(E)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===U||"boolean"===c)&&(this.className&&L.set(this,"__className__",this.className),this.className=this.className||a===!1?"":L.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(ab," ").indexOf(b)>=0)return!0;return!1}});var bb=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(bb,""):null==c?"":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.trim(n.text(a))}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(k.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)d=e[g],(d.selected=n.inArray(d.value,f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},k.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var cb=n.now(),db=/\?/;n.parseJSON=function(a){return JSON.parse(a+"")},n.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return(!b||b.getElementsByTagName("parsererror").length)&&n.error("Invalid XML: "+a),b};var eb=/#.*$/,fb=/([?&])_=[^&]*/,gb=/^(.*?):[ \t]*([^\r\n]*)$/gm,hb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ib=/^(?:GET|HEAD)$/,jb=/^\/\//,kb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,lb={},mb={},nb="*/".concat("*"),ob=a.location.href,pb=kb.exec(ob.toLowerCase())||[];function qb(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(E)||[];if(n.isFunction(c))while(d=f[e++])"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function rb(a,b,c,d){var e={},f=a===mb;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function sb(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&n.extend(!0,a,d),a}function tb(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while("*"===i[0])i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function ub(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ob,type:"GET",isLocal:hb.test(pb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":nb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?sb(sb(a,n.ajaxSettings),b):sb(n.ajaxSettings,a)},ajaxPrefilter:qb(lb),ajaxTransport:qb(mb),ajax:function(a,b){"object"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!f){f={};while(b=gb.exec(e))f[b[1].toLowerCase()]=b[2]}b=f[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?e:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return c&&c.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||ob)+"").replace(eb,"").replace(jb,pb[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(E)||[""],null==k.crossDomain&&(h=kb.exec(k.url.toLowerCase()),k.crossDomain=!(!h||h[1]===pb[1]&&h[2]===pb[2]&&(h[3]||("http:"===h[1]?"80":"443"))===(pb[3]||("http:"===pb[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),rb(lb,k,b,v),2===t)return v;i=n.event&&k.global,i&&0===n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!ib.test(k.type),d=k.url,k.hasContent||(k.data&&(d=k.url+=(db.test(d)?"&":"?")+k.data,delete k.data),k.cache===!1&&(k.url=fb.test(d)?d.replace(fb,"$1_="+cb++):d+(db.test(d)?"&":"?")+"_="+cb++)),k.ifModified&&(n.lastModified[d]&&v.setRequestHeader("If-Modified-Since",n.lastModified[d]),n.etag[d]&&v.setRequestHeader("If-None-Match",n.etag[d])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+nb+"; q=0.01":""):k.accepts["*"]);for(j in k.headers)v.setRequestHeader(j,k.headers[j]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u="abort";for(j in{success:1,error:1,complete:1})v[j](k[j]);if(c=rb(mb,k,b,v)){v.readyState=1,i&&m.trigger("ajaxSend",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,c.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,f,h){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),c=void 0,e=h||"",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,f&&(u=tb(k,v,f)),u=ub(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader("Last-Modified"),w&&(n.lastModified[d]=w),w=v.getResponseHeader("etag"),w&&(n.etag[d]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,i&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),i&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},n.fn.extend({wrapAll:function(a){var b;return n.isFunction(a)?this.each(function(b){n(this).wrapAll(a.call(this,b))}):(this[0]&&(b=n(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstElementChild)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var vb=/%20/g,wb=/\[\]$/,xb=/\r?\n/g,yb=/^(?:submit|button|image|reset|file)$/i,zb=/^(?:input|select|textarea|keygen)/i;function Ab(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||wb.test(a)?d(a,e):Ab(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Ab(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Ab(c,a[c],b,e);return d.join("&").replace(vb,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&zb.test(this.nodeName)&&!yb.test(a)&&(this.checked||!T.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(xb,"\r\n")}}):{name:b.name,value:c.replace(xb,"\r\n")}}).get()}}),n.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Bb=0,Cb={},Db={0:200,1223:204},Eb=n.ajaxSettings.xhr();a.attachEvent&&a.attachEvent("onunload",function(){for(var a in Cb)Cb[a]()}),k.cors=!!Eb&&"withCredentials"in Eb,k.ajax=Eb=!!Eb,n.ajaxTransport(function(a){var b;return k.cors||Eb&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Bb;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Cb[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Db[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Cb[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h}},abort:function(){b&&b()}}:void 0}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=n("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),l.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Fb=[],Gb=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Fb.pop()||n.expando+"_"+cb++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Gb.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Gb.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Gb,"$1"+e):b.jsonp!==!1&&(b.url+=(db.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Fb.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||l;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var Hb=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&Hb)return Hb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=n.trim(a.slice(h)),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&n.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var Ib=a.document.documentElement;function Jb(a){return n.isWindow(a)?a:9===a.nodeType&&a.defaultView}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,n.contains(b,d)?(typeof d.getBoundingClientRect!==U&&(e=d.getBoundingClientRect()),c=Jb(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===n.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(d=a.offset()),d.top+=n.css(a[0],"borderTopWidth",!0),d.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-n.css(c,"marginTop",!0),left:b.left-d.left-n.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||Ib;while(a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position"))a=a.offsetParent;return a||Ib})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;n.fn[b]=function(e){return J(this,function(b,e,f){var g=Jb(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=ya(k.pixelPosition,function(a,c){return c?(c=xa(a,b),va.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return J(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var Kb=a.jQuery,Lb=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=Lb),b&&a.jQuery===n&&(a.jQuery=Kb),n},typeof b===U&&(a.jQuery=a.$=n),n});
/*! jQuery throttle / debounce - v1.1 - 3/7/2010 [http://benalman.com/projects/jquery-throttle-debounce-plugin/] | (c) 2010 "Cowboy" Ben Alman | Dual licensed under the MIT and GPL licenses. [http://benalman.com/about/license/] */
(function(b,c){var $=b.jQuery||b.Cowboy||(b.Cowboy={}),a;$.throttle=a=function(e,f,j,i){var h,d=0;if(typeof f!=="boolean"){i=j;j=f;f=c}function g(){var o=this,m=+new Date()-d,n=arguments;function l(){d=+new Date();j.apply(o,n)}function k(){h=c}if(i&&!h){l()}h&&clearTimeout(h);if(i===c&&m>e){l()}else{if(f!==true){h=setTimeout(i?k:l,i===c?e-m:e)}}}if($.guid){g.guid=j.guid=j.guid||$.guid++}return g};$.debounce=function(d,e,f){return f===c?a(d,e,false):a(d,f,e!==false)}})(this);
/*! imagesLoaded PACKAGED v3.1.8 | MIT License */
(function(){function e(){}function t(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function n(e){return function(){return this[e].apply(this,arguments)}}var i=e.prototype,r=this,o=r.EventEmitter;i.getListeners=function(e){var t,n,i=this._getEvents();if("object"==typeof e){t={};for(n in i)i.hasOwnProperty(n)&&e.test(n)&&(t[n]=i[n])}else t=i[e]||(i[e]=[]);return t},i.flattenListeners=function(e){var t,n=[];for(t=0;e.length>t;t+=1)n.push(e[t].listener);return n},i.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},i.addListener=function(e,n){var i,r=this.getListenersAsObject(e),o="object"==typeof n;for(i in r)r.hasOwnProperty(i)&&-1===t(r[i],n)&&r[i].push(o?n:{listener:n,once:!1});return this},i.on=n("addListener"),i.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},i.once=n("addOnceListener"),i.defineEvent=function(e){return this.getListeners(e),this},i.defineEvents=function(e){for(var t=0;e.length>t;t+=1)this.defineEvent(e[t]);return this},i.removeListener=function(e,n){var i,r,o=this.getListenersAsObject(e);for(r in o)o.hasOwnProperty(r)&&(i=t(o[r],n),-1!==i&&o[r].splice(i,1));return this},i.off=n("removeListener"),i.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},i.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},i.manipulateListeners=function(e,t,n){var i,r,o=e?this.removeListener:this.addListener,s=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(i=n.length;i--;)o.call(this,t,n[i]);else for(i in t)t.hasOwnProperty(i)&&(r=t[i])&&("function"==typeof r?o.call(this,i,r):s.call(this,i,r));return this},i.removeEvent=function(e){var t,n=typeof e,i=this._getEvents();if("string"===n)delete i[e];else if("object"===n)for(t in i)i.hasOwnProperty(t)&&e.test(t)&&delete i[t];else delete this._events;return this},i.removeAllListeners=n("removeEvent"),i.emitEvent=function(e,t){var n,i,r,o,s=this.getListenersAsObject(e);for(r in s)if(s.hasOwnProperty(r))for(i=s[r].length;i--;)n=s[r][i],n.once===!0&&this.removeListener(e,n.listener),o=n.listener.apply(this,t||[]),o===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},i.trigger=n("emitEvent"),i.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},i.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},i._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},i._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return r.EventEmitter=o,e},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:this.EventEmitter=e}).call(this),function(e){function t(t){var n=e.event;return n.target=n.target||n.srcElement||t,n}var n=document.documentElement,i=function(){};n.addEventListener?i=function(e,t,n){e.addEventListener(t,n,!1)}:n.attachEvent&&(i=function(e,n,i){e[n+i]=i.handleEvent?function(){var n=t(e);i.handleEvent.call(i,n)}:function(){var n=t(e);i.call(e,n)},e.attachEvent("on"+n,e[n+i])});var r=function(){};n.removeEventListener?r=function(e,t,n){e.removeEventListener(t,n,!1)}:n.detachEvent&&(r=function(e,t,n){e.detachEvent("on"+t,e[t+n]);try{delete e[t+n]}catch(i){e[t+n]=void 0}});var o={bind:i,unbind:r};"function"==typeof define&&define.amd?define("eventie/eventie",o):e.eventie=o}(this),function(e,t){"function"==typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(n,i){return t(e,n,i)}):"object"==typeof exports?module.exports=t(e,require("wolfy87-eventemitter"),require("eventie")):e.imagesLoaded=t(e,e.EventEmitter,e.eventie)}(window,function(e,t,n){function i(e,t){for(var n in t)e[n]=t[n];return e}function r(e){return"[object Array]"===d.call(e)}function o(e){var t=[];if(r(e))t=e;else if("number"==typeof e.length)for(var n=0,i=e.length;i>n;n++)t.push(e[n]);else t.push(e);return t}function s(e,t,n){if(!(this instanceof s))return new s(e,t);"string"==typeof e&&(e=document.querySelectorAll(e)),this.elements=o(e),this.options=i({},this.options),"function"==typeof t?n=t:i(this.options,t),n&&this.on("always",n),this.getImages(),a&&(this.jqDeferred=new a.Deferred);var r=this;setTimeout(function(){r.check()})}function f(e){this.img=e}function c(e){this.src=e,v[e]=this}var a=e.jQuery,u=e.console,h=u!==void 0,d=Object.prototype.toString;s.prototype=new t,s.prototype.options={},s.prototype.getImages=function(){this.images=[];for(var e=0,t=this.elements.length;t>e;e++){var n=this.elements[e];"IMG"===n.nodeName&&this.addImage(n);var i=n.nodeType;if(i&&(1===i||9===i||11===i))for(var r=n.querySelectorAll("img"),o=0,s=r.length;s>o;o++){var f=r[o];this.addImage(f)}}},s.prototype.addImage=function(e){var t=new f(e);this.images.push(t)},s.prototype.check=function(){function e(e,r){return t.options.debug&&h&&u.log("confirm",e,r),t.progress(e),n++,n===i&&t.complete(),!0}var t=this,n=0,i=this.images.length;if(this.hasAnyBroken=!1,!i)return this.complete(),void 0;for(var r=0;i>r;r++){var o=this.images[r];o.on("confirm",e),o.check()}},s.prototype.progress=function(e){this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded;var t=this;setTimeout(function(){t.emit("progress",t,e),t.jqDeferred&&t.jqDeferred.notify&&t.jqDeferred.notify(t,e)})},s.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var t=this;setTimeout(function(){if(t.emit(e,t),t.emit("always",t),t.jqDeferred){var n=t.hasAnyBroken?"reject":"resolve";t.jqDeferred[n](t)}})},a&&(a.fn.imagesLoaded=function(e,t){var n=new s(this,e,t);return n.jqDeferred.promise(a(this))}),f.prototype=new t,f.prototype.check=function(){var e=v[this.img.src]||new c(this.img.src);if(e.isConfirmed)return this.confirm(e.isLoaded,"cached was confirmed"),void 0;if(this.img.complete&&void 0!==this.img.naturalWidth)return this.confirm(0!==this.img.naturalWidth,"naturalWidth"),void 0;var t=this;e.on("confirm",function(e,n){return t.confirm(e.isLoaded,n),!0}),e.check()},f.prototype.confirm=function(e,t){this.isLoaded=e,this.emit("confirm",this,t)};var v={};return c.prototype=new t,c.prototype.check=function(){if(!this.isChecked){var e=new Image;n.bind(e,"load",this),n.bind(e,"error",this),e.src=this.src,this.isChecked=!0}},c.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},c.prototype.onload=function(e){this.confirm(!0,"onload"),this.unbindProxyEvents(e)},c.prototype.onerror=function(e){this.confirm(!1,"onerror"),this.unbindProxyEvents(e)},c.prototype.confirm=function(e,t){this.isConfirmed=!0,this.isLoaded=e,this.emit("confirm",this,t)},c.prototype.unbindProxyEvents=function(e){n.unbind(e.target,"load",this),n.unbind(e.target,"error",this)},s});
/*! lz-string-1.3.3-min.js | (c) 2013 Pieroxy | Licensed under a WTFPL license */
var LZString={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(e==null)return"";var t="";var n,r,i,s,o,u,a;var f=0;e=LZString.compress(e);while(f<e.length*2){if(f%2==0){n=e.charCodeAt(f/2)>>8;r=e.charCodeAt(f/2)&255;if(f/2+1<e.length)i=e.charCodeAt(f/2+1)>>8;else i=NaN}else{n=e.charCodeAt((f-1)/2)&255;if((f+1)/2<e.length){r=e.charCodeAt((f+1)/2)>>8;i=e.charCodeAt((f+1)/2)&255}else r=i=NaN}f+=3;s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+LZString._keyStr.charAt(s)+LZString._keyStr.charAt(o)+LZString._keyStr.charAt(u)+LZString._keyStr.charAt(a)}return t},decompressFromBase64:function(e){if(e==null)return"";var t="",n=0,r,i,s,o,u,a,f,l,c=0,h=LZString._f;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(c<e.length){u=LZString._keyStr.indexOf(e.charAt(c++));a=LZString._keyStr.indexOf(e.charAt(c++));f=LZString._keyStr.indexOf(e.charAt(c++));l=LZString._keyStr.indexOf(e.charAt(c++));i=u<<2|a>>4;s=(a&15)<<4|f>>2;o=(f&3)<<6|l;if(n%2==0){r=i<<8;if(f!=64){t+=h(r|s)}if(l!=64){r=o<<8}}else{t=t+h(r|i);if(f!=64){r=s<<8}if(l!=64){t+=h(r|o)}}n+=3}return LZString.decompress(t)},compressToUTF16:function(e){if(e==null)return"";var t="",n,r,i,s=0,o=LZString._f;e=LZString.compress(e);for(n=0;n<e.length;n++){r=e.charCodeAt(n);switch(s++){case 0:t+=o((r>>1)+32);i=(r&1)<<14;break;case 1:t+=o(i+(r>>2)+32);i=(r&3)<<13;break;case 2:t+=o(i+(r>>3)+32);i=(r&7)<<12;break;case 3:t+=o(i+(r>>4)+32);i=(r&15)<<11;break;case 4:t+=o(i+(r>>5)+32);i=(r&31)<<10;break;case 5:t+=o(i+(r>>6)+32);i=(r&63)<<9;break;case 6:t+=o(i+(r>>7)+32);i=(r&127)<<8;break;case 7:t+=o(i+(r>>8)+32);i=(r&255)<<7;break;case 8:t+=o(i+(r>>9)+32);i=(r&511)<<6;break;case 9:t+=o(i+(r>>10)+32);i=(r&1023)<<5;break;case 10:t+=o(i+(r>>11)+32);i=(r&2047)<<4;break;case 11:t+=o(i+(r>>12)+32);i=(r&4095)<<3;break;case 12:t+=o(i+(r>>13)+32);i=(r&8191)<<2;break;case 13:t+=o(i+(r>>14)+32);i=(r&16383)<<1;break;case 14:t+=o(i+(r>>15)+32,(r&32767)+32);s=0;break}}return t+o(i+32)},decompressFromUTF16:function(e){if(e==null)return"";var t="",n,r,i=0,s=0,o=LZString._f;while(s<e.length){r=e.charCodeAt(s)-32;switch(i++){case 0:n=r<<1;break;case 1:t+=o(n|r>>14);n=(r&16383)<<2;break;case 2:t+=o(n|r>>13);n=(r&8191)<<3;break;case 3:t+=o(n|r>>12);n=(r&4095)<<4;break;case 4:t+=o(n|r>>11);n=(r&2047)<<5;break;case 5:t+=o(n|r>>10);n=(r&1023)<<6;break;case 6:t+=o(n|r>>9);n=(r&511)<<7;break;case 7:t+=o(n|r>>8);n=(r&255)<<8;break;case 8:t+=o(n|r>>7);n=(r&127)<<9;break;case 9:t+=o(n|r>>6);n=(r&63)<<10;break;case 10:t+=o(n|r>>5);n=(r&31)<<11;break;case 11:t+=o(n|r>>4);n=(r&15)<<12;break;case 12:t+=o(n|r>>3);n=(r&7)<<13;break;case 13:t+=o(n|r>>2);n=(r&3)<<14;break;case 14:t+=o(n|r>>1);n=(r&1)<<15;break;case 15:t+=o(n|r);i=0;break}s++}return LZString.decompress(t)},compress:function(e){if(e==null)return"";var t,n,r={},i={},s="",o="",u="",a=2,f=3,l=2,c="",h=0,p=0,d,v=LZString._f;for(d=0;d<e.length;d+=1){s=e.charAt(d);if(!Object.prototype.hasOwnProperty.call(r,s)){r[s]=f++;i[s]=true}o=u+s;if(Object.prototype.hasOwnProperty.call(r,o)){u=o}else{if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}r[o]=f++;u=String(s)}}if(u!==""){if(Object.prototype.hasOwnProperty.call(i,u)){if(u.charCodeAt(0)<256){for(t=0;t<l;t++){h=h<<1;if(p==15){p=0;c+=v(h);h=0}else{p++}}n=u.charCodeAt(0);for(t=0;t<8;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}else{n=1;for(t=0;t<l;t++){h=h<<1|n;if(p==15){p=0;c+=v(h);h=0}else{p++}n=0}n=u.charCodeAt(0);for(t=0;t<16;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}delete i[u]}else{n=r[u];for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}}a--;if(a==0){a=Math.pow(2,l);l++}}n=2;for(t=0;t<l;t++){h=h<<1|n&1;if(p==15){p=0;c+=v(h);h=0}else{p++}n=n>>1}while(true){h=h<<1;if(p==15){c+=v(h);break}else p++}return c},decompress:function(e){if(e==null)return"";if(e=="")return null;var t=[],n,r=4,i=4,s=3,o="",u="",a,f,l,c,h,p,d,v=LZString._f,m={string:e,val:e.charCodeAt(0),position:32768,index:1};for(a=0;a<3;a+=1){t[a]=a}l=0;h=Math.pow(2,2);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(n=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}d=v(l);break;case 2:return""}t[3]=d;f=u=d;while(true){if(m.index>m.string.length){return""}l=0;h=Math.pow(2,s);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}switch(d=l){case 0:l=0;h=Math.pow(2,8);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 1:l=0;h=Math.pow(2,16);p=1;while(p!=h){c=m.val&m.position;m.position>>=1;if(m.position==0){m.position=32768;m.val=m.string.charCodeAt(m.index++)}l|=(c>0?1:0)*p;p<<=1}t[i++]=v(l);d=i-1;r--;break;case 2:return u}if(r==0){r=Math.pow(2,s);s++}if(t[d]){o=t[d]}else{if(d===i){o=f+f.charAt(0)}else{return null}}u+=o;t[i++]=f+o.charAt(0);r--;f=o;if(r==0){r=Math.pow(2,s);s++}}}};if(typeof module!=="undefined"&&module!=null){module.exports=LZString}
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
var saveAs=saveAs||navigator.msSaveBlob&&navigator.msSaveBlob.bind(navigator)||function(e){"use strict";var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=e.URL||e.webkitURL||e,i=t.createElementNS("http://www.w3.org/1999/xhtml","a"),s="download"in i,o=function(n){var r=t.createEvent("MouseEvents");r.initMouseEvent("click",true,false,e,0,0,0,0,0,false,false,false,false,0,null);n.dispatchEvent(r)},u=e.webkitRequestFileSystem,a=e.requestFileSystem||u||e.mozRequestFileSystem,f=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},l="application/octet-stream",c=0,h=[],p=function(){var e=h.length;while(e--){var t=h[e];if(typeof t==="string"){r.revokeObjectURL(t)}else{t.remove()}}h.length=0},d=function(e,t,n){t=[].concat(t);var r=t.length;while(r--){var i=e["on"+t[r]];if(typeof i==="function"){try{i.call(e,n||e)}catch(s){f(s)}}}},v=function(t,r){var f=this,p=t.type,v=false,m,g,y=function(){var e=n().createObjectURL(t);h.push(e);return e},b=function(){d(f,"writestart progress write writeend".split(" "))},w=function(){if(v||!m){m=y(t)}if(g){g.location.href=m}else{window.open(m,"_blank")}f.readyState=f.DONE;b()},E=function(e){return function(){if(f.readyState!==f.DONE){return e.apply(this,arguments)}}},S={create:true,exclusive:false},x;f.readyState=f.INIT;if(!r){r="download"}if(s){m=y(t);i.href=m;i.download=r;o(i);f.readyState=f.DONE;b();return}if(e.chrome&&p&&p!==l){x=t.slice||t.webkitSlice;t=x.call(t,0,t.size,l);v=true}if(u&&r!=="download"){r+=".download"}if(p===l||u){g=e}if(!a){w();return}c+=t.size;a(e.TEMPORARY,c,E(function(e){e.root.getDirectory("saved",S,E(function(e){var n=function(){e.getFile(r,S,E(function(e){e.createWriter(E(function(n){n.onwriteend=function(t){g.location.href=e.toURL();h.push(e);f.readyState=f.DONE;d(f,"writeend",t)};n.onerror=function(){var e=n.error;if(e.code!==e.ABORT_ERR){w()}};"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=f["on"+e]});n.write(t);f.abort=function(){n.abort();f.readyState=f.DONE};f.readyState=f.WRITING}),w)}),w)};e.getFile(r,{create:false},E(function(e){e.remove();n()}),E(function(e){if(e.code===e.NOT_FOUND_ERR){n()}else{w()}}))}),w)}),w)},m=v.prototype,g=function(e,t){return new v(e,t)};m.abort=function(){var e=this;e.readyState=e.DONE;d(e,"abort")};m.readyState=m.INIT=0;m.WRITING=1;m.DONE=2;m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null;e.addEventListener("unload",p,false);return g}(self);
/*! seedrandom.js v2.3.3 | (c) 2013 David Bau | Licensed under a BSD-style license */
!function(a,b,c,d,e,f,g,h,i){function j(a){var b,c=a.length,e=this,f=0,g=e.i=e.j=0,h=e.S=[];for(c||(a=[c++]);d>f;)h[f]=f++;for(f=0;d>f;f++)h[f]=h[g=r&g+a[f%c]+(b=h[f])],h[g]=b;(e.g=function(a){for(var b,c=0,f=e.i,g=e.j,h=e.S;a--;)b=h[f=r&f+1],c=c*d+h[r&(h[f]=h[g=r&g+b])+(h[g]=b)];return e.i=f,e.j=g,c})(d)}function k(a,b){var c,d=[],e=typeof a;if(b&&"object"==e)for(c in a)try{d.push(k(a[c],b-1))}catch(f){}return d.length?d:"string"==e?a:a+"\0"}function l(a,b){for(var c,d=a+"",e=0;e<d.length;)b[r&e]=r&(c^=19*b[r&e])+d.charCodeAt(e++);return n(b)}function m(c){try{return a.crypto.getRandomValues(c=new Uint8Array(d)),n(c)}catch(e){return[+new Date,a,(c=a.navigator)&&c.plugins,a.screen,n(b)]}}function n(a){return String.fromCharCode.apply(0,a)}var o=c.pow(d,e),p=c.pow(2,f),q=2*p,r=d-1,s=c["seed"+i]=function(a,f,g){var h=[],r=l(k(f?[a,n(b)]:null==a?m():a,3),h),s=new j(h);return l(n(s.S),b),(g||function(a,b,d){return d?(c[i]=a,b):a})(function(){for(var a=s.g(e),b=o,c=0;p>a;)a=(a+c)*d,b*=d,c=s.g(1);for(;a>=q;)a/=2,b/=2,c>>>=1;return(a+c)/b},r,this==c)};l(c[i](),b),g&&g.exports?g.exports=s:h&&h.amd&&h(function(){return s})}(this,[],Math,256,6,52,"object"==typeof module&&module,"function"==typeof define&&define,"random");
/*! console_hack.js */
!function(){for(var methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],length=methods.length,noop=function(){},console=window.console=window.console||{};length--;){var method=methods[length];console[method]||(console[method]=noop)}}();
/*! User Lib */"USER_LIB";/* END-User Lib */
}
</script>
<style id="style-normalize" type="text/css">/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}</style>
<style id="style-init-screen" type="text/css">#init-screen{display:none;z-index:100000;position:fixed;top:0;left:0;height:100%;width:100%;font-size:28px;text-align:center}#init-screen p{display:none;width:75%;margin:2em auto;font-weight:700;font-style:italic}#init-loading progress{height:20px}html.init-lacking #init-screen,html.init-loading #init-screen,html.init-no-js #init-screen{display:block}html.init-no-js #init-no-js{display:block}html.init-lacking #init-lacking{display:block}html.init-loading #init-loading{display:block}html.init-loading #passages,html.init-loading #ui-bar{display:none}html.init-no-js #init-no-js,noscript{color:red;font-weight:700}</style>
<style id="style-fonts" type="text/css">@font-face{font-family:tme-fa-icons;src:url(data:application/octet-stream;base64,d09GRgABAAAAACWoAA4AAAAAQhQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABRAAAAEQAAABWPihI/2NtYXAAAAGIAAAAOgAAAUrQXRm3Y3Z0IAAAAcQAAAAKAAAACgAAAABmcGdtAAAB0AAABZQAAAtwiJCQWWdhc3AAAAdkAAAACAAAAAgAAAAQZ2x5ZgAAB2wAABjCAAAq+uJ4WNtoZWFkAAAgMAAAADQAAAA2BZlJs2hoZWEAACBkAAAAIAAAACQIJwQZaG10eAAAIIQAAABuAAABOPTeAABsb2NhAAAg9AAAAJ4AAACeojKW6m1heHAAACGUAAAAIAAAACAA6gvwbmFtZQAAIbQAAAGPAAAC/eLsyKlwb3N0AAAjRAAAAfwAAAM0412SIHByZXAAACVAAAAAZQAAAHvdawOFeJxjYGRWYZzAwMrAwVTFtIeBgaEHQjM+YDBkZGJgYGJgZWbACgLSXFMYHF4wvPBhDvqfxRDFHMQwDSjMCJIDANLeC6V4nGNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZgYGF74/P8PUvCCAURLMELVAwEjG8OIBwC4Ywb6AAAAAAAAAAAAAAAAAAB4nK1WaXMTRxCd1WHLNj6CDxI2gVnGcox2VpjLCBDG7EoW4BzylexCjl1Ldu6LT/wG/ZpekVSRb/y0vB4d2GAnVVQoSv2m9+1M9+ueXpPQksReWI+k3HwpprY2aWTnSUg3bFqO4kPZ2QspU0z+LoiCaLXUvu04JCISgap1hSWC2PfI0iTjQ48yWrYlvWpSbulJd9kaD+qt+vbT0FGO3QklNZuhQ+uRLanCqBJFMu2RkjYtw9VfSVrh5yvMfNUMJYLoJJLGm2EMj+Rn44xWGa3GdhxFkU2WG0WKRDM8iCKPslpin1wxQUD5oBlSXvk0onyEH5EVe5TTCnHJdprf9yU/6R3OvyTieouyJQf+QHZkB3unK/ki0toK46adbEehivB0fSfEI5uT6p/sUV7TaOB2RaYnzQiWyleQWPkJZfYPyWrhfMqXPBrVkoOcCFovc2Jf8g60HkdMiWsmyILujk6IoO6XnKHYY/q4+OO9XSwXIQTIOJb1jkq4EEYpYbOaJG0EOYiSskWV1HpHTJzyOi3iLWG/Tu3oS2e0Sag7MZ6th46tnKjkeDSp00ymTu2k5tGUBlFKOhM85tcBlB/RJK+2sZrEyqNpbDNjJJFQoIVzaSqIZSeWNAXRPJrRm7thmmvXokWaPFDPPXpPb26Fmzs9p+3AP2v8Z3UqpoO9MJ2eDshKfJp2uUnRun56hn8m8UPWAiqRLTbDlMVDtn4H5eVjS47CawNs957zK+h99kTIpIH4G/AeL9UpBUyFmFVQC9201rUsy9RqVotUZOq7IU0rX9ZpAk05Dn1jX8Y4/q+ZGUtMCd/vxOnZEZeeufYlyDSH3GZdj+Z1arFdgM5sz+k0y/Z9nebYfqDTPNvzOh1ha+t0lO2HOi2w/UinY2wvaEGT7jsEchGBXMAGEoGwdRAI20sIhK1CIGwXEQjbIgJhu4RA2H6MQNguIxC2l7Wsmn4qaRw7E8sARYgDoznuyGVuKldTyaUSrotGpzbkKXKrpKJ4Vv0rA/3ikTesgbVAukTW/IpJrnxUleOPrmh508S5Ao5Vf3tzXJ8TD2W/WPhT8L/amqqkV6x5ZHIVeSPQk+NE1yYVj67p8rmqR9f/i4oOa4F+A6UQC0VZlg2+mZDwUafTUA1c5RAzGzMP1/W6Zc3P4fybGCEL6H78NxQaC9yDTllJWe1gr9XXj2W5twflsCdYkmK+zOtb4YuMzEr7RWYpez7yecAVMCqVYasNXK3gzXsS85DpTfJMELcVZYOkjceZILGBYx4wb76TICRMXbWB2imcsIG8YMwp2O+EQ1RvlOVwe6F9Ho2Uf2tX7MgZFU0Q+G32Rtjrs1DyW6yBhCe/1NdAVSFNxbipgEsj5YZq8GFcrdtGMk6gr6jYDcuyig8fR9x3So5lIPlIEatHRz+tvUKd1Ln9yihu3zv9CIJBaWL+9r6Z4qCUd7WSZVZtA1O3GpVT15rDxasO3c2j7nvH2Sdy1jTddE/c9L6mVbeDg7lZEO3bHJSlTC6o68MOG6jLzaXQ6mVckt52DzAsMKDfoRUb/1f3cfg8V6oKo+NIvZ2oH6PPYgzyDzh/R/UF6OcxTLmGlOd7lxOfbtzD2TJdxV2sn+LfwKy15mbpGnBD0w2Yh6xaHbrKDXynBjo90tyO9BDwse4K8QBgE8Bi8InuWsbzKYDxfMYcH+Bz5jBoMofBFnMYbDNnDWCHOQx2mcNgjzkMvmDOOsCXzGEQModBxBwGT5gTADxlDoOvmMPga+Yw+IY59wG+ZQ6DmDkMEuYw2Nd0ayhzixd0F6htUBXowPQTFvewONRUGbK/44Vhf28Qs38wiKk/aro9pP7EC0P92SCm/mIQU3/VdGdI/Y0Xhvq7QUz9wyCmPtMvxnKZwV9GvkuFA8ouNp/z98T7B8IaQLYAAQAB//8AD3icrToNcBzVefe9/b3dvd29u909/dyd7ke6k86yLEunOyHJsrCxJWyJGmEcLMDYxBhHNsZQBzOAkjQmFDrGIq5gHEIcCILOAGZq3IQO04RkIGkgaUMKMbQznSlJW0wgJtOQHxRr1e+93TvJwq7JTD3y2/f//bzvfX/vAhAIzL3KPcYNBFIB8UR9EJYuAcuAqGNbOiwDSczkuorlaJ6WTeVSRwMIDveY8aN20GztjzMhW4P2H+kNUPM5NaVNQE0K3tWM77vv8rJqgnT33VJE4WWIfd/QbKHZjcXcZiFAqjCDgUJA/mZTWOIIwi0vAwNiUjkW9THIZs6DAbnj6ffGP/P+0y2vv+5SXGLKuXHJPJH92c+yT7x3883wnI9W/DxI4T9+bm7uOL+MUwNywAg0BJYFQgNKa2NDzFBEjqeM0SFXLHU4YKe7yjFoSmdEKWw5nemOUj5czMXCliilM7lyuFgqp3HaDf1j/fhH+s6cfm4MEpA8c0BSQBO5CUkD5fJi05kDjSUoNnETTUUSXtpPVm0aGHDdmV0nNkPiMUWeHZMVRSZPSlp0dqypCKVG8iT9IK5AEeamyZGAjecW5tm5SSBm8ojiSqBsYoXDTRtuymw13V8axjB+p2EPlsMGcRzTTRkGOLRpmk/AzSZ+A97ecx+QN8g9gUbc26F7N+GJiN5pLGMA8hUo7EQcHI455A0PwrS3I37N+bZhTE8bex1aeeIJ4+MTjTY6gcH+iIvgGWQRdh2TR9sS81kspCzytguLfBcyuBOLXuhwYnZnh8NFUs6plLPLScGpWBKwkYztwsop7Hie9r7rYK/9brWXTg9U+RiBX+GJiyc0rgIv7UNJe3vPjrFdyZOV/byNUkyW/0AuIi/h+h6U5a64SmW5ieGcya2AYimG+EUtnZN08ImgveV+KOYykiiJVMrbkI+dHUkC9+nyPUFdD94j639r1uTq7FiSNrR1hXS8uLbGapYUSbpaJvzmp5aODbU9iJNBU1gJa5LFTCqihNpDigmWWtc2GjUy7Y2m3hHk14qmPJXp2cTInZudO85dhzw2AuXAJQHl+Yt7l0RVjkO8u4q5JZARE2A5yNxStNgGWcQSj7izA1HucCgJOsRsb7xYWgn9XAwvRqaN4HAS4ENF3kXFFovJ/muW3zsYDK3jxaCQbOouOPXZPmBDNZG4krS0N2/9wakf7hHv+IcPX/jcaGWZAp9fvrFtv66UeSlXn4zYdZo5kLNwIJJRTbEu3jz62Zf37Xv5l7RAeugZfAQ7kJ5koA3PoJB1eP8MpHRVWqpygyITpiKz4DCoHMENlun+wrDA0bNZ9jmJZdZwhhx9UnewMKztg2yAlie9j6O7Lzrks7tYdRdOO4u/FJ9e5G93RyFTJ1f5G17IZDs7z25uEfuFBYwlvYpUUuTnKJO6umg5IymD88yGGxbycjN2JOkIVk6wUoEzm/0O5T/Owb92Jg8NyL/6qFrl30IZ5nSgMp3nch7DkvOMCaMeoQ1U4JZxQncenmAMmcAei/S7V9CvAccW8mczwtMCceSQ8nwhXWuKAeQPJbRCc9RnhoSyhvBL+WgxTzsk0Y567IFj+35wa4Xq7ykS5YIm7UIdq4iCfKcsiIoSvFFWONUnFovZoXHKhXE69R9hTOIEgZPcJ0VZRrx+i3j9hhtFPqQDnYjX8uaEpS2+F4twiVkOylSJAwfvBZO3XBnoTaEHtltSWAGKIEl3SJIQ1CRESIRnLFtJRc88GckEbQuOBTO5zBXziL0JIPKiyMtzggwiMc+czmbDEbDMbJaLhC3LPzPuFOKaD6zEM+tt15gNxTPLIg5dvglCfGmbmakYmqmKsEfRVOWWAXjqvEzVeamT6botq9321Vu2rIb7KOrufmZ24LWmoiI3yspJJ65e704JprBSFGH3pxXLhAQe9fBzbM1rq7YAm1dsctvZSiqu8G94rxwS/LQ7JYorRR0XXq/GmSh4dJADKAsSk70ajQ8gHdE0MhzVjOCbVDSvKINd1PhKVN+fgMTG2zYCvIaq+V2mmsNTP36IRLD6xO7ejWTDisfc7zCVD6tQW+/eMTW1Y3fSt20foe+hBZpQ3zfGfH3vyzmCZNvHFoJFVPrRjj7m6I26M3r7KHQxgD5c2H/4tQdIeJLJ+yQDvTsZOwv4jYfJQxVaxxmtKtNTTVaQnRmS6kkWvfBoNvCeIT55jt41PJZwpg3YYeJYGK+dppgK/sF+R/8ggZIOBlnyNoK/qpwokLZ6uCFRKCTKV8HeGaYksPg2Xj/3fyQZb6dhGWv2QLLQU4DW7lZwf77Hw+vb3AjzexKIVywkEXoGlB1JUqr4FW3A7BZlDzgzhZ5W0tyfI1da7mmn13JvsZOFxLuJIRsmLXJVskByA41iu/uvSds9bWOnPZQ4lSgANm+xqQ6gMPlGH2YR79rSDIXLXQBujHZSxkCpSIeynwCdNxEFJ2HVmSDaFPxQYoIN2BfCM8E6zTCu66VDSQ97KkPfIa8i7nGUITNAZagDhYFJjeg5rXh+bcBuYamT/JWmRVE8Iopeb/3ud1ZdSIs4TkQLcaogJ63Z5dGUxEfefz8qSKko+Qm2PB/ZgyEEMngmjkjovYB0GBog+n9COzD7MiQ73pfOA5S8NLseIst+QWbPC9y/J8dRv7QFliCNWcnzAYlI3fE8hdNVbBPY1WEeZxm8m5mKOdypQRG1qhiRgQBnZbr7N20qT1ipoPsLVYWEGq8hE3BoLPn2tV8PhWVe0WTB4nIN3WMD7cmIiDZEhaSSROulWMbk2+sX4LIs0Iq4NNdUfV3mDeqCbaEOligmbYSFCaU0VRVULrhTKoKlIMubNvV3ZyyOByWMilXkBpNjcIjihTjBrwzF/bmKF1iMJNsHxrobcnxElDVF0C3u69fevP5txIsEcUrVZyR96DPqiI/C+zGTp0uZGkXVP6PG1RncET7Ey/eKjnX885QeWw83krsCIVyvMp8TD9P3rEvMFUkFZxS6Rw25ytWQJ/52/tqLyQSDrc7Dpiq/H2XDgYsVBgjnK7BF95EwLKLNKLh0bg5x74VXPNwJO1fq7raB588j7pbhat78pDKjPE1td1Jl6Hhn8Q73LdISsCrrgwuijljQ28Tinnavx+Xu9ap6jYqn2QzNaly7RoVJ99MoBl/DvmtU1X0Lu3FCnO37XXKEW832Nai8BYnDKKvIF92W3F9dotK94ahCNyJPuW+5b2L1WrQ2X6fSc1TBejLg77uvsm8FX2b1ghWk6cbjuB1FUIVm9y0f6aMKfMbdhjshNGihFKgIgE7044ZvkbXz+zbh3chXN/f35Z6mOyF2b/m7H6V7HVV3XYOYtiDOig/J25bh+xPuAPMdxRPRc8V1YU8Z2mEv9OIO2O6DTg8Wtt2C3+lCcjBRmEaNVbDhi0nLnUK1ttvqdVpsexruQ93WGnf3T9s47N+te7nN5FeohRGeChUfIvZx5htAPYTNjQl/ea/tTlkW7LZ7nIK3dyNsGUwWpq0+a4k/ALvozB5nurkCqwthUdrq5mnzBD/tu5rpfPVYuC6L0VZwnMfd/YnGxgTc97jjFNjGFvRQ6iyrYPfZjyPVyQJM233YRF5YVb1xgLzjwVMX3NOwZ/K7wtJZx4W8pGRNNzf4ZOBeCKgPCxuKcUYmxQNycbjP5wGlEJGk8OZc369tR3gtaZ+X6CbmVkIONRVJcugpluk1TQL1Fqmfy1ELVi4hYy1zJhYNj4zu7RkfbuebN17fv+q2Fj4sDgtE7Hv2uk89uneIH7j9yNWjR1YMmUvJSzO6s9QcGWkbHt83PtzW0yWCMMLr4roNcMm+o88e3XdJ/0VDkWiFDxSv5YhXq8d3nVAryjjtoDXp7Ojn2gg6ijGHIUxDpQZ0Y2lQym2+5NZHN219to8XhsUw33Lb6p6dG9DVGN598/bmkXA0NoPeR2t4qO/h0U8d3bcKtmB5yeilos6PCCB29fgINjeNmEsdfaYmGhm6qB9RrPhEx7mrEbfGwCDauZXNJo09wLJ1oAhSe1NxWkUDKKJofMqeE+szt8S4K9JYmjbLXRRtylOU1vWN//mVy4/0DVGNqM9QJT7SvL287ot5MSZoGC/oyHTWO7p3vdd5s6RB439/5fKH6aIaEDh46AVkpMqWo1YdaWpe1690hzT4e79jxGuLvD+R0iUwuiJ+TLUM4+yrA8aAdsVAsX1JFgMsTkCF4ceBdtgLZ8oXaENnPpfPipLA6A57nn4+XI1hUbCoYmig1KP5pH44Kybnq4cUyatKivvTmXpeOC7y8J4il3yHncWVz+SDrc5zTqucPyYro3Af7XP30/I8ddJxsQAgXIFbz37QdsmqNhJl0K6145C0rkWzExAX8aM3sDpwYyA8oF83PNBXWu7xRPQMIT1E6syw7M4F2tFwOmyhVKQ7+uH/lz9DribLBF4jsuze94lYBc+7LzLOXMw4c+66u52EZz/QLEWxyA0XZFuA9+OVUfSTwyzWCw0o3a0Jx9BYTrKp2AZiEi9qGSs6OFhZkPboRDXesZKpbcd3UOjV8dMgNNQhr1pJh0Qy5petVIQ48Zq1KefMj7zIhluf3pQeBs5JfUuJMGcgHFRik16gP1mzHX2EmroaYhmVysETLOo54aSGU/gHzbEwdRvCMXuGhUczHj3HkZ42Rk9LYIDS07c8YRuqSBg91Pmnwo8VghFR2Y9oKTmxziSwi0HTN2I1cMvT3E7Fezk/Pae1UnYyUwqdRnqCNZPoXSJSk6hxGWmRBKqBSMqyTP97/wmaJcQCGpqbG5Iw6vhEtHpEVWihepULpFG3rqG0rOha2qTxJIC0YOSYFjrxEtP8nlSlIxvu7PLcRKmS76mk04Sq0HoTqJ04CcfcK+DDIU34mhCX/dByaAiDy58ibicVeRdNJrNyezI2G/ESlUKsZDxiOtLJk/ChXCc9Imp+1nO2xL6QZIkkWiizM7SHIF9q9K8ZpQDx8zOjgWaMzORvdrSGPJ2sEzRYZer9O2gmWD4zSTr6sSuH8Uc/IGjmyLIMOHUV0G48840967ixy2v6zIhcU+pr3bDj9u0bc1xfqUbO9sUuH3O/iqEbFPqaPbOBZuFTO57rx7mxvnDL7avRFLah/ei55LZCpKddjqz4OxhyH6YRLuzA0rcfY5yC8rQTcb08JdLYleZW8TZ0lGgSCyVfQoQtRDiPV6BqKLryzL7kqRmkuoGdE5UzlKWy39mJQlU1OChf1KrEHOYcsdMhvaO3j5JN+zZBXJZ2Kmq0WRSMDSFJGqmtC0q8eZesmfWxPxNNca3DC3KzYsg7MBBXhJ2yHmvy5sojNXVBmQvfhUdoxJ0NgiENWTzfqwd3SOjC927ceNvGjbfTUTNp13eIumhvAKEvJA/HTUW6Maj1CeJAUtBFrcOI1xugSWxubV1qqaRJ1gZvqiHLbKqwOo5TR9hELw7/iBsjL/t6WXl+SWN9VOO5RfnTtJcwreTFY35bWthGB+bMB+yOcGEDg4bztxbkUR0wh1h2kJWgV0awMR+Hjvn5mlrmu9BMCMpYsZynmQC8KR2xco4maZIg5jN5CU86ViJ/s27nzqlxgFc6167fuXP92s5XYOdDO8j4pYNYw16IjR8eH79U0ra3Y6V9uyat20l2P7AbsKpjJ81Tzs39nt9PXgqYeL9LNB+Yi9uMN1BEZ0knnvijDiZLEDg6dJ30NuA9oQEVh9U0uk/kgO8A+R94pvWy8YveWn0ZWbfmLepJXdqz5Z5B94qhu7d2k75r7l0Lx2gVtvTMr6FXgDY7p56d6qSNS+/e0ke6r//CQ1/YXiTdW++u+FK/529HfC3klvzNhK3Te4txIUFlkuQ8tIjguXrUG6WAPWgMsIcDF664d3v3DHXwhQ07YMul2I9QDvtQXz+bokoej3uUo5mt1Qi7f/m58pGoIAyavsnnFiUl8cbhKTpRmI+CKw9Y1oKc5GvZZJCT6kWJcCHNzzDS3KTQKEocr/6Fe1GoUf+1rq/QG/W/hs9goz8E649Xc5M6HxXjAnDV9OT9spBFuwOC26Prv2bzQ3RhCHfwaYpW8+LxqOzlYOZR7/Kf/RbmXMktCzAr3jWP/Kqt5KUqZDq4uTqyBbYGfL17HcuL19KcjykyePSoAP2bNgILH1qOXXFwA9l471P3bOIvOwRXL8j+k0OjB6cPjrLCfe2sXP/824QcsAMZlOmGWiMo0rwb4K1qo+mH/LkBVlXdA+cFXFFWvz0//AXvbZ6+ac3GoyzHHvXfzCqvNILfLi9qV7KBJ/03OPbql/A+XlcDa3g9C1/rnPPU/XzkR4E3q/4p6kHES6V3vVx1M7x3EG4RnpwfhuT9B8mTF4BG6w/vZp7SbtoL4oJBkCuYe2+LL3GT6CtdzGKjNas6FGaHETyqOIeljCSdy4azYTwkLxFIL08OHSKaM+7sonl9vERpGguhHaS5bUgz24xu3ETTPsVKqntkIZfpqR1MdBfQKd6hmiFHviU1QZ260MQ2FSOcbfDmVoyFeHkb9rq/db9KFWsP6uutqz6LgZW6R+JrIjp86Gp6jSXL+7RoUv38yjEracH0NiVpKdu2ISBl27QDRdTKAT9WHoc/IL/p7w4sptcdmtpFR6IcZRnNXDnaT909x7Ykjj6PwmlFdP9FMuWgQvb8nAiKpHB7iS4/r+pk678LRCWOGpq9QwfOlOGlbpDkEPwThngKL7puibAY5LvMl+ZQQ8Yx4mxF/wZjkGJ7a3NjKl5jyjiJ/hAhLzVVExN+9qMpZsAyWImhu/eF2NlfcmS6bxq6lNlO9CZvxpjon/G7R5k1SqVwuFwOv3HTTZn0TTelSQs2wtjpPkNH8D/RH++b3mkosx0KLkzSlfi92qSrzPKX2arMTe692ChjJ7T5I75t3I487EIe5jXKQ6pg6Q83qs/lEn3noSFynmb4aOrBF9sEoBuHhKFYcL11up41emofLCQGE60wVdeDClSvn5qqM41Go7t+iuWUHqzrNrOGWTsFst5TtwLXXPk0Syc9fSX2rsBFmzadY6C/Fge8d+e5uXHkfyiQRc6vwTu2Ylkhz95Fq2/8+YVv/CxSqb7xxyqhDjDBRxFBxcQnSYzeBfrYNqGJjej4TLDfWEywII42hqZ+/BB/6I2DkCn0WS9uv3PD4Z0DpG/3oemDe7u5NS/aMOWtol60t2qCusYTSi19uHn1iHiQOpz2i2v6xx/4xqE9PfyqHQ+N3Ln9RftsmoxADcYAyvMt9Y73lr7wdwTUmb8g/u53GOaw6pPizJC9MJrEj7noG9sG1CNhmWN2BcF2dpRzGBfz5XrojEWZRxuj6aCYY0tiLJOTMmK2uJJQjxj/8hjKEB1iGHCj4JTpxczQzEtehAevG+5pUO12twtCjfG4I979yJB4a7RlZbDdVGV1OMgDQPZQY+ERm1wqiVyYJwJHMrGaP+o9YKbUlE2ApL6YEiyylNT9ESff74qtvCgqNSZcBVOa+2Hr9q9E70rVikGTcxRJ4BSQa6ImzpQIEXk+OFbqhvQRQ4souDWotqAiL2Xqm+AZ/Yz0kXcCOnvfqg1779vzOXtqtvPMii9Ig5+dwj87Kf4bQ6EJfdRt4PyQZYFY0/NXERbE5vPzi+As2njhToFqfp7h6ufXYTFiZ6MCryyG/xQX5qIBFddLfr6b+SYsHc3P1ocikRD5rxCMuNslxeBKuiZjzQpUY6kFvwNgPtyioHRxkEr9fv+HE5AwHFc9q0neOXOa/kiAi9ByQX3et1fZb2+q7yCL914QN5y1GVt/DOVaR29JPCECXV9iGaI84A7sQ9W3Y4dLZe4vVR1Mxd3Hc7rq7lNVOKjqHM9xqmiceVWXNTgoiO6fswpN0R/EfnefyHtnMvcsdw1nzMOJiSzGpQ+SPmclxmVRqlVM0HG5wNFSQYAIRhjE3ZDTsobwJbifVegTxj7sx7mCRwvp5XSWh6/QYs/TwjyMahKsVCYZVaeECMTR56MplPyzCfrSPO/dL0m8RwvpQ1oS56aF7i/58Mpn0eOHaKxcTNGd84cLd4oCvXPu3B+4a8kPUA7rmSzJ7E3Zy7OzuJEm/Mt+7Eh/pyDPMx7xF7luuh/CY9hDe4WZYLqvW+YhFlJiWX1PO0aOB6L0t3AVOUK7V/XSqP8Dx/CavHCY8erwC3jhyKHZR2nu9wXvpz4vKN4dwOIA22sZ/S1RTbhyBxbvF/XeXzEQpfEUTa0hLTTE+RigN9vzQhBp0RzT5OUaKazwlhEU8u0fx8D9XmGdwVmmZmpavDGuichhJJUz1nn5pp9yj5H3GG7DgZtovmnn5YNFiiT/JyIZqw6Uvd+i0TRIFwumFw7SVEg/TYvQDM/8hE9O4uTWEVlECuyU2tLW1oKK3jIk+bItDxy6TZKw36mttdZgKDxo1fIRzrFMSbrt0J/Cl8KVh1OcozuqGUyO7RxLBk3UrA6XfmDTF97qwAErpOl655GnjnTqOidyIQsHO08G/hcLt/j/AAB4nGNgZGBgAOLaW41M8fw2Xxm4mV8ARRguss1QhNC5H/9//Z/FUsEcBORyMDCBRAFTFwxveJxjYGRgYA76n8UQxVLGwPD/FUsFA1AEBfgBAHyYBUh4nGN+wcDAvACCWfSBNIgviMBM1kA6koGBMRWVBqsDYqYmiF4wHQkxg+kUBMPVWEP0gTDYvBdoahZAzYxEY0ciuWUBFjkoZimDYLC8IKpehmsQccYvSGYgYZB7YBhFL5o8cxTQjDUI/wIArpclrwAAAAAAAAA6AIYA3AEKAUgBgAGgAfoCYgKqAwIDOgOGA9wEQAR4BLYFAgU8BZoFzAYMBlIGmga6BtgG+AcYB0QHcAecB8gIAAg2CG4IpgjyCUAJrAo0CtALOAueDAoMYA0ADVANjg3mDiQOjg7GDvgPOA+ED84QPBB2EN4RNhGgEfISchKoEsgS6BMGEz4TXhOSE8QT+BQsFGIUiBTWFX0AAAABAAAATgBuAAYAAAAAAAIAAAAQAHMAAAAiC3AAAAAAeJx1kctOGzEUhn9DoIKgLloJdcdZIRDK5CKhSqyoogJrhLJDwgyeSzpjRx4HlGfgLcoz8Dp9j+76Z2KhqFJmZM93Ph/bxx4AX/AHCqvnnG3FCgeMVryFT/gReZv+JnKHfBd5B108RN6l/xV5H2d4idzFV/zmCqqzx2iK98gK39RR5C18Vt8jb9P/jNwh30fewaGaR96lf428j4l6i9zFsfo7drOFL/MiyMn4VEaD4bk8LsRRlVZXouehcL6RS8mcDaaqXJK6OtSml+lemTrb3Jp8Xmm/rtZ5YnxTOivDZLCur401XgfztNytec5HIWSSeVfLVdxHZt5NTRqSIoTZRb+/vj/GcJhhAY8SOQoECE5oT/kdYYAhf4zgkRnCzFVWCQuNikZjzhlFO9IwvmTLGFlaw4yKnCBlX9PUdD2Oa/Zlay1n3dLmXKei9xuzNvkJ7XLvso2F9SaselP2Na1tZ+i2wqePszV4ZhUj2sBZy1P4tmrB1X/nEd7XcmxKk9In7a0F2gv0+W44/z/KQo7lAHicbZLnlpswEIW5Bgy4bLLpvfeE9N57z76DLARWEJKOEEucpw8CO/kTncOdT6PhnlHxRt4wJt7/x47nYQQfAUKMESFGggmmmGGOLezBXmxjH/bjAA7iEA7jCI7iGI7jBE7iFE7jDM7iHM7jAi7iEi7jCq7iGq7jBlLcxC3cxh3cxT3cxwM8xCM8xhM8xTM8xwu8xCu8xhu8xTu8xwd8xCd8xhd8xTd8xw/sBLUlZuIkZZW2q0hzahvDRqocUyIpE4EWTR1WXDZ1sGRCz5yklBsqWBZwmauZk01mTqxl0nIlUyLs9r/Zej35m4kFl2XKftlAKFomTlKlmfQ1l74lRdB9dbxQqqyIKbc2MPQZGqbFKsqVaYnJ4ky1Ms24iQXLrYPE8GLZ07jRfaIvcf5JX+NoMhQ5jLoqFwenBS8Gpw7WTh05py6MaOtT2ibEGNXWKW1Da0i9nPY6dNe7CEWy7pc+5EJpvfJVnvtUFUHFZBPWS2LYxKqiECztVpINypAuGS2nvQ6Gs+H0hsk0U3ZznDETguua1/MNpLvMWH/RFGEuuobCihScxqS2zPC6jH4rVaVcxn1UjQ1yJW1QK2MTJ6nrPOqp0d3Vk1WoSVOz7p0oHeWdTbpoh5i3sVWpezp23AGTWch+Mmonu0o0Vb+l6RqdabLmRnveH9ru7j54nGPw3sFwIihiIyNjX+QGxp0cDBwMyQUbGVidNjIwaEFoDhR6JwMDAycyi5nBZaMKY0dgxAaHjoiNzCkuG9VAvF0cDQyMLA4dySERICWRQLCRgUdrB+P/1g0svRuZGFwAB9MiuAAAAA==)format('woff')}</style>
<style id="style-core" type="text/css">body{font:16px/1 Helmet,Freesans,sans-serif}#store-area,tw-storydata{display:none!important;z-index:0}#story{z-index:10;margin:2.5em;-webkit-transition:margin-left 200ms ease-in;-moz-transition:margin-left 200ms ease-in;transition:margin-left 200ms ease-in}@media screen and (max-width:1136px){#story{margin-right:1.5em}}#passages{max-width:54em;margin:0 auto}.no-transition{-webkit-transition:none!important;-moz-transition:none!important;transition:none!important}body{color:#eee;background-color:#111}:focus{outline:thin dotted}a{cursor:pointer;color:#68d;text-decoration:none;-webkit-transition-duration:200ms;-moz-transition-duration:200ms;transition-duration:200ms}a:hover{color:#8af;text-decoration:underline}a.link-broken{color:#c22}a.link-broken:hover{color:#e44}span.link-disabled{color:#aaa}area{cursor:pointer}button{cursor:pointer;color:#eee;background-color:#35a;border:1px solid #57c;line-height:normal;padding:.4em;-webkit-transition-duration:200ms;-moz-transition-duration:200ms;transition-duration:200ms;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}button:hover{background-color:#57c;border-color:#79e}button:disabled{cursor:not-allowed;background-color:#444;border:1px solid #666}input,select,textarea{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}select{padding:.34em .4em}input[type=text],textarea{min-width:20em}input[type=checkbox],input[type=file],input[type=radio],select{cursor:pointer}input:focus,input:hover,select:focus,select:hover,textarea:focus,textarea:hover{background-color:#333;border-color:#eee}hr{display:block;height:1px;border:none;border-top:1px solid #eee;margin:1em 0;padding:0}textarea{resize:vertical}audio,canvas,progress,video{max-width:100%}.error{padding:.4em;background-color:#511;border-left:.5em solid #c22}.error[title]{cursor:help}.highlight,.marked{color:#ff0;font-weight:700;font-style:italic}.nobr{white-space:nowrap}#story a.link-external:after,.error:before,[data-icon-after]:after,[data-icon-before]:before,[data-icon]:before{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}[data-icon]:before{content:attr(data-icon)}[data-icon-before]:before{content:attr(data-icon-before)"\00a0"}[data-icon-after]:after{content:"\00a0" attr(data-icon-after)}.error:before{content:"\00a0\e80d\00a0\00a0"}#story a.link-external:after{content:"\00a0\e80e"}.passage{line-height:1.75;text-align:left;-webkit-transition:opacity 400ms ease-in;-moz-transition:opacity 400ms ease-in;transition:opacity 400ms ease-in}.passage-in{opacity:0}.passage ol,.passage ul{margin-left:.5em;padding-left:1.5em}.passage table{margin:1em 0;border-collapse:collapse;font-size:100%}.passage caption,.passage td,.passage th,.passage tr{padding:3px}.passage .error{white-space:nowrap}</style>
<style id="style-ui-bar" type="text/css">#story{margin-left:20em}#ui-bar.stowed~#story{/*margin-left:4.5em*/}@media screen and (max-width:1136px){#story{margin-left:19em}#ui-bar.stowed~#story{/*margin-left:3.5em}*/}@media screen and (max-width:768px){#story{margin-left:3.5em}}#ui-bar{position:fixed;z-index:50;top:0;left:0;width:17.5em;height:100%;margin:0;padding:0;-webkit-transition:left 200ms ease-in;-moz-transition:left 200ms ease-in;transition:left 200ms ease-in}#ui-bar.stowed{left:-15.5em}#ui-bar-body{height:90%;height:calc(100% - 2.5em);margin:2.5em 0;padding:0 1.5em}#ui-bar.stowed #ui-bar-body,#ui-bar.stowed #ui-bar-history{visibility:hidden;-webkit-transition:visibility 200ms step-end;-moz-transition:visibility 200ms step-end;transition:visibility 200ms step-end}#ui-bar{background-color:#222;border-right:1px solid #444;text-align:center}#ui-bar-tray{position:absolute;top:.2em;left:0;right:0}#ui-bar-body{overflow:auto}#ui-bar a{text-decoration:none}#ui-bar hr{border-color:#444}#ui-bar-history [id|=history],#ui-bar-toggle{font-size:1.2em;line-height:inherit;color:#eee;background-color:transparent;border:1px solid #444}#ui-bar-toggle{display:block;position:absolute;top:0;right:0;border-right:none;padding:.3em .45em .25em}#ui-bar.stowed #ui-bar-toggle{padding:.3em .35em .25em .55em}#ui-bar-toggle:hover{background-color:#444;border-color:#eee}#ui-bar-history{margin:0 auto}#ui-bar-history [id|=history]{padding:.2em .45em .35em}#ui-bar-history #history-jumpto{padding:.2em .665em .35em}#ui-bar-history [id|=history]:not(:first-child){margin-left:1.2em}#ui-bar-history [id|=history]:hover{background-color:#444;border-color:#eee}#ui-bar-history [id|=history]:disabled{color:#444;background-color:transparent;border-color:#444}#ui-bar-body{line-height:1.5}#ui-bar-body>:not(:first-child){margin-top:2em}#story-title{margin:0;font-size:162.5%}#story-author{margin-top:2em;font-weight:700}#menu ul{margin:0;padding:0;list-style:none;border:1px solid #444}#menu ul{margin-top:1em}#menu li{margin:0}#menu li:not(:first-child){border-top:1px solid #444}#menu li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-transform:uppercase}#menu li a:hover{background-color:#444;border-color:#eee}#menu a,#ui-bar-history [id|=history],#ui-bar-toggle{-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}#menu-item-restart a:before,#menu-item-saves a:before,#menu-item-settings a:before,#menu-item-share a:before,#ui-bar-history [id|=history],#ui-bar-toggle:before{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}#ui-bar-toggle:before{content:"\e81d"}#ui-bar.stowed #ui-bar-toggle:before{content:"\e81e"}#menu-item-saves a:before{content:"\e82b\00a0"}#menu-item-settings a:before{content:"\e82d\00a0"}#menu-item-restart a:before{content:"\e82c\00a0"}#menu-item-share a:before{content:"\e82f\00a0"}</style>
<style id="style-ui-dialog" type="text/css">html.ui-dialog-open body{overflow:hidden}#ui-overlay.open{visibility:visible;-webkit-transition:opacity 200ms ease-in;-moz-transition:opacity 200ms ease-in;transition:opacity 200ms ease-in}#ui-overlay:not(.open){-webkit-transition:visibility 200ms step-end,opacity 200ms ease-in;-moz-transition:visibility 200ms step-end,opacity 200ms ease-in;transition:visibility 200ms step-end,opacity 200ms ease-in}#ui-overlay{visibility:hidden;opacity:0;z-index:1000;position:fixed;top:0;left:0;height:100%;width:100%}#ui-dialog.open{display:block;-webkit-transition:opacity 200ms ease-in;-moz-transition:opacity 200ms ease-in;transition:opacity 200ms ease-in}#ui-dialog{display:none;opacity:0;z-index:1100;position:fixed;top:50px;margin:0;padding:0}#ui-dialog-titlebar{position:relative}#ui-dialog-close{display:block;position:absolute;right:0;top:0;white-space:nowrap}#ui-dialog-body{overflow:auto;min-width:280px;height:90%;height:calc(100% - 2.1em - 34px)}#ui-dialog-body.settings [id|=setting-body]{display:table;width:100%}#ui-dialog-body.settings [id|=setting-label]{display:table-cell;padding:.4em 2em .4em 0}#ui-dialog-body.settings [id|=setting-label]+div{display:table-cell;min-width:8em;text-align:right;vertical-align:middle;white-space:nowrap}#ui-overlay{background-color:#000}#ui-overlay.open{opacity:.8}#ui-dialog{max-width:66em}#ui-dialog.open{opacity:1}#ui-dialog-titlebar{background-color:#444;min-height:24px}#ui-dialog-title{margin:0;padding:.2em 3.5em .2em .5em;font-size:1.5em;text-align:center;text-transform:uppercase}#ui-dialog-close{cursor:pointer;font-size:120%;margin:0;padding:0;width:3.6em;height:92%;background-color:transparent;border:1px solid transparent;-webkit-transition-duration:200ms;-moz-transition-duration:200ms;transition-duration:200ms}#ui-dialog-close:hover{background-color:#b44;border-color:#d66}#ui-dialog-body{background-color:#111;border:1px solid #444;text-align:left;line-height:1.5;padding:1em}#ui-dialog-body>:first-child{margin-top:0}#ui-dialog-body hr{background-color:#444}#ui-dialog-body ul.buttons{margin:0;padding:0;list-style:none}#ui-dialog-body ul.buttons li{display:inline-block;margin:0;padding:.4em .4em 0 0}#ui-dialog-body ul.buttons>li+li>button{margin-left:1em}#ui-dialog-body.list{padding:0;min-width:140px}#ui-dialog-body.list ul{margin:0;padding:0;list-style:none;border:1px solid transparent}#ui-dialog-body.list li{margin:0}#ui-dialog-body.list li:not(:first-child){border-top:1px solid #444}#ui-dialog-body.list li a{display:block;padding:.25em .75em;border:1px solid transparent;color:#eee;text-decoration:none}#ui-dialog-body.list li a:hover{background-color:#333;border-color:#eee}#ui-dialog-body.saves{padding:0 0 1px}#ui-dialog-body.saves>:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves table{border-spacing:0;min-width:340px;width:100%}#ui-dialog-body.saves tr:not(:first-child){border-top:1px solid #444}#ui-dialog-body.saves td{padding:.33em .33em}#ui-dialog-body.saves td:first-child{min-width:1.5em;text-align:center}#ui-dialog-body.saves td:nth-child(3){line-height:1.2}#ui-dialog-body.saves td:last-child{text-align:right}#ui-dialog-body.saves .empty{color:#999}#ui-dialog-body.saves .datestamp{font-size:75%}#ui-dialog-body.saves ul.buttons li{padding:.4em}#ui-dialog-body.saves ul.buttons li:last-child{float:right}#ui-dialog-body.settings div[id|=setting-body]+div[id|=setting-body]{margin:.5em 0}#ui-dialog-body.settings [id|=setting-control]{white-space:nowrap}#ui-dialog-body.settings button[id|=setting-control]{color:#eee;background-color:transparent;border:1px solid #444;padding:.4em}#ui-dialog-body.settings button[id|=setting-control]:hover{background-color:#333;border-color:#eee}#ui-dialog-body.settings button[id|=setting-control].enabled{background-color:#282;border-color:#4a4}#ui-dialog-body.settings button[id|=setting-control].enabled:hover{background-color:#4a4;border-color:#6c6}#ui-dialog-body.share{min-width:140px}#ui-dialog-body.list a,#ui-dialog-body.settings span[id|=setting-input],#ui-dialog-close{-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}#ui-dialog-body.saves button[id=saves-export]:before,#ui-dialog-body.saves button[id=saves-import]:before,#ui-dialog-body.saves button[id=saves-clear]:before,#ui-dialog-body.settings button[id|=setting-control].enabled:after,#ui-dialog-body.settings button[id|=setting-control]:after,#ui-dialog-close{font-family:tme-fa-icons;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;speak:none}#ui-dialog-body.saves button[id=saves-export]:before{content:"\e829\00a0"}#ui-dialog-body.saves button[id=saves-import]:before{content:"\e82a\00a0"}#ui-dialog-body.saves button[id=saves-clear]:before{content:"\e827\00a0"}#ui-dialog-body.settings button[id|=setting-control]:after{content:"\00a0\00a0\e830"}#ui-dialog-body.settings button[id|=setting-control].enabled:after{content:"\00a0\00a0\e831"}</style>
</head>
<body>
	<div id="init-screen">
		<p id="init-no-js"><noscript>Apologies! JavaScript is required. Please enable it to continue.</noscript></p>
		<p id="init-lacking">Apologies! You are using an <strong>outdated</strong> browser which lacks required capabilities. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
		<p id="init-loading">Initializing. Please wait&hellip;<br /><progress></progress></p>
	</div>
	<div id="store-area" data-size="213" hidden><div tiddler="StoryTitle" tags="" created="201602092239" modifier="twee" twine-position="0,0">Наливайя</div><div tiddler="StoryAuthor" tags="" created="201602092239" modifier="twee" twine-position="0,0">[[Вячеслав Добранов|http://cheshire.ifiction.ru/]]</div><div tiddler="StoryInit" tags="" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;BarInit&quot;&gt;&gt;\n&lt;&lt;set $historyArr = []&gt;&gt;\n&lt;&lt;set $drunkness = 60&gt;&gt;\n&lt;&lt;set $hour = 23&gt;&gt;\n&lt;&lt;set $minute = 55&gt;&gt;\n&lt;&lt;set $outcome = 0&gt;&gt;\n/%&lt;&lt;set $AllGodsNames = [&quot;Бесстрашный экспериментатор&quot;, &quot;Гениальный комик&quot;, &quot;Ловкий акробат&quot;, &quot;Танцор от бога&quot;, &quot;Непобедимый герой&quot;, &quot;Одарённый певец&quot;, &quot;Душа вечеринки&quot;, &quot;Король мира&quot;, &quot;Император вселенной&quot;, &quot;Мертвец&quot;]&gt;&gt;%/\n&lt;&lt;set $AllGodsNames = [&quot;Бесстрашный экспериментатор&quot;, &quot;Непобедимый герой&quot;, &quot;Одарённый певец&quot;, &quot;Душа вечеринки&quot;, &quot;Король мира&quot;, &quot;Император вселенной&quot;, &quot;Мертвец&quot;, &quot;Мертвец&quot;]&gt;&gt;\n&lt;&lt;set $tableBasicRecipe = &quot;[[Текила с лаймом и солью|Explanations][$recipe = 'BasicRecipe']]&quot;&gt;&gt;\n&lt;&lt;set $tableDepthCharge = &quot;[[Глубинная бомба|Explanations][$recipe = 'DepthCharge']]&quot;&gt;&gt;\n&lt;&lt;set $tablePalomaChaser = &quot;[[Палома чейзер|Explanations][$recipe = 'PalomaChaser']]&quot;&gt;&gt;</div><div tiddler="NULL" tags="" created="201602092239" modifier="twee" twine-position="0,0"></div><div tiddler="StoryCaption" tags="" created="201602092239" modifier="twee" twine-position="0,0">&lt;hr&gt;\n\t&lt;span class=&quot;beta&quot;&gt;&lt;/span&gt;\n\t&lt;hr&gt;</div><div tiddler="Recipes" tags="" created="201602092239" modifier="twee" twine-position="0,0">Текила с лаймом и солью\nНалей в стопку серебряную текилу 50 мл\nСмочи долькой лайма руку между большим и указательным пальцем\nПосыпь это место солью\nЛизни соль, выпей шот и заверши его лаймом\n\n\tГлубинная бомба\nНалей в хайбол пиво светлое на 2/3\nНалей в стопку золотую текилу 15 мл\nПодожги и опусти стопку в хайбол с пивом\n\t\n\tПалома чейзер\nЛитрового кувшина чейзера хватит, чтобы запить 20 стопок текилы\nНалей в кувшин медовый сироп 10 мл и грейпфрутовый сок 30 мл\nВыжми лайм 0,5 шт\nДобавь щепотку соли\nРазмешай коктейльной ложкой\nРазлей золотую текилу по стопкам\nРазлей чейзер по стопкам\nВыпей текилу и запей чейзером</div><div tiddler="Restart" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;removeclass &quot;body&quot; &quot;drunkness100 drunkness110 drunkness120&quot;&gt;&gt;\n\t&lt;&lt;display &quot;StoryInit&quot;&gt;&gt;\n\t&lt;&lt;goto &quot;Mephisto&quot;&gt;&gt;</div><div tiddler="Start" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;div class=&quot;disclaimer&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;th&gt;&lt;div class=&quot;plus18&quot;&gt;18+&lt;/div&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th style=&quot;vertical-align:top&quot;&gt;&lt;div class=&quot;warning&quot;&gt;Употребление алкоголя вредит вашему здоровью&lt;br&gt;&lt;br&gt;/%[[Мне больше 18-ти|PalomaChaser][$recipe = &quot;PalomaChaser&quot;]]%/[[Мне больше 18-ти|Title]]&lt;/div&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;</div><div tiddler="Title" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">/%&lt;div class=&quot;title disclaimer&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;th&gt;&lt;div class=&quot;plus18&quot; style=&quot;font-family:Comfortaa;font-size:50px;line-height: 1em; width: 100%;border:none;&quot;&gt;[[НАЛИВАЙЯ|Mephisto]]&lt;/div&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;%/\n&lt;div class=&quot;title disclaimer&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;th style=&quot;vertical-align:bottom&quot;&gt;&lt;div class=&quot;plus18&quot; style=&quot;font-family:Comfortaa;font-size:50px;line-height: 1em; width: 100%;border:none&quot;&gt;[[НАЛИВАЙЯ|Mephisto]]&lt;/div&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th style=&quot;vertical-align:bottom&quot;&gt;&lt;div style=&quot;color:black;text-align:right;font-size:16px;font-weight:none&quot;&gt;[[Вячеслав Добранов|http://cheshire.ifiction.ru/]], май 2015&lt;/div&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;</div><div tiddler="Mephisto" tags="" created="201602092239" modifier="twee" twine-position="0,0">Часы над головой бармена показывают, что прошло уже три часа с тех пор, как ты зашёл в этот бар. Конечно, изначально ты планировал лишь спокойно выпить чашечку кофе после тяжёлого трудового дня, может быть, выкурить пару сигарет, а потом вернуться домой к ужину. Однако, как это часто бывает в таких делах, все планы были нарушены встречей со старым приятелем. В результате, после шести кружек пива, двух гневных звонков из дома и трёх походов в туалет, кто-то из вас высказал предложение поэкспериментировать.\n\tВы подозвали бармена и спросили его о каком-нибудь достойном коктейле, который можно попробовать двум взрослым мужчинам.\n\t«Замечательно, что вы спросили, — ответствовал он с широкой улыбкой. — В этом месяце наш бар проводит акцию „Выстрел в ногу“. Её суть следующая: у меня есть список из нескольких коктейлей на основе текилы, которые вы должны выпить. Если у вас это получается, то бар полностью берёт на себя весь ваш счёт».\n\tВы с приятелем переглядываетесь: «А в чём подвох?»\n\tУлыбка бармена становится ещё шире: «Коктейли вы готовите себе сами. Засчитываются только правильно приготовленные напитки, но вы обязаны выпить всё, что смешаете».\n\tСнова переглянувшись и пожав плечами, вы просите показать список.\n\t\n\t&lt;center&gt;[[Поехали!|AbandonHope]]&lt;/center&gt;</div><div tiddler="hhh" tags="" created="201602092239" modifier="twee" twine-position="0,0">/%:: AbandonHope\n\t&lt;&lt;print &quot;&lt;span class=&quot;+$loc+&quot;&gt;???&lt;/span&gt;&quot;&gt;&gt;\n\t&lt;br&gt;\t«Пожалуйста, — говорит бармен и выкладывает перед вами броско оформленный картонный лист. — Всего вы должны приготовить и выпить шесть коктейлей. В нескольких случаях у вас есть выбор, например, можете остановиться на „Эль Бандито“ вместо „Глубинной бобмы“ — он легче в приготовлении. Выбирайте коктейль и я расскажу, как его смешивать».\n&lt;center&gt;\n|!&lt;center&gt;№&lt;/center&gt;|!&lt;center&gt;Название&lt;/center&gt;|!&lt;center&gt;Сложность&lt;/center&gt;|!&lt;center&gt;Крепость&lt;/center&gt;|\n|&lt;center&gt;1&lt;/center&gt;|Текила с лаймом и солью|&lt;center&gt;★★☆&lt;/center&gt;|&lt;center&gt;★★☆&lt;/center&gt;|\n|&lt;center&gt;2&lt;/center&gt;|Текила бум|&lt;center&gt;★☆☆&lt;/center&gt;|&lt;center&gt;★★☆&lt;/center&gt;|\n|&lt;center&gt;3&lt;/center&gt;|Эль Бандито|&lt;center&gt;★★☆&lt;/center&gt;|&lt;center&gt;★★★&lt;/center&gt;|\n|~|Глубинная бомба|&lt;center&gt;★★☆&lt;/center&gt;|&lt;center&gt;★★★&lt;/center&gt;|\n|&lt;center&gt;4&lt;/center&gt;|Золотое дно|&lt;center&gt;★★☆&lt;/center&gt;|&lt;center&gt;★★☆&lt;/center&gt;|\n|~|Борец|&lt;center&gt;★★☆&lt;/center&gt;|&lt;center&gt;★★☆&lt;/center&gt;|\n|&lt;center&gt;5&lt;/center&gt;|Апельсиновый чейзер|&lt;center&gt;★★☆&lt;/center&gt;|&lt;center&gt;★★☆&lt;/center&gt;|\n|~|Палома чейзер|&lt;center&gt;★★☆&lt;/center&gt;|&lt;center&gt;★★☆&lt;/center&gt;|\n|&lt;center&gt;6&lt;/center&gt;|Красный пёс|&lt;center&gt;★★☆&lt;/center&gt;|&lt;center&gt;★★☆&lt;/center&gt;|\n&lt;/center&gt;%/</div><div tiddler="AbandonHope" tags="" created="201602092239" modifier="twee" twine-position="0,0">«Пожалуйста, — говорит бармен и выкладывает перед каждым по броско оформленному картонному листу. — Всего вы должны приготовить и выпить три коктейля. Выбирайте какой-нибудь и я расскажу, как его смешивать».\n&lt;&lt;display &quot;Table&quot;&gt;&gt;</div><div tiddler="Table" tags="" created="201602092239" modifier="twee" twine-position="0,0">&lt;center&gt;\n|!&lt;center&gt;№&lt;/center&gt;|!&lt;center&gt;Название&lt;/center&gt;|!&lt;center&gt;Сложность&lt;/center&gt;|!&lt;center&gt;Крепость&lt;/center&gt;|\n|&lt;center&gt;1&lt;/center&gt;|&lt;&lt;print $tableBasicRecipe&gt;&gt;|&lt;center&gt;★★☆&lt;/center&gt;|&lt;center&gt;★★☆&lt;/center&gt;|\n|&lt;center&gt;2&lt;/center&gt;|&lt;&lt;print $tableDepthCharge&gt;&gt;|&lt;center&gt;★☆☆&lt;/center&gt;|&lt;center&gt;★★★&lt;/center&gt;|\n|&lt;center&gt;3&lt;/center&gt;|&lt;&lt;print $tablePalomaChaser&gt;&gt;|&lt;center&gt;★★★&lt;/center&gt;|&lt;center&gt;★★☆&lt;/center&gt;|\n&lt;br&gt;&lt;/center&gt;&lt;&lt;display &quot;DrunkBlur&quot;&gt;&gt;</div><div tiddler="Explanations" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;DrunkBlur&quot;&gt;&gt;\n\t&lt;&lt;if $recipe == &quot;BasicRecipe&quot;&gt;&gt;\n\t\t«Это самый известный способ пить текилу — вы, наверняка, его знаете. У вас будет долька лайма, соль и стопка текилы. Нужно лаймом намочить руку, вот здесь, — он показывает на место между большим и указательным пальцами своей руки. — И затем посыпать её солью. И всё. Дальше только три быстрых действия: слизываете соль, выпиваете текилу и закусываете лаймом. Правда, легко? Выбираете этот рецепт?»\n\t&lt;&lt;elseif $recipe == &quot;DepthCharge&quot;&gt;&gt;\n\t\t«Глубинная бомба — очень простой в приготовлении коктейль. В высокий стакан наливаете на три четверти светлого лагера и аккуратно опускаете в него стопку с текилой. Когда стопка опускается на дно стакана, начинаете пить пиво и, в конце концов, текилу. Одним махом. Только медленно, чтобы стопкой не ударило по зубам. Вот и весь рецепт. Выбираете этот коктейль?»\n\t&lt;&lt;elseif $recipe == &quot;PalomaChaser&quot;&gt;&gt;\n\t\t«В Паломе много составляющих, поэтому он считается относительно сложным. В стопку наливаете медовый сироп, 10 мл., затем добавляете грейпфрутовый сок, 30 мл. Туда же выжимаете дольку лайма и сыпите щепотку соли. Перемешиваете коктейльной ложкой. Всё, чейзер готов. Выпиваете стопку текилы и запиваете стопкой чейзера. Выбираете его?»\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;center&gt;&lt;br&gt;\n\t[[Поехали-поехали!|$recipe]]\n\t&lt;br&gt;\n\t[[А что там по другим коктейлям?|Table]]&lt;/center&gt;</div><div tiddler="BarInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;musicInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;lampsInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;bottlesInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;barmanInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;clockInit&quot;&gt;&gt;</div><div tiddler="BarDescription" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты сидишь за стойкой маленького бара в паре кварталов от своего дома. Уютное местечко: негромкая &lt;&lt;prop &quot;музыка&quot; &quot;music&quot;&gt;&gt;, приглушённый &lt;&lt;prop &quot;свет&quot; &quot;lamps&quot;&gt;&gt;. Ярко освещены лишь стойка и &lt;&lt;prop &quot;полки&quot; &quot;bottles&quot;&gt;&gt; за спиной &lt;&lt;prop &quot;бармена&quot; &quot;barman&quot;&gt;&gt;. Прямо напротив висят местные &lt;&lt;prop &quot;часы&quot; &quot;clock&quot;&gt;&gt;.&lt;br&gt;&lt;br&gt;</div><div tiddler="musicInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $musicName = &quot;музыка&quot;&gt;&gt;</div><div tiddler="musicDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Из динамиков доносится ненавязчивый блюз, не мешающий вечному гулу разговоров.</div><div tiddler="lampsInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $lampsName = &quot;свет&quot;&gt;&gt;</div><div tiddler="lampsDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Над барной стойкой висят несколько ламп. В конусах их света клубятся облака сигаретного дыма.</div><div tiddler="bottlesInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $bottlesName = &quot;полки&quot;&gt;&gt;</div><div tiddler="bottlesDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Подсвеченные полки заставлены бутылками с выпивкой на любой вкус: американский, шотландский, ирландский виски, обойма бутылок мартини, цветная радуга ликёров, дорогие и не очень коньяки, водка и несколько квадратных бутылок текилы. Один лишь вид этого сверкающего великолепия грозит хроническим алкоголизмом.</div><div tiddler="barmanInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $barmanName = &quot;бармен&quot;&gt;&gt;</div><div tiddler="barmanDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Улыбчивый малый, двигающийся с ловкостью и скоростью ниндзя.</div><div tiddler="clockInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $clockName = &quot;часы&quot;&gt;&gt;</div><div tiddler="clockDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Над барменом висят большие часы с тремя циферблатами, показывающими время для разных городов. Так, в Лондоне сейчас &lt;&lt;clockwork -5&gt;&gt;, в Мюнхене &lt;&lt;clockwork -4&gt;&gt;. А вот местное уже &lt;&lt;clockwork&gt;&gt;.</div><div tiddler="Hint" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $recipe == &quot;BasicRecipe&quot;&gt;&gt;\n\t\t...лаймом намочить руку, посыпать её солью, слизать соль, выпить текилу, закусить лаймом...\n\t&lt;&lt;elseif $recipe == &quot;DepthCharge&quot;&gt;&gt;\n\t\t...налить 3/4 светлого лагера в стакан, опустить туда стопку, залпом всё выпить...\n\t&lt;&lt;elseif $recipe = &quot;PalomaChaser&quot;&gt;&gt;\n\t\t...в стопку влить 10 мл. медового сиропа, 30 мл. грейпфрутового сока, выжать дольку лайма, добавить щепотку соли, перемешать коктейльной ложкой, выпить текилу, запить чейзером...\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="HowDrunkAreYou" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $i = $drunkness/10-6&gt;&gt;\n\tОпьянение: &lt;&lt;print $drunkness&gt;&gt;% [&lt;&lt;print $AllGodsNames[$i]&gt;&gt;]</div><div tiddler="BadEnd" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">@@.drunkness120;Ты вскакиваешь со стула и бросаешься в направлении туалета.\n\t&lt;br&gt;\n\tЧерез полчаса там тебя, бесчувственного, и находит твой товарищ на пару с охранником, вскрывшем дверь. Тебя приводят в относительный порядок, усаживают в такси, доставляют домой и передают в руки жены. Но ты всего этого не помнишь.@@\n\t&lt;br&gt;&lt;br&gt;\n\tУтро тебя встречает ослепительным солнцем из окна, яркими вспышками головной боли и сверкающими глазами супруги.\n\t&lt;br&gt;&lt;br&gt;\n\t&lt;center&gt;[[Попытать счастья ещё раз?|Restart]]&lt;/center&gt;</div><div tiddler="LastOutcome" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">«Ну что же, — с деланным разочарованием протягивает бармен. — Похоже, вы выполнили все условия акции — приготовили и выпили по три отличных коктейля. Поздравляю!»\n\t&lt;br&gt;\n\tТы, улыбаясь широкой нетрезвой улыбкой, киваешь в ответ. Бармен протягивает вам по картонному листу с вычеркнутыми названиями коктейлей: «А это вам на память. И вот ещё, — с этими словами он выкладывает перед вами ваш чек, так же перечёркнутый и с нарисованной рожицей в самбреро. — Как и обещано, бар берёт на себя все ваши расходы. Спасибо за визит. Ждём вас ещё!»\n\t&lt;br&gt;\n\tКакой же славный малый, думаешь ты, и уже было собираешься расцеловать бармена, но тот уже на другом конце стойки обслуживает другого клиента. Потом вы с приятелем хохоча собираете свои трофеи и шумно покидаете заведение.\n\t&lt;br&gt;&lt;br&gt;\n\t&lt;center&gt;[[Виват!|GoodEnd]]&lt;/center&gt;</div><div tiddler="GoodEnd" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты плохо помнишь события той ночи, но судя по тем моментам, что вспоминаются, ты отлично провёл время.\n\t&lt;br&gt;\n\tВот ты с криком «Паркур!» прыгаешь через большие бетонные клумбы, установленные вдоль тротуара. Потом отплёвываешься и утираешь землю с лица.\n\t&lt;br&gt;\n\tВот ты по колено в воде городского центрального фонтана фотографируешься, приобняв статую Афродиты. Она в отместку бьёт в тебя струёй воды.\n\t&lt;br&gt;\n\tВот ты старательно не привлекаешь внимания проходящего мимо полицейского патруля, пока твой приятель мочится за углом.\n\t&lt;br&gt;\n\tВот вы давитесь от смеха в тёмном переулке, стараясь при этом отдышаться и не выдать себя. На голове у тебя серая полицейская кепка и где-то неподалёку слышен топот берц.\n\t&lt;br&gt;\n\tВот ты лежишь в пыли у колеса уазика с заломленными за спину руками. Слышно, как твой приятель куда-то звонит и с кем-то о чём-то договаривается.\n\t&lt;br&gt;\n\tА вот уже светает. Вы, обнявшись, идёте посередине выцветшей безлюдной улицы и горланите матерные панковские песни. Где-то в ответ лает собака.\n\t&lt;br&gt;\n\tПотом было одинокое медленное такси, в котором ты уснул, а проснулся уже у своего дома. Вышел, зевнул и, щурясь на встающее солнце, пошёл досыпать.\n\t&lt;br&gt;\n\t&lt;br&gt;\n\t&lt;br&gt;\n\t&lt;br&gt;\n\t&lt;center&gt;@@font-size:30px;font-weight:bold;КОНЕЦ@@&lt;/center&gt;\n\t&lt;br&gt;\n\t&lt;br&gt;</div><div tiddler="ScreenBuild" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;DrunkBlur&quot;&gt;&gt;\n\t&lt;&lt;set $recipeLog = []&gt;&gt;\n\t&lt;&lt;set $historyArr = []&gt;&gt;\n\t&lt;&lt;unset $focus&gt;&gt;\n\t&lt;div class=&quot;commandline&quot;&gt;&lt;p class=&quot;hint&quot;&gt;&lt;&lt;click $recipeName&gt;&gt;&lt;&lt;replace &quot;.events&quot;&gt;&gt;&lt;&lt;display &quot;Hint&quot;&gt;&gt;&lt;&lt;/replace&gt;&gt;&lt;&lt;/click&gt;&gt;&lt;/p&gt;&lt;p class=&quot;drunkness&quot;&gt;&lt;&lt;display &quot;HowDrunkAreYou&quot;&gt;&gt;&lt;/p&gt;&lt;/div&gt;\n\t&lt;span class=&quot;decor&quot;&gt;&lt;&lt;display &quot;BarDescription&quot;&gt;&gt;&lt;/span&gt;\n\t&lt;span class=&quot;inventory&quot;&gt;&lt;&lt;print $recipeInv&gt;&gt;&lt;/span&gt;\n\t&lt;span class=&quot;history&quot;&gt;&lt;/span&gt;\n\t&lt;span class=&quot;focus&quot;&gt;&lt;/span&gt;\n\t&lt;span class=&quot;actions&quot;&gt;&lt;/span&gt;\n\t&lt;span class=&quot;events&quot;&gt;&lt;/span&gt;\n\t&lt;span class=&quot;outcome&quot;&gt;&lt;/span&gt;</div><div tiddler="DrunkBlur" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $drunkness == 100&gt;&gt;\n\t\t&lt;&lt;addclass &quot;body&quot; &quot;drunkness100&quot;&gt;&gt;\n\t&lt;&lt;elseif $drunkness == 110&gt;&gt;\n\t\t&lt;&lt;removeclass &quot;body&quot; &quot;drunkness100&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;body&quot; &quot;drunkness110&quot;&gt;&gt;\n\t&lt;&lt;elseif $drunkness &gt;= 120&gt;&gt;\n\t\t&lt;&lt;removeclass &quot;body&quot; &quot;drunkness110&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;body&quot; &quot;drunkness120&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\n\n\n\n/%\n\t\t   #####                                                                       \n\t\t  ##  ##            ##                                                         \n\t\t  ##  ##  ####   ##   ## ##   ##    ##   ##     #####   #####    ##### ##      \n\t\t  ##  ##     ##  ##  ### ### ###    ##  ###    ##      ##   ##  ##  ## ##      \n\t\t  ##  ##  #####  ## # ## ## # ##    ## # ##    ##      ##   ##  ##  ## ######  \n\t\t  ##  ## ##  ##  ###  ## ##   ##    ###  ##    ##      ##   ##  ##  ## ##   ## \n\t\t ##   ##  ###### ##   ## ##   ##    ##   ##     #####   #####  ##   ## ######  \n%/</div><div tiddler="BasicRecipeInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;plateInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;counterInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;limeInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;salterInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;shotInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;tequilaInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;handsInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;lefthandInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;righthandInit&quot;&gt;&gt;\n\t&lt;&lt;set $recipeName = &quot;Текила с лаймом и солью&quot;&gt;&gt;\n\t&lt;&lt;set $recipeInv = &quot;&lt;&lt;display 'counterInv'&gt;&gt; &lt;&lt;display 'handsInv'&gt;&gt;&quot;&gt;&gt;</div><div tiddler="BasicRecipe" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;BasicRecipeInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;ScreenBuild&quot;&gt;&gt;</div><div tiddler="BasicRecipeDaemon" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;replace &quot;.beta&quot;&gt;&gt;&lt;&lt;print $righthandSalted&gt;&gt;&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;display &quot;DrunkBlur&quot;&gt;&gt;\n\t&lt;&lt;if $recipeLog[0] == &quot;lickHand&quot; &amp;&amp; $recipeLog[1] == &quot;drinkTequila&quot; &amp;&amp; $recipeLog[2] == &quot;eatLime&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.decor&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.inventory&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.history&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.focus&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.actions&quot; &quot;hidden&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.hint&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;set $args[2] = &quot;Ты с наслаждением впиваешься в дольку лайма, жмурясь, пережёвываешь его и довольный зовёшь бармена.&quot;&gt;&gt;\n\t\t&lt;&lt;replace &quot;.outcome&quot;&gt;&gt;\n\t\t\t&lt;br&gt;[[Сделано!|BasicRecipeOutcome][$outcome++]]\n\t\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;elseif $drunkness &gt;= 120&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.decor&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.inventory&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.history&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.focus&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.actions&quot; &quot;hidden&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.hint&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;set $args[2] = &quot;Ты прикладываешь стопку к губам, запрокидываешь голову и, с трудом проглотив текилу, вдруг чувствуешь, как к горлу подкатывает тошнота.&quot;&gt;&gt;\n\t\t&lt;&lt;replace &quot;.outcome&quot;&gt;&gt;\n\t\t\t&lt;br&gt;[[!!!|BasicRecipeOutcome][$outcome = 0]]\n\t\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if !$plateChildren.contains(&quot;lime&quot;) and !$lefthandChildren.contains(&quot;lime&quot;) and !$righthandChildren.contains(&quot;lime&quot;)&gt;&gt;\n\t\t\t&lt;&lt;display &quot;limeInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $plateChildren.push(&quot;lime&quot;)&gt;&gt;\n\t\t\t&lt;&lt;set $BasicRecipeEvent = &quot;Бармен выкладывает на тарелку ещё пару ломтиков лайма, один из которых тут же подцепляет твой товарищ.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if !$shotChildren.contains(&quot;tequila&quot;) and $counterChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\t\t&lt;&lt;display &quot;tequilaInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $shotChildren.push(&quot;tequila&quot;)&gt;&gt;\n\t\t\t&lt;&lt;set $BasicRecipeEvent = &quot;Бармен ловким движением наполняет твою стопку.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if !$counterChildren.contains(&quot;salter&quot;) and !$lefthandChildren.contains(&quot;salter&quot;) and !$righthandChildren.contains(&quot;salter&quot;)&gt;&gt;\n\t\t\t&lt;&lt;display &quot;salterInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $counterChildren.push(&quot;salter&quot;)&gt;&gt;\n\t\t\t&lt;&lt;set $BasicRecipeEvent = &quot;Бармен возвращается и ставит перед тобой новую солонку.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if $recipeLog[0] &amp;&amp; $recipeLog[0] != &quot;lickHand&quot;&gt;&gt;\n\t\t\t&lt;&lt;if $BasicRecipeEvent&gt;&gt;\n\t\t\t\t&lt;&lt;set $BasicRecipeEvent = &quot;Ты задумываешься, а всё ли по инструкции ты делаешь.&lt;br&gt;&lt;br&gt;&quot;+$BasicRecipeEvent&gt;&gt;\n\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\t&lt;&lt;set $BasicRecipeEvent = &quot;Ты задумываешься, а всё ли по инструкции ты делаешь.&quot;&gt;&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t\t&lt;&lt;set $recipeLog = []&gt;&gt;\n\t\t&lt;&lt;elseif $recipeLog[2] &amp;&amp; $recipeLog[1] != &quot;drinkTequila&quot;&gt;&gt;\n\t\t\t&lt;&lt;if $BasicRecipeEvent&gt;&gt;\n\t\t\t\t&lt;&lt;set $BasicRecipeEvent = &quot;Кажется, ты выполнил все нужные действия, правда, не в той последовательности.&lt;br&gt;&lt;br&gt;&quot;+$BasicRecipeEvent&gt;&gt;\n\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\t&lt;&lt;set $BasicRecipeEvent = &quot;Кажется, ты выполнил все нужные действия, правда, не в той последовательности.&quot;&gt;&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t\t&lt;&lt;set $recipeLog = []&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="BasicRecipeOutcome" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $outcome&gt;&gt;\n\t\t«Отлично, — говорит подошедший бармен. — Я засчитываю вам текилу с лаймом и солью». С этими словами он вычёркивает первый коктейль в списке.\n\t\t&lt;br&gt;\n\t\t&lt;&lt;if $outcome &lt; 3&gt;&gt;\n\t\t\t«Выбирайте следующий»&lt;&lt;print ($counterSalted || $counterLimed ? &quot; — говорит он, протирая стойку перед тобой&quot; : &quot;&quot;)&gt;&gt;.\n\t\t\t&lt;br&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;set $tableBasicRecipe = &quot;''==Текила с лаймом и солью==''&quot;&gt;&gt;\n\t\t&lt;&lt;display &quot;Table&quot;&gt;&gt;\n\t\t&lt;&lt;if $outcome == 3&gt;&gt;\n\t\t\t&lt;&lt;display &quot;LastOutcome&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;display &quot;BadEnd&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\n\n/%\n\t\t #######                                                                                                            \n\t\t ##                          ##                                                 ##                      ##          \n\t\t ##        ##### ##   ##  ####   ##   ## ##   ## ##   ##  ####     #####     ####    #####  ##   ##  ####    ####   \n\t\t ##       ##  ## ##   ## ##      ##  ### ##   ## ##   ##     ##   ##  ##    ##      ##   ## ### ### ##          ##  \n\t\t ##       ##  ## ##   ## ######  ## # ## ####### #######  #####    #####    ######  ##   ## ## # ## ######   #####  \n\t\t ##       ##  ##  ###### ##   ## ###  ## ##   ## ##   ## ##  ##   ##  ##    ##   ## ##   ## ##   ## ##   ## ##  ##  \n\t\t ##      ##   ##      ##  #####  ##   ## ##   ## ##   ##  ###### ##   ##     #####   #####  ##   ##  #####   ###### \n\t\t                  #####                                                                                            \n%/</div><div tiddler="DepthChargeInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;shotInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;tequilaInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;counterInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;handsInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;lefthandInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;righthandInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;highballInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;beerInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;bottleInit&quot;&gt;&gt;\n\t&lt;&lt;set $recipeName = &quot;Глубинная бомба&quot;&gt;&gt;\n\t&lt;&lt;set $recipeInv = &quot;&lt;&lt;display 'counterInv'&gt;&gt; &lt;&lt;display 'handsInv'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;set $counterChildren = [&quot;bottle&quot;, &quot;highball&quot;, &quot;shot&quot;]&gt;&gt;</div><div tiddler="DepthCharge" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;DepthChargeInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;ScreenBuild&quot;&gt;&gt;</div><div tiddler="DepthChargeDaemon" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;replace &quot;.beta&quot;&gt;&gt;&lt;&lt;print $shotChildren.toString()&gt;&gt;&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;display &quot;DrunkBlur&quot;&gt;&gt;\n\t&lt;&lt;if $recipeLog[0] == &quot;done&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.decor&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.inventory&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.history&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.focus&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.actions&quot; &quot;hidden&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.hint&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $args[2] = &quot;Ты, наконец, допиваешь остатки пива вперемешку с текилой — стопка легонько стукается о зубы — и, отняв стакан ото рта, шумно выдыхаешь, вытираешь выступившие слёзы и с победной улыбкой водружаешь пустой стакан на стойку.&quot;&gt;&gt;\n\t\t&lt;&lt;replace &quot;.outcome&quot;&gt;&gt;\n\t\t\t&lt;br&gt;[[Сделано!|DepthChargeOutcome][$outcome++]]\n\t\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;elseif $drunkness &gt;= 120&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.decor&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.inventory&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.history&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.focus&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.actions&quot; &quot;hidden&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.hint&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;if $args[1] == &quot;Продолжать пить пиво&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $args[2] = &quot;Ты большими глотками пьёшь пиво из стакана и вдруг чувствуешь, как к горлу подкатывает тошнота.&quot;&gt;&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;set $args[2] = &quot;Ты прикладываешь стопку к губам, запрокидываешь голову и, с трудом проглотив текилу, вдруг чувствуешь, как к горлу подкатывает тошнота.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;replace &quot;.outcome&quot;&gt;&gt;\n\t\t\t&lt;br&gt;[[!!!|DepthChargeOutcome][$outcome = 0]]\n\t\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if $args[1] != &quot;Продолжать пить пиво&quot; &amp;&amp; $args[1] != &quot;Начать пить пиво&quot; &amp;&amp; $args[2]&gt;&gt;\n\t\t\t&lt;&lt;unset $beerDrinking&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if $args[1] != &quot;Наливать пиво в стакан&quot; &amp;&amp; $args[1] != &quot;Продолжать наливать пиво в стакан&quot; &amp;&amp; $args[2]&gt;&gt;\n\t\t\t&lt;&lt;unset $bottlePouring&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if !$shotChildren.contains(&quot;tequila&quot;) and $counterChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\t\t&lt;&lt;display &quot;tequilaInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $shotChildren.push(&quot;tequila&quot;)&gt;&gt;\n\t\t\t&lt;&lt;set $DepthChargeEvent = &quot;Бармен ловким движением наполняет твою стопку.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if $bottleBeer == 0 and $counterChildren.contains(&quot;bottle&quot;)&gt;&gt;\n\t\t\t&lt;&lt;display &quot;bottleInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $DepthChargeEvent = &quot;Бармен забирает пустую бутылку и, пшикнув крышкой, выставляет перед тобой свежую.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if !$shotChildren.contains(&quot;tequila&quot;) &amp;&amp; !$highballChildren.contains(&quot;beer&quot;) &amp;&amp; $counterChildren.contains(&quot;highball&quot;) &amp;&amp; $highballChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\t\t&lt;&lt;display &quot;tequilaInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;display &quot;shotInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;display &quot;highballInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $counterChildren.push(&quot;shot&quot;)&gt;&gt;\n\t\t\t&lt;&lt;unset $DepthChargeCondition&gt;&gt;\n\t\t\t&lt;&lt;set $DepthChargeEvent = &quot;Бармен забирает твой стакан, выставляет чистый и наливает текилу в новую стопку.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="DepthChargeOutcome" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $outcome&gt;&gt;\n\t\t«Отлично, — говорит подошедший бармен. — Я засчитываю вам „Глубинную бомбу“». С этими словами он вычёркивает второй коктейль в списке.\n\t\t&lt;br&gt;\n\t\t&lt;&lt;if $outcome &lt; 3&gt;&gt;\n\t\t\t«Выбирайте следующий».\n\t\t\t&lt;br&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;set $tableDepthCharge = &quot;''==Глубинная бомба==''&quot;&gt;&gt;\n\t\t&lt;&lt;display &quot;Table&quot;&gt;&gt;\n\t\t&lt;&lt;if $outcome == 3&gt;&gt;\n\t\t\t&lt;&lt;display &quot;LastOutcome&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;display &quot;BadEnd&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\n\n/%\n\t\t #######                                                                                            \n\t\t ##   ##                                                               ##                           \n\t\t ##   ##  ####     #####  #####  ##   ##  ####      ##   ##  #####  ##   ##  #####   #####  ######  \n\t\t ##   ##     ##   ##  ## ##   ## ### ###     ##     ##   ## ##   ## ##  ### ##   ## ##   ## ##   ## \n\t\t ##   ##  #####   ##  ## ##   ## ## # ##  #####      ###### ######  ## # ##    ###  ######  ######  \n\t\t ##   ## ##  ##   ##  ## ##   ## ##   ## ##  ##          ## ##      ###  ## ##   ## ##      ##      \n\t\t ##   ##  ###### ##   ##  #####  ##   ##  ######         ##  #####  ##   ##  #####   #####  ##     \n%/</div><div tiddler="PalomaChaserInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;shotInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;shot2Init&quot;&gt;&gt;\n\t&lt;&lt;display &quot;tequilaInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;plateInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;limeInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;salterInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;honeyInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;juiceInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;jiggerInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;spoonInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;counterInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;handsInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;lefthandInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;righthandInit&quot;&gt;&gt;\n\t&lt;&lt;set $recipeName = &quot;Палома чейзер&quot;&gt;&gt;\n\t&lt;&lt;set $recipeInv = &quot;&lt;&lt;display 'counterInv'&gt;&gt; &lt;&lt;display 'handsInv'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;set $counterChildren = [&quot;shot&quot;, &quot;plate&quot;, &quot;salter&quot;, &quot;honey&quot;, &quot;juice&quot;, &quot;shot2&quot;, &quot;jigger&quot;, &quot;spoon&quot;]&gt;&gt;</div><div tiddler="PalomaChaser" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;PalomaChaserInit&quot;&gt;&gt;\n\t&lt;&lt;display &quot;ScreenBuild&quot;&gt;&gt;</div><div tiddler="PalomaChaserDaemon" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;replace &quot;.beta&quot;&gt;&gt;&lt;&lt;print $recipeLog.toString()&gt;&gt;&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;display &quot;DrunkBlur&quot;&gt;&gt;\n\t&lt;&lt;if $recipeLog[1] == &quot;drinkPaloma&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.decor&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.inventory&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.history&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.focus&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.actions&quot; &quot;hidden&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.hint&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;set $args[2] = &quot;Ты залпом запиваешь текилу превосходно приготовленным Палома чейзером и с победной улыбкой ставишь стопку на стойку.&quot;&gt;&gt;\n\t\t&lt;&lt;replace &quot;.outcome&quot;&gt;&gt;\n\t\t\t&lt;br&gt;[[Сделано!|PalomaChaserOutcome][$outcome++]]\n\t\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;elseif $drunkness &gt;= 120&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.decor&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.inventory&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.history&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.focus&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.actions&quot; &quot;hidden&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.hint&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;set $args[2] = &quot;Ты прикладываешь стопку к губам, запрокидываешь голову и, с трудом проглотив текилу, вдруг чувствуешь, как к горлу подкатывает тошнота.&quot;&gt;&gt;\n\t\t&lt;&lt;replace &quot;.outcome&quot;&gt;&gt;\n\t\t\t&lt;br&gt;[[!!!|PalomaChaserOutcome][$outcome = 0]]\n\t\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if $plateChildren.contains(&quot;lime&quot;) and $limeSqueezed&gt;&gt;\n\t\t\t&lt;&lt;display &quot;limeInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $PalomaChaserEvent = &quot;Проходя мимо, бармен меняет твой выжатый лайм на новый.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if !$plateChildren.contains(&quot;lime&quot;) and !$lefthandChildren.contains(&quot;lime&quot;) and !$righthandChildren.contains(&quot;lime&quot;)&gt;&gt;\n\t\t\t&lt;&lt;display &quot;limeInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $plateChildren.push(&quot;lime&quot;)&gt;&gt;\n\t\t\t&lt;&lt;set $PalomaChaserEvent = &quot;Бармен выкладывает на тарелку новую дольку лайма.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if !$shotChildren.contains(&quot;tequila&quot;) and $counterChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\t\t&lt;&lt;display &quot;tequilaInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $shotChildren.push(&quot;tequila&quot;)&gt;&gt;\n\t\t\t&lt;&lt;set $PalomaChaserEvent = &quot;Бармен ловким движением наполняет твою стопку.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if !$counterChildren.contains(&quot;salter&quot;) and !$lefthandChildren.contains(&quot;salter&quot;) and !$righthandChildren.contains(&quot;salter&quot;)&gt;&gt;\n\t\t\t&lt;&lt;display &quot;salterInit&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $counterChildren.push(&quot;salter&quot;)&gt;&gt;\n\t\t\t&lt;&lt;set $PalomaChaserEvent = &quot;Бармен возвращается и ставит перед тобой новую солонку.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if $shot2contents.honey == 10 &amp;&amp; $shot2contents.juice == 30 &amp;&amp; $shot2contents.lime &amp;&amp; $shot2contents.salt&gt;&gt;\n\t\t\t&lt;&lt;set $shot2Ready = true&gt;&gt;\n\t\t\t&lt;&lt;set $shot2Name = &quot;стопка с Палома чейзером&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $shot2NameG = &quot;стопку с Палома чейзером&quot;&gt;&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;unset $shot2Ready&gt;&gt;\n\t\t\t&lt;&lt;set $shot2Name = &quot;стопка для чейзера&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $shot2NameG = &quot;стопку для чейзера&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if $recipeLog[0] == &quot;drinkTequila&quot; &amp;&amp; $shot2Ready&gt;&gt;\n\t\t\t&lt;&lt;if !$counter&gt;&gt;\n\t\t\t\t&lt;&lt;set $counter = 1&gt;&gt;\n\t\t\t\t&lt;&lt;set $PalomaChaserEvent = &quot;Надо скорее запить текилу Палома чейзером.&quot;&gt;&gt;\n\t\t\t&lt;&lt;elseif $counter &lt; 4&gt;&gt;\n\t\t\t\t&lt;&lt;set $counter++&gt;&gt;\n\t\t\t\t&lt;&lt;set $PalomaChaserEvent = &quot;Надо скорее запить текилу Палома чейзером.&quot;&gt;&gt;\n\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\t&lt;&lt;set $counter = 0&gt;&gt;\n\t\t\t\t&lt;&lt;set $recipeLog = []&gt;&gt;\n\t\t\t\t&lt;&lt;set $PalomaChaserEvent = &quot;Ты, морщась, выдыхаешь. Надо было сразу запивать текилу чейзером. Теперь уже поздно.&quot;&gt;&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;set $recipeLog = []&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="PalomaChaserOutcome" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $outcome&gt;&gt;\n\t\t«Отлично, — говорит подошедший бармен. — Я засчитываю вам „Палома чейзер“». С этими словами он вычёркивает третий коктейль в списке.\n\t\t&lt;br&gt;\n\t\t&lt;&lt;if $outcome &lt; 3&gt;&gt;\n\t\t\t«Выбирайте следующий».\n\t\t\t&lt;br&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;set $tablePalomaChaser = &quot;''==Палома чейзер==''&quot;&gt;&gt;\n\t\t&lt;&lt;display &quot;Table&quot;&gt;&gt;\n\t\t&lt;&lt;if $outcome == 3&gt;&gt;\n\t\t\t&lt;&lt;display &quot;LastOutcome&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;display &quot;BadEnd&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\n\n\n\n/%\n\t\t  #####                                                  \n\t\t ##   ##     ##                                          \n\t\t ##   ##  ####   ###      #####  ##   ## ######  ##   ## \n\t\t ##   ## ##       ##     ##   ## ##  ##    ##    ##   ## \n\t\t ##   ## ######   #####  ######  #####     ##    ####  # \n\t\t ##   ## ##   ##  ##  ## ##      ##  ##    ##    ##  # # \n\t\t  #####   #####   #####   #####  ##   ##   ##    ####  # \n%/\n\n\n\n\n\n/%\n\t\t\n\t\t ######  ##   ## ##   ## ##   ## \n\t\t ##   ## ##   ## ##  ##  ##  ### \n\t\t ######  ##   ## #####   ## # ## \n\t\t ##       ###### ##  ##  ###  ## \n\t\t ##           ## ##   ## ##   ## \n\t\t          #####             \n%/</div><div tiddler="handsInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $handsChildren = [&quot;lefthand&quot;, &quot;righthand&quot;]&gt;&gt;\n\t&lt;&lt;set $handsName = &quot;руки&quot;&gt;&gt;</div><div tiddler="handsDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0"></div><div tiddler="handsInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $lefthandChildren[0]&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $helper = '&quot;+$lefthandChildren[0]+&quot;Inv'&gt;&gt;&quot;&gt;&gt;\n\t\tВ &lt;&lt;object &quot;левой&quot; &quot;lefthand&quot;&gt;&gt; руке у тебя &lt;&lt;display $helper&gt;&gt;, \n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;object &quot;Левой&quot; &quot;lefthand&quot;&gt;&gt; рукой ты хлопаешь по колену в ритм блюзовой партии, что доносится из динамиков, \n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if $righthandChildren[0]&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $helper = '&quot;+$righthandChildren[0]+&quot;Inv'&gt;&gt;&quot;&gt;&gt;\n\t\tв &lt;&lt;object &quot;правой&quot; &quot;righthand&quot;&gt;&gt; &lt;&lt;print ($lefthandChildren[0] ? &quot;—&quot; : &quot;руке у тебя&quot;)&gt;&gt; &lt;&lt;display $helper&gt;&gt;.\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;object &quot;правой&quot; &quot;righthand&quot;&gt;&gt; барабанишь по стойке.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="handsTakeFull" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты не уверен, но, кажется, обе твои руки заняты.\n\n\n/%\n\t\t   #####  #####  #####    ####     #####    ######  ##   ## ##   ##  ####   \n\t\t  ##  ## ##   ## ##  ##      ##   ##  ##    ##   ## ##   ## ##  ##      ##  \n\t\t  ##  ## ######  ######   #####    #####    ######  ##   ## #####    #####  \n\t\t  ##  ## ##      ##   ## ##  ##   ##  ##    ##       ###### ##  ##  ##  ##  \n\t\t ##   ##  #####  ######   ###### ##   ##    ##           ## ##   ##  ###### \n\t\t                                                     #####    \n%/</div><div tiddler="lefthandInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $lefthandChildren = []&gt;&gt;\n\t&lt;&lt;set $lefthandName = &quot;левая рука&quot;&gt;&gt;\n\t&lt;&lt;set $lefthandNameG = &quot;левую руку&quot;&gt;&gt;\n\t&lt;&lt;set $lefthandParent = &quot;hands&quot;&gt;&gt;\n\t&lt;&lt;unset $lefthandDisabled $lefthandSalted $lefthandLimed&gt;&gt;</div><div tiddler="lefthandDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Твоя левая рука.\n\t&lt;&lt;if $lefthandLimed&gt;&gt;\n\t\t Смоченная соком лайма\n\t\t&lt;&lt;if $lefthandSalted&gt;&gt;\n\t\t и посыпанная солью\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t.\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if $lefthandChildren[0]&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $helper = $&quot;+ $lefthandChildren[0] +&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t\t В ней ты держишь &lt;&lt;object $helper $lefthandChildren[0]&gt;&gt;.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="lefthandInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0"></div><div tiddler="lefthandAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $lefthandLimed &amp;&amp; $lefthandSalted &amp;&amp; $recipe == &quot;BasicRecipe&quot;&gt;&gt;\n\t\t&lt;br&gt;\n\t\t&lt;&lt;Lick &quot;lefthand&quot; &quot;Слизнуть соль&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="lefthandSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $salterParent != &quot;lefthand&quot;&gt;&gt;\n\t\t&lt;&lt;if $lefthandLimed&gt;&gt;\n\t\t\tТы насыпаешь немного соли на &lt;&lt;object &quot;левую руку&quot; &quot;lefthand&quot;&gt;&gt;, там, где она была смочена &lt;&lt;object &quot;лаймом&quot; &quot;lime&quot;&gt;&gt;.\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\tТы сыпешь соль на участок между большим и указательным пальцами &lt;&lt;object &quot;левой руки&quot; &quot;lefthand&quot;&gt;&gt;, но она немедленно ссыпается оттуда.\n\t\t\t&lt;&lt;set $lefthandSalted = 0&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\tТы пытаешься посыпать солью ту же &lt;&lt;object &quot;руку&quot; &quot;lefthand&quot;&gt;&gt;, в которой держишь солонку, но, естественно, ничего не выходит.\n\t\t&lt;&lt;set $lefthandSalted = 0&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="lefthandLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $limeParent != &quot;lefthand&quot;&gt;&gt;\n\t\tДолькой лайма ты смачиваешь &lt;&lt;object &quot;левую руку&quot; &quot;lefthand&quot;&gt;&gt; на участке между большим и указательным пальцами.\n\t&lt;&lt;else&gt;&gt;\n\t\tТы несколько минут пытаешься намочить соком лайма ту же &lt;&lt;object &quot;руку&quot; &quot;lefthand&quot;&gt;&gt;, в которой этот лайм держишь. Безуспешно.\n\t\t&lt;&lt;set $lefthandLimed = 0&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="lefthandLick" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты слизываешь всю соль и весь лаймовый сок с левой руки.</div><div tiddler="lefthandLickAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $recipeLog = []&gt;&gt;\n\t&lt;&lt;set $recipeLog.push(&quot;lickHand&quot;)&gt;&gt;</div><div tiddler="lefthandSqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $limeParent != &quot;lefthand&quot;&gt;&gt;\n\t\tТы собираешься выдавить всю дольку себе на &lt;&lt;object &quot;левую руку&quot; &quot;lefthand&quot;&gt;&gt;, но вспоминаешь, что это совсем другой рецепт.\n\t&lt;&lt;else&gt;&gt;\n\t\tТы собираешься выдавить всю дольку себе на &lt;&lt;object &quot;левую руку&quot; &quot;lefthand&quot;&gt;&gt;, но вспоминаешь, что, во-первых, держишь лайм в этой же руке, а во-вторых, что это совсем другой рецепт.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="lefthandSqueezeLimeAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;unset $lefthandLimed&gt;&gt;\n\n\n/%\n\t\t ######  ######   ####   #####    ####     #####    ######  ##   ## ##   ##  ####   \n\t\t ##   ## ##   ##     ##  ##  ##      ##   ##  ##    ##   ## ##   ## ##  ##      ##  \n\t\t ##   ## ######   #####  ######   #####    #####    ######  ##   ## #####    #####  \n\t\t ##   ## ##      ##  ##  ##   ## ##  ##   ##  ##    ##       ###### ##  ##  ##  ##  \n\t\t ##   ## ##       ###### ######   ###### ##   ##    ##           ## ##   ##  ###### \n\t\t                                                             #####  \n%/</div><div tiddler="righthandInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $righthandChildren = []&gt;&gt;\n\t&lt;&lt;set $righthandName = &quot;правая рука&quot;&gt;&gt;\n\t&lt;&lt;set $righthandNameG = &quot;правую руку&quot;&gt;&gt;\n\t&lt;&lt;set $righthandParent = &quot;hands&quot;&gt;&gt;\n\t&lt;&lt;unset $righthandDisabled $righthandSalted $righthandLimed&gt;&gt;</div><div tiddler="righthandDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Твоя правая рука. С кольцом на безымянном пальце.\n\t&lt;&lt;if $righthandLimed&gt;&gt;\n\t\t Смоченная соком лайма\n\t\t&lt;&lt;if $righthandSalted&gt;&gt;\n\t\t и посыпанная солью\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t.\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if $righthandChildren[0]&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $helper = $&quot;+ $righthandChildren[0] +&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t\t В руке ты держишь &lt;&lt;object $helper $righthandChildren[0]&gt;&gt;.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="righthandInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0"></div><div tiddler="righthandAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $righthandLimed &amp;&amp; $righthandSalted &amp;&amp; $recipe == &quot;BasicRecipe&quot;&gt;&gt;\n\t\t&lt;br&gt;\n\t\t&lt;&lt;Lick &quot;righthand&quot; &quot;Слизнуть соль&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="righthandSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $salterParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;if $righthandLimed&gt;&gt;\n\t\t\tТы насыпаешь немного соли на &lt;&lt;object &quot;правую руку&quot; &quot;righthand&quot;&gt;&gt;, там, где она была смочена &lt;&lt;object &quot;лаймом&quot; &quot;lime&quot;&gt;&gt;.\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\tТы сыпешь соль на участок между большим и указательным пальцами &lt;&lt;object &quot;правой руки&quot; &quot;righthand&quot;&gt;&gt;, но она немедленно ссыпается оттуда.\n\t\t\t&lt;&lt;set $righthandSalted = 0&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\tТы пытаешься посыпать солью ту же &lt;&lt;object &quot;руку&quot; &quot;righthand&quot;&gt;&gt;, в которой держишь солонку, но, естественно, ничего не выходит.\n\t\t&lt;&lt;set $righthandSalted = 0&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="righthandLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $limeParent != &quot;righthand&quot;&gt;&gt;\n\t\tДолькой лайма ты смачиваешь &lt;&lt;object &quot;правую руку&quot; &quot;righthand&quot;&gt;&gt; на участке между большим и указательным пальцами.\n\t&lt;&lt;else&gt;&gt;\n\t\tТы несколько минут пытаешься намочить соком лайма ту же &lt;&lt;object &quot;руку&quot; &quot;righthand&quot;&gt;&gt;, в которой этот лайм держишь. Безуспешно.\n\t\t&lt;&lt;set $righthandLimed = 0&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="righthandLick" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты слизываешь всю соль и весь лаймовый сок с правой руки.</div><div tiddler="righthandLickAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $recipeLog = []&gt;&gt;\n\t&lt;&lt;set $recipeLog.push(&quot;lickHand&quot;)&gt;&gt;</div><div tiddler="righthandSqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $limeParent != &quot;righthand&quot;&gt;&gt;\n\t\tТы собираешься выдавить всю дольку себе на &lt;&lt;object &quot;правую руку&quot; &quot;righthand&quot;&gt;&gt;, но вспоминаешь, что это совсем другой рецепт.\n\t&lt;&lt;else&gt;&gt;\n\t\tТы собираешься выдавить всю дольку себе на &lt;&lt;object &quot;правую руку&quot; &quot;righthand&quot;&gt;&gt;, но вспоминаешь, что, во-первых, держишь лайм в этой же руке, а во-вторых, что это совсем другой рецепт.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="righthandSqueezeLimeAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;unset $righthandLimed&gt;&gt;\n\n\n/%\n\t\t                            ##                   \n\t\t  #####  ######   #####  ##   ## ##   ##  ####   \n\t\t ##        ##    ##   ## ##  ### ##  ##      ##  \n\t\t ##        ##    ##   ## ## # ## #####    #####  \n\t\t ##        ##    ##   ## ###  ## ##  ##  ##  ##  \n\t\t  #####    ##     #####  ##   ## ##   ##  ###### \n%/</div><div tiddler="counterInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $counterChildren = [&quot;plate&quot;, &quot;salter&quot;, &quot;shot&quot;]&gt;&gt;\n\t&lt;&lt;set $counterName = &quot;барная стойка&quot;&gt;&gt;\n\t&lt;&lt;set $counterNameG = &quot;барную стойку&quot;&gt;&gt;\n\t&lt;&lt;unset $counterDisabled $counterSalted $counterLimed&gt;&gt;</div><div tiddler="counterDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Лакированная деревянная поверхность, покрытая патиной от многолетних прикосновений, ударов, разлитий.&lt;&lt;if $counterSalted&gt;&gt; С рассыпанной повсюду солью&lt;&lt;if $counterLimed&gt;&gt;, тающей в лужицах лаймового сока&lt;&lt;/if&gt;&gt;.&lt;&lt;/if&gt;&gt;&lt;&lt;if !$counterSalted &amp;&amp; $counterLimed&gt;&gt; С лужицами сока лайма повсюду.&lt;&lt;/if&gt;&gt;</div><div tiddler="counterInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">На &lt;&lt;object &quot;барной стойке&quot; &quot;counter&quot;&gt;&gt; перед тобой &lt;&lt;print ($counterChildren.length == 1 ? &quot;стоит&quot; : &quot;стоят&quot;)&gt;&gt;\n\t&lt;&lt;for $i = 0; $i &lt; $counterChildren.length; $i++&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;display &quot;+$counterChildren[$i]+&quot;Inv&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;if $i &lt; $counterChildren.length-2&gt;&gt;\n\t\t\t&lt;&lt;print &quot;, &quot;&gt;&gt;\n\t\t&lt;&lt;elseif $i &lt; $counterChildren.length-1&gt;&gt;\n\t\t\t&lt;&lt;print &quot; и &quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/for&gt;&gt;\n\t.</div><div tiddler="counterSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты рассыпаешь соль по всей поверхности &lt;&lt;object &quot;стойки&quot; &quot;counter&quot;&gt;&gt;, до которой можешь дотянуться.</div><div tiddler="counterLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты сдавливаешь лайм в пальцах и водишь рукой над &lt;&lt;object &quot;стойкой&quot; &quot;counter&quot;&gt;&gt;, разбрызгивая повсюду сок.</div><div tiddler="counterSqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты сдавливаешь лайм в пальцах и водишь рукой над &lt;&lt;object &quot;стойкой&quot; &quot;counter&quot;&gt;&gt;, разбрызгивая повсюду сок.</div><div tiddler="counterSqueezeLimeAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $limeSqueezed = true&gt;&gt;\n\n\n/%\n\t\t ######   ####   ######   #####    ##### ##   ##  ####   \n\t\t   ##        ##  ##   ## ##   ##  ##  ## ##  ##      ##  \n\t\t   ##     #####  ######  ######   ##  ## #####    #####  \n\t\t   ##    ##  ##  ##      ##       ##  ## ##  ##  ##  ##  \n\t\t   ##     ###### ##       #####  ##   ## ##   ##  ######\n%/</div><div tiddler="plateInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $plateChildren = [&quot;lime&quot;]&gt;&gt;\n\t&lt;&lt;set $plateName = &quot;тарелка&quot;&gt;&gt;\n\t&lt;&lt;set $plateNameG = &quot;тарелку&quot;&gt;&gt;\n\t&lt;&lt;set $plateParent = &quot;counter&quot;&gt;&gt;\n\t&lt;&lt;unset $plateDisabled $plateSalted&gt;&gt;\n\t&lt;&lt;set $plateLimed = 1&gt;&gt;</div><div tiddler="plateDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Неглубокая белая тарелка, мокрая от сока &lt;&lt;object &quot;лайма&quot; &quot;lime&quot;&gt;&gt;&lt;&lt;print ($plateSalted ? &quot;, в котором растворяются кристаллики соли&quot; : &quot;&quot;)&gt;&gt;.</div><div tiddler="plateInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $plateChildren.contains(&quot;lime&quot;)&gt;&gt;\n\t\t&lt;&lt;object &quot;тарелка&quot; &quot;plate&quot;&gt;&gt; с одним кусочком &lt;&lt;object &quot;лайма&quot; &quot;lime&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\tпустая &lt;&lt;object &quot;тарелка&quot; &quot;plate&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="plateSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты, прищурившись, рассыпаешь соль по всей &lt;&lt;object &quot;тарелке&quot; &quot;plate&quot;&gt;&gt;\n\t&lt;&lt;if $plateChildren.contains(&quot;lime&quot;)&gt;&gt;\n\t\t и по лежащему на ней &lt;&lt;object &quot;лайму&quot; &quot;lime&quot;&gt;&gt;\n\t\t&lt;&lt;set $limeSalted = 1&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t.</div><div tiddler="plateLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты собираешься было поводить лаймом по &lt;&lt;object &quot;тарелке&quot; &quot;plate&quot;&gt;&gt;, но замечаешь, что она и так вся мокрая.</div><div tiddler="plateSqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты собираешься было надавить лаймового сока в &lt;&lt;object &quot;тарелку&quot; &quot;plate&quot;&gt;&gt;, но замечаешь, что она и так вся в нём.\n\n\n/%\n\t\t                    ##           \n\t\t   #####  ####   ##   ## ##   ## \n\t\t  ##  ##     ##  ##  ### ### ### \n\t\t  ##  ##  #####  ## # ## ## # ## \n\t\t  ##  ## ##  ##  ###  ## ##   ## \n\t\t ##   ##  ###### ##   ## ##   ## \n%/</div><div tiddler="limeInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $limeChildren = []&gt;&gt;\n\t&lt;&lt;set $limeName = &quot;кусочек лайма&quot;&gt;&gt;\n\t&lt;&lt;set $limeNameG = &quot;кусочек лайма&quot;&gt;&gt;\n\t&lt;&lt;set $limeParent = &quot;plate&quot;&gt;&gt;\n\t&lt;&lt;unset $limeDisabled $limeSalted $limeSqueezed&gt;&gt;</div><div tiddler="limeDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if !$limeSqueezed&gt;&gt;\n\t\tАккуратно отрезанная долька лайма. Его зелёная кожура поблёскивает в свете ламп. &lt;&lt;print ($limeSalted ? &quot;Зачем-то посолен.&quot; : &quot;&quot;)&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\tВыжатая, ни на что не годная долька лайма.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="limeInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if !$limeSqueezed&gt;&gt;\n\t\tкусочек &lt;&lt;object &quot;лайма&quot; &quot;lime&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\tвыжатый &lt;&lt;object &quot;лайм&quot; &quot;lime&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="limeAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $limeParent != &quot;lefthand&quot; and $limeParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;Take &quot;lime&quot;&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;if $recipe == &quot;BasicRecipe&quot;&gt;&gt;\n\t\t\t&lt;&lt;NoActVerb &quot;lime&quot; &quot;Съесть кусочек лайма&quot; &quot;limeEatFail&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if $recipe == &quot;BasicRecipe&quot;&gt;&gt;\n\t\t\t&lt;&lt;Eat &quot;lime&quot;&gt;&gt;&lt;br&gt;\n\t\t\t&lt;&lt;LimeSmthng&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;elseif !$limeSqueezed&gt;&gt;\n\t\t\t&lt;&lt;SqueezeLimeOnSmthng&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;RemoveVerb &quot;lime&quot; &quot;Попросить новый лайм&quot; &quot;limeChange&quot;&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;PutOn &quot;lime&quot; &quot;plate&quot; &quot;вернуть&quot; &quot;на&quot;&gt;&gt;\n\t\t&lt;&lt;if $recipe == &quot;BasicRecipe&quot;&gt;&gt;\n\t\t\t&lt;br&gt;\n\t\t\t&lt;&lt;ChangeHands &quot;lime&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="limeEatFail" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Наклонившись над тарелкой, ты пытаешься зацепить дольку лайма одними губами и языком. Не выходит.</div><div tiddler="limeEat" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты отправляешь лайм в рот и, жмурясь, пережёвываешь его.</div><div tiddler="limeEatAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $recipeLog.push(&quot;eatLime&quot;)&gt;&gt;</div><div tiddler="limeSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты аккуратно сыпешь несколько крупинок соли на &lt;&lt;object &quot;лайм&quot; &quot;lime&quot;&gt;&gt;.</div><div tiddler="limeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты крепко задумываешься на несколько секунд.</div><div tiddler="limeSqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты крепко задумываешься на несколько секунд.</div><div tiddler="limeChange" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты подзываешь бармена и просишь новую дольку лайма взамен выжатой. Тот кивает, забирает старый лайм и уходит.\n\n/%\n\t\t  #####   #####    #####  #####  ##   ## ##   ##  ####   \n\t\t ##      ##   ##  ##  ## ##   ## ##   ## ##  ##      ##  \n\t\t ##      ##   ##  ##  ## ##   ## ####### #####    #####  \n\t\t ##      ##   ##  ##  ## ##   ## ##   ## ##  ##  ##  ##  \n\t\t  #####   #####  ##   ##  #####  ##   ## ##   ##  ######\n%/</div><div tiddler="salterInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $salterChildren = []&gt;&gt;\n\t&lt;&lt;set $salterName = &quot;солонка&quot;&gt;&gt;\n\t&lt;&lt;set $salterNameG = &quot;солонку&quot;&gt;&gt;\n\t&lt;&lt;set $salterParent = &quot;counter&quot;&gt;&gt;\n\t&lt;&lt;unset $salterDisabled $salterLimed&gt;&gt;</div><div tiddler="salterDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Белая керамическая солонка со множеством дырочек наверху и названием бара сбоку: «GIN &amp; JAZZ».&lt;&lt;print ($salterLimed ? &quot; Дырочки, кстати, намертво забиты мокрой солью.&quot; : &quot;&quot;)&gt;&gt;</div><div tiddler="salterInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;object &quot;солонка&quot; &quot;salter&quot;&gt;&gt;</div><div tiddler="salterAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $salterParent != &quot;lefthand&quot; and $salterParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;Take &quot;salter&quot;&gt;&gt;\n\t\t&lt;&lt;if $salterLimed&gt;&gt;\n\t\t\t&lt;br&gt;\n\t\t\t&lt;&lt;RemoveVerb &quot;salter&quot; &quot;Попросить поменять солонку&quot; &quot;salterChange&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if $salterLimed&gt;&gt;\n\t\t\t&lt;&lt;NoActVerb &quot;slater&quot; &quot;Посолить что-нибудь&quot; &quot;salterSaltFail&quot;&gt;&gt;&lt;br&gt;\n\t\t\t&lt;&lt;RemoveVerb &quot;salter&quot; &quot;Попросить поменять солонку&quot; &quot;salterChange&quot;&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;SaltSmthng&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;PutOn &quot;salter&quot; &quot;поставить&quot;&gt;&gt;\n\t\t&lt;&lt;if $recipe == &quot;BasicRecipe&quot;&gt;&gt;\n\t\t\t&lt;br&gt;\n\t\t\t&lt;&lt;ChangeHands &quot;salter&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="salterPutOnCounter" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты ставишь солонку на &lt;&lt;object &quot;стойку&quot; &quot;counter&quot;&gt;&gt;.</div><div tiddler="salterSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты крепко задумываешься на несколько секунд.</div><div tiddler="salterLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты самозабвенно размазываешь сок лайма по всей &lt;&lt;object &quot;солонке&quot; &quot;salter&quot;&gt;&gt; и не сразу замечаешь, что он попал в отверстия, из которых должна сыпаться соль. Ой.</div><div tiddler="salterSqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты давишь и давишь дольку лайма над &lt;&lt;object &quot;солонкой&quot; &quot;salter&quot;&gt;&gt; и не сразу замечаешь, что сок попал в отверстия, из которых должна сыпаться соль. Ой.</div><div tiddler="salterSqueezeLimeAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $limeSqueezed = true&gt;&gt;</div><div tiddler="salterChange" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты подзываешь бармена и как можно более обтекаемо описываешь проблему с солонкой. Он понимающе кивает, забирает испорченную солонку и уходит за новой.</div><div tiddler="salterSaltFail" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты собираешься было что-нибудь посолить, но вспоминаешь, что все дырочки на солонке заклеились соком лайма.\n\n\n/%\n\t\t  #####  ######   #####  ######  ##   ##  ####   \n\t\t ##        ##    ##   ## ##   ## ##  ##      ##  \n\t\t ##        ##    ##   ## ##   ## #####    #####  \n\t\t ##        ##    ##   ## ##   ## ##  ##  ##  ##  \n\t\t  #####    ##     #####  ##   ## ##   ##  ###### \n%/</div><div tiddler="shotInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $shotChildren = [&quot;tequila&quot;]&gt;&gt;\n\t&lt;&lt;set $shotName = &quot;стопка&quot;&gt;&gt;\n\t&lt;&lt;set $shotNameG = &quot;стопку&quot;&gt;&gt;\n\t&lt;&lt;set $shotParent = &quot;counter&quot;&gt;&gt;\n\t&lt;&lt;unset $shotDisabled $shotSalted $shotLimed&gt;&gt;</div><div tiddler="shotDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Стеклянный полый цилиндр с толстым дном\n\t&lt;&lt;if $shotChildren.contains(&quot;tequila&quot;)&gt;&gt;\n\t\t, наполненный прозрачной &lt;&lt;object &quot;текилой&quot; &quot;tequila&quot;&gt;&gt;.\n\t&lt;&lt;else&gt;&gt;\n\t\t. Пустой.\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print ($tequilaSalted ? &quot; На дне видны несколько медленно растворяющихся кристалликов соли.&quot; : &quot;&quot;)&gt;&gt;</div><div tiddler="shotInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $shotChildren.contains(&quot;tequila&quot;)&gt;&gt;\n\t\t&lt;&lt;object &quot;стопка&quot; &quot;shot&quot;&gt;&gt; с &lt;&lt;object &quot;текилой&quot; &quot;tequila&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\tпустая пятидесятиграммовая &lt;&lt;object &quot;стопка&quot; &quot;shot&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="shotAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $shotParent != &quot;lefthand&quot; and $shotParent != &quot;righthand&quot; &amp;&amp; $shotParent == &quot;counter&quot;&gt;&gt;\n\t\t&lt;&lt;Take &quot;shot&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if $highballBeer &gt; 0 &amp;&amp; $shotChildren[0]&gt;&gt;\n\t\t\t&lt;&lt;PutOn &quot;shot&quot; &quot;highball&quot; &quot;опустить&quot; &quot;в&quot;&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if $shotChildren[0]&gt;&gt;\n\t\t\t&lt;&lt;Drink &quot;tequila&quot;&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;PutOn &quot;shot&quot; &quot;counter&quot; &quot;поставить&quot; &quot;на&quot;&gt;&gt;\n\t\t&lt;&lt;if $recipe == &quot;BasicRecipe&quot;&gt;&gt;\n\t\t\t&lt;br&gt;\n\t\t\t&lt;&lt;ChangeHands &quot;shot&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="shotPutOnCounter" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты со стуком ставишь стопку на &lt;&lt;object &quot;стойку&quot; &quot;counter&quot;&gt;&gt;.</div><div tiddler="shotPutOnHighball" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $highballBeer &lt; 3&gt;&gt;\n\t\tТы отпускаешь стопку с текилой в &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;, но так как &lt;&lt;object &quot;пива&quot; &quot;beer&quot;&gt;&gt; в стакане недостаточно, стопка не опускается, а падает и расплёскивается, смешав напитки и испортив весь коктейль.\n\t\t&lt;&lt;set $highballBeer++&gt;&gt;\n\t&lt;&lt;elseif $highballBeer == 3&gt;&gt;\n\t\tТы отпускаешь стопку с текилой в &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt; и она аккуратно спускается на дно. Вспенившееся &lt;&lt;object &quot;пиво&quot; &quot;beer&quot;&gt;&gt; поднимается до края стакана, но не выше. Можно пить.\n\t\t&lt;&lt;set $highballBeer++&gt;&gt;\n\t&lt;&lt;elseif $highballBeer == 4&gt;&gt;\n\t\tТы отпускаешь стопку с текилой в &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;, но так как тот был полон, вспенившееся &lt;&lt;object &quot;пиво&quot; &quot;beer&quot;&gt;&gt; резко поднимается и выплёскивается через край, заливая стойку вокруг. Ты безуспешно пытаешься сдержать растекание пивной лужи кипой салфеток, пока на помощь не приходит бармен. Коктейль, очевидно, испорчен.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="shotPutOnHighballAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;moveobj &quot;shot&quot; &quot;highball&quot;&gt;&gt;\n\t&lt;&lt;set $shotDisabled = 1&gt;&gt;\n\t&lt;&lt;if $highballBeer &lt; 3&gt;&gt;\n\t\t&lt;&lt;set $DepthChargeCondition = -1&gt;&gt;\n\t&lt;&lt;elseif $highballBeer &gt; 3&gt;&gt;\n\t\t&lt;&lt;set $DepthChargeCondition = 1&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;unset $DepthChargeCondition&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="shotSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $shotChildren[0]&gt;&gt;\n\t\t&lt;&lt;display &quot;tequilaSalt&quot;&gt;&gt;\n\t\t&lt;&lt;set $tequilaSalted = 1&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\tТы сыпешь немного соли в пустую &lt;&lt;object &quot;стопку&quot; &quot;shot&quot;&gt;&gt;.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="shotLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты задумчиво поводишь лаймом по кромке &lt;&lt;object &quot;стопки&quot; &quot;shot&quot;&gt;&gt;.</div><div tiddler="shotSqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;display &quot;tequilaSqueezeLime&quot;&gt;&gt;</div><div tiddler="shotSqueezeLimeAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $limeSqueezed = true&gt;&gt;\n\n\n/%\n\t\t ######   #####  ##   ## ##   ##   #####  ####   \n\t\t   ##    ##   ## ##  ##  ##  ###  ##  ##     ##  \n\t\t   ##    ######  #####   ## # ##  ##  ##  #####  \n\t\t   ##    ##      ##  ##  ###  ##  ##  ## ##  ##  \n\t\t   ##     #####  ##   ## ##   ## ##   ##  ###### \n%/</div><div tiddler="tequilaInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $tequilaChildren = []&gt;&gt;\n\t&lt;&lt;set $tequilaName = &quot;текила&quot;&gt;&gt;\n\t&lt;&lt;set $tequilaNameG = &quot;текилу&quot;&gt;&gt;\n\t&lt;&lt;set $tequilaParent = &quot;shot&quot;&gt;&gt;\n\t&lt;&lt;unset $tequilaDisabled $tequilaSalted $tequilaLimed&gt;&gt;</div><div tiddler="tequilaDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Прозрачная маслянистая жидкость. Её поверхность красиво отражает свет ламп над стойкой.</div><div tiddler="tequilaInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;object &quot;текила&quot; &quot;tequila&quot;&gt;&gt;</div><div tiddler="tequilaAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $shotParent != &quot;lefthand&quot; and $shotParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;NoActVerb &quot;tequila&quot; &quot;Выпить текилу&quot; &quot;tequilaDrinkFail&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;Drink &quot;tequila&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="tequilaDrinkFail" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты вытягиваешь губы в трубочку и пытаешься высосать текилу из стоящей на стойке &lt;&lt;object &quot;стопки&quot; &quot;shot&quot;&gt;&gt;. Хм. Без рук не получается.</div><div tiddler="tequilaDrink" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты прикладываешь стопку к губам, запрокидываешь голову и, щурясь на яркие лампы, проглатываешь маслянистую жидкость.</div><div tiddler="tequilaDrinkAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $drunkness += 10&gt;&gt;\n\t&lt;&lt;set $minute += 20&gt;&gt;\n\t&lt;&lt;set $recipeLog.push(&quot;drinkTequila&quot;)&gt;&gt;\n\t&lt;&lt;removeobj &quot;tequila&quot;&gt;&gt;</div><div tiddler="tequilaSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $shotParent == &quot;counter&quot;&gt;&gt;\n\t\tТы сыпешь в &lt;&lt;object &quot;текилу&quot; &quot;tequila&quot;&gt;&gt; соль и, оперевшись подбородком на &lt;&lt;object &quot;стойку&quot; &quot;counter&quot;&gt;&gt;, заворожённо наблюдаешь, как крохотные кристаллики медленно опускаются на дно &lt;&lt;object &quot;стопки&quot; &quot;shot&quot;&gt;&gt;.\n\t&lt;&lt;elseif $shotParent == &quot;lefthand&quot; or $shotParent == &quot;righthand&quot;&gt;&gt;\n\t\tТы сыпешь в &lt;&lt;object &quot;текилу&quot; &quot;tequila&quot;&gt;&gt; соль и, подняв &lt;&lt;object &quot;стопку&quot; &quot;shot&quot;&gt;&gt; к свету, заворожённо наблюдаешь, как крохотные кристаллики медленно опускаются на дно.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="tequilaLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты выдавливаешь пару капель лаймового сока в &lt;&lt;object &quot;текилу&quot; &quot;tequila&quot;&gt;&gt;, пока бармен не видит. Ну и что, что в рецепте коктейля этого не было, правда?</div><div tiddler="tequilaSqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты выдавливаешь всю лаймовую дольку в &lt;&lt;object &quot;текилу&quot; &quot;tequila&quot;&gt;&gt;, пока бармен не видит. Ну и что, что в рецепте коктейля этого не было, правда?</div><div tiddler="tequilaSqueezeLimeAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $limeSqueezed = true&gt;&gt;\n\n\n/%\n\t\t    ##                                                  \n\t\t ####   ##   ## ######  ##   ##   ##### ##   ##  ####   \n\t\t##      ##   ##   ##    ##   ##  ##  ## ##  ##      ##  \n\t\t######  ##   ##   ##    ####  #  ##  ## #####    #####  \n\t\t##   ##  ######   ##    ##  # #  ##  ## ##  ##  ##  ##  \n\t\t #####       ##   ##    ####  # ##   ## ##   ##  ###### \n\t\t         ##### \n%/</div><div tiddler="bottleInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $bottleChildren = []&gt;&gt;\n\t&lt;&lt;set $bottleName = &quot;бутылка&quot;&gt;&gt;\n\t&lt;&lt;set $bottleNameG = &quot;бутылку&quot;&gt;&gt;\n\t&lt;&lt;set $bottleParent = &quot;counter&quot;&gt;&gt;\n\t&lt;&lt;unset $bottleDisabled $bottlePouring&gt;&gt;\n\t&lt;&lt;set $bottleBeer = 4&gt;&gt;</div><div tiddler="bottleDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Пивная бутылка из тёмно-коричневого стекла. На этикетке название, написанное неразборчивым готическим шрифтом, и надписи на французском.&lt;br&gt;\n\t&lt;&lt;if $bottleBeer == 4&gt;&gt;\n\t\tБутылка полная.\n\t&lt;&lt;elseif $bottleBeer == 3&gt;&gt;\n\t\tВ бутылке пива на три четверти.\n\t&lt;&lt;elseif $bottleBeer == 2&gt;&gt;\n\t\tБутылка заполнена наполовину.\n\t&lt;&lt;elseif $bottleBeer == 1&gt;&gt;\n\t\tПива в бутылке на дне.\n\t&lt;&lt;else&gt;&gt;\n\t\tБутылка пуста.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="bottleInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $bottleBeer &gt; 0&gt;&gt;\n\t\tоткрытая &lt;&lt;object &quot;бутылка&quot; &quot;bottle&quot;&gt;&gt; пива\n\t&lt;&lt;else&gt;&gt;\n\t\tпустая пивная &lt;&lt;object &quot;бутылка&quot; &quot;bottle&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="bottleAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $bottleParent != &quot;lefthand&quot; and $bottleParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;Take &quot;bottle&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if $bottleBeer &gt; 0&gt;&gt;\n\t\t\t&lt;&lt;if !$bottlePouring&gt;&gt;\n\t\t\t\t&lt;&lt;if $highballBeer &lt; 4 &amp;&amp; !$highballChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\t\t\t\t&lt;&lt;ActVerb &quot;beer&quot; &quot;Наливать пиво в стакан&quot; &quot;bottlePourBeer&quot;&gt;&gt;&lt;br&gt;\n\t\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\t\t&lt;&lt;NoActVerb &quot;beer&quot; &quot;Наливать пиво в стакан&quot; &quot;bottlePourBeerFail&quot;&gt;&gt;&lt;br&gt;\n\t\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\t&lt;&lt;ActVerb &quot;beer&quot; &quot;Продолжать наливать пиво в стакан&quot; &quot;bottlePourContinue&quot;&gt;&gt;&lt;br&gt;\n\t\t\t\t&lt;&lt;ActVerb &quot;beer&quot; &quot;Прекратить наливать пиво в стакан&quot; &quot;bottlePourStop&quot;&gt;&gt;&lt;br&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t\t&lt;&lt;NoActVerb &quot;beer&quot; &quot;Пить из бутылки&quot; &quot;bottleDrinkFail&quot;&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;PutOn &quot;bottle&quot; &quot;поставить&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="bottlePutOnCounter" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты ставишь бутылку на &lt;&lt;object &quot;стойку&quot; &quot;counter&quot;&gt;&gt;.</div><div tiddler="bottleDrinkFail" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты принюхиваешься и уже было собираешься сделать глоток, но потом передумываешь — ты всё-таки в баре, из бутылок здесь пить не принято.</div><div tiddler="bottlePourBeerFail" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $highballChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\tСейчас внутри &lt;&lt;object &quot;стакана&quot; &quot;highball&quot;&gt;&gt; стоит стопка &lt;&lt;print ($shotChildren.contains(&quot;tequila&quot;) ? &quot;&quot; : &quot;из-под &quot;)&gt;&gt;текилы. Наливать в него пиво нет смысла.\n\t&lt;&lt;elseif $highballBeer = 4&gt;&gt;\n\t\tТы собираешься было долить пива в &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;, но тот уже полон.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="bottlePourBeer" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $bottleBeer &gt; 0&gt;&gt;\n\t\tТы подносишь бутылку к &lt;&lt;object &quot;стакану&quot; &quot;highball&quot;&gt;&gt; и начинаешь наливать &lt;&lt;object &quot;пиво&quot; &quot;beer&quot;&gt;&gt;\n\t\t&lt;&lt;if $highballParent == &quot;lefthand&quot; or $highballParent == &quot;righthand&quot;&gt;&gt;\n\t\t\t, одновременно наклоняя хайболл, чтобы не образовалось слишком много пены.\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t, глядя на поднимающуюся шапку пены.\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\tТы выливаешь остатки &lt;&lt;object &quot;пива&quot; &quot;beer&quot;&gt;&gt; из бутылки в &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="bottlePourBeerAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;moveobj &quot;beer&quot; &quot;highball&quot;&gt;&gt;\n\t&lt;&lt;set $bottlePouring = 1&gt;&gt;\n\t&lt;&lt;set $bottleBeer--&gt;&gt;\n\t&lt;&lt;set $highballBeer++&gt;&gt;</div><div tiddler="bottlePourContinue" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $highballBeer &gt; 4&gt;&gt;\n\t\tОтвлекшись, ты не замечаешь, что продолжаешь лить &lt;&lt;object &quot;пиво&quot; &quot;beer&quot;&gt;&gt; в уже полный &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;. На данное обстоятельство твоё внимание обращает приятель, вдруг прооравший что-то нецензурное. Некоторое время до прихода бармена ты сражаешься с расплывающейся пивной лужей кипой салфеток, пока тот не вытирает &lt;&lt;object &quot;стойку&quot; &quot;counter&quot;&gt;&gt;.\n\t\t&lt;&lt;set $highballBeer = 4&gt;&gt;\n\t&lt;&lt;elseif $bottleBeer &gt; 0&gt;&gt;\n\t\tТы &lt;&lt;print ($bottleBeer == 1 ? &quot;всё &quot; : &quot;&quot;)&gt;&gt;продолжаешь лить &lt;&lt;object &quot;пиво&quot; &quot;beer&quot;&gt;&gt; в &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;.\n\t&lt;&lt;else&gt;&gt;\n\t\tТы выливаешь остатки &lt;&lt;object &quot;пива&quot; &quot;beer&quot;&gt;&gt; из бутылки в &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="bottlePourContinueAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $bottleBeer--&gt;&gt;\n\t&lt;&lt;set $highballBeer++&gt;&gt;\n\t&lt;&lt;if $bottleBeer == 0&gt;&gt;\n\t\t&lt;&lt;unset $bottlePouring&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if $highballBeer &gt; 4&gt;&gt;\n\t\t&lt;&lt;unset $bottlePouring&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="bottlePourStop" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты останавливаешься, когда \n\t&lt;&lt;if $highballBeer == 4&gt;&gt;\n\t\t&lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt; полностью наполняется.\n\t&lt;&lt;elseif $highballBeer == 3&gt;&gt;\n\t\tв &lt;&lt;object &quot;стакане&quot; &quot;highball&quot;&gt;&gt; налито три четверти &lt;&lt;object &quot;пива&quot; &quot;beer&quot;&gt;&gt;.\n\t&lt;&lt;elseif $highballBeer == 2&gt;&gt;\n\t\tв &lt;&lt;object &quot;стакане&quot; &quot;highball&quot;&gt;&gt; налита половина &lt;&lt;object &quot;пива&quot; &quot;beer&quot;&gt;&gt;.\n\t&lt;&lt;elseif $highballBeer == 1&gt;&gt;\n\t\tв &lt;&lt;object &quot;стакане&quot; &quot;highball&quot;&gt;&gt; налита четверть &lt;&lt;object &quot;пива&quot; &quot;beer&quot;&gt;&gt;.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="bottlePourStopAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;unset $bottlePouring&gt;&gt;\n\n\n/%\n\t\t  #####  ######   ####   ##   ##  ####   ##   ## \n\t\t ##        ##        ##  ##  ##      ##  ##   ## \n\t\t ##        ##     #####  #####    #####  ####### \n\t\t ##        ##    ##  ##  ##  ##  ##  ##  ##   ## \n\t\t  #####    ##     ###### ##   ##  ###### ##   ##\n%/</div><div tiddler="highballInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $highballChildren = []&gt;&gt;\n\t&lt;&lt;set $highballName = &quot;стакан&quot;&gt;&gt;\n\t&lt;&lt;set $highballNameG = &quot;стакан&quot;&gt;&gt;\n\t&lt;&lt;set $highballParent = &quot;counter&quot;&gt;&gt;\n\t&lt;&lt;unset $highballDisabled&gt;&gt;\n\t&lt;&lt;set $highballBeer = 0&gt;&gt;</div><div tiddler="highballDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Высокий стакан-хайболл \n\t&lt;&lt;if $highballBeer == 4&gt;&gt;\n\t\t, доверху наполненный светлым &lt;&lt;object &quot;пивом&quot; &quot;beer&quot;&gt;&gt;.\n\t&lt;&lt;elseif $highballBeer == 3&gt;&gt;\n\t\t, на три четверти наполненный светлым &lt;&lt;object &quot;пивом&quot; &quot;beer&quot;&gt;&gt;.\n\t&lt;&lt;elseif $highballBeer == 2&gt;&gt;\n\t\t, наполненный наполовину светлым &lt;&lt;object &quot;пивом&quot; &quot;beer&quot;&gt;&gt;.\n\t&lt;&lt;elseif $highballBeer == 1&gt;&gt;\n\t\t, на четверть наполненный светлым &lt;&lt;object &quot;пивом&quot; &quot;beer&quot;&gt;&gt;.\n\t&lt;&lt;else&gt;&gt;\n\t\t. Пустой.\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if $highballChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\t&lt;&lt;if $shotChildren.contains(&quot;tequila&quot;)&gt;&gt;\n\t\t\tВнутри стакана стоит стопка с текилой.\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\tВнутри стоит стопка из-под текилы.\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="highballInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $highballChildren.contains(&quot;beer&quot;)&gt;&gt;\n\t\t&lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt; с &lt;&lt;object &quot;пивом&quot; &quot;beer&quot;&gt;&gt;&lt;&lt;print ($highballChildren.contains(&quot;shot&quot;) ? &quot; и со стопкой текилы внутри&quot; : &quot;&quot;)&gt;&gt;\n\t&lt;&lt;elseif $highballChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\t&lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt; с пустой стопкой внутри\n\t&lt;&lt;else&gt;&gt;\n\t\tпустой &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="highballAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $highballParent != &quot;lefthand&quot; and $highballParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;Take &quot;highball&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if $highballChildren.contains(&quot;beer&quot;)&gt;&gt;\n\t\t\t&lt;&lt;if !$beerDrinking&gt;&gt;\n\t\t\t\t&lt;&lt;Drink &quot;beer&quot; &quot;начать пить&quot;&gt;&gt;\n\t\t\t\t&lt;br&gt;\n\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\t&lt;&lt;Drink &quot;beer&quot; &quot;продолжать пить&quot;&gt;&gt;\n\t\t\t\t&lt;br&gt;\n\t\t\t\t&lt;&lt;ActVerb &quot;beer&quot; &quot;Закончить пить пиво&quot; &quot;beerStopDrinking&quot;&gt;&gt;\n\t\t\t\t&lt;br&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;PutOn &quot;highball&quot; &quot;поставить&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="highballPutOnCounter" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты ставишь стакан на &lt;&lt;object &quot;стойку&quot; &quot;counter&quot;&gt;&gt;.\n\n\n/%\n\t\t ######  ##   ## #####    #####  \n\t\t ##   ## ##  ### ##  ##  ##   ## \n\t\t ##   ## ## # ## ######  ##   ## \n\t\t ##   ## ###  ## ##   ## ##   ## \n\t\t ##   ## ##   ## ######   ##### \n%/</div><div tiddler="beerInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $beerChildren = []&gt;&gt;\n\t&lt;&lt;set $beerName = &quot;пиво&quot;&gt;&gt;\n\t&lt;&lt;set $beerNameG = &quot;пиво&quot;&gt;&gt;\n\t&lt;&lt;set $beerParent = &quot;&quot;&gt;&gt;\n\t&lt;&lt;unset $beerDisabled $beerDrinking&gt;&gt;\n\t&lt;&lt;set $beerDrinkTimes = 0&gt;&gt;</div><div tiddler="beerDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Насыщенный свежий лагер с &lt;&lt;print ($beerDrinking ? &quot;отличным, чуть горьковатым вкусом&quot; : &quot;шапкой белой пены. Со дна поднимаются пузырьки газа&quot;)&gt;&gt;.&lt;&lt;print ($highballChildren.contains(&quot;shot&quot;) ? &quot; Внутри видна стопка.&quot; : &quot;&quot;)&gt;&gt;</div><div tiddler="beerInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;object &quot;пиво&quot; &quot;beer&quot;&gt;&gt;</div><div tiddler="beerAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $highballParent != &quot;lefthand&quot; and $highballParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;NoActVerb &quot;beer&quot; &quot;Пить пиво&quot; &quot;beerDrinkFail&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if !$beerDrinking&gt;&gt;\n\t\t\t&lt;&lt;Drink &quot;beer&quot; &quot;начать пить&quot;&gt;&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;Drink &quot;beer&quot; &quot;продолжать пить&quot;&gt;&gt;\n\t\t\t&lt;br&gt;\n\t\t\t&lt;&lt;ActVerb &quot;beer&quot; &quot;Закончить пить пиво&quot; &quot;beerStopDrinking&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="beerDrinkFail" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты пытаешься попить пива из стоящего на стойке &lt;&lt;object &quot;стакана&quot; &quot;highball&quot;&gt;&gt;, но\n\t&lt;&lt;if $highballBeer == 4&gt;&gt;\n\t\t лишь пачкаешь нос в пене.\n\t&lt;&lt;elseif $highballBeer == 3&gt;&gt;\n\t\t, как ни стараешься, не достаёшь — &lt;&lt;object &quot;стакана&quot; &quot;highball&quot;&gt;&gt; недостаточно полный.\n\t&lt;&lt;elseif $highballBeer == 2&gt;&gt;\n\t\t, как ни стараешься, не достаёшь — &lt;&lt;object &quot;стакана&quot; &quot;highball&quot;&gt;&gt; полупустой.\n\t&lt;&lt;elseif $highballBeer == 1&gt;&gt;\n\t\t, как ни стараешься, не достаёшь — пива в &lt;&lt;object &quot;стакане&quot; &quot;highball&quot;&gt;&gt; — на дне.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="beerDrink" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $highballBeer == 3&gt;&gt;\n\t\tТы прикладываешься к &lt;&lt;object &quot;стакану&quot; &quot;highball&quot;&gt;&gt; и начинаешь пить пиво большими глотками&lt;&lt;print ($highballChildren.contains(&quot;shot&quot;) ? &quot;, следя за стопкой внутри.&quot; : &quot;.&quot;)&gt;&gt;\n\t&lt;&lt;elseif $highballBeer == 2&gt;&gt;\n\t\t&lt;&lt;if $beerJustStarted&gt;&gt;\n\t\t\tТы прикладываешься к &lt;&lt;object &quot;стакану&quot; &quot;highball&quot;&gt;&gt; и пьёшь пиво, всё выше поднимая хайболл. Уровень пива уменьшается до половины стакана.\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\tТы продолжаешь пить пиво, всё выше поднимая &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;. Уровень пива уменьшается до половины стакана.&lt;&lt;print ($highballChildren.contains(&quot;shot&quot;) ? &quot; Стопка вот-вот сдвинется с места.&quot; : &quot;&quot;)&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;elseif $highballBeer == 1&gt;&gt;\n\t\t&lt;&lt;if $beerJustStarted&gt;&gt;\n\t\t\tТы прикладываешься к &lt;&lt;object &quot;стакану&quot; &quot;highball&quot;&gt;&gt; и в нём остаётся не больше четверти напитка.\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\tТы продолжаешь пить пиво, не останавливаясь. В &lt;&lt;object &quot;стакане&quot; &quot;highball&quot;&gt;&gt; остаётся не больше четверти напитка.\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;print ($highballChildren.contains(&quot;shot&quot;) ? &quot; Стопка медленно ползёт к краю стакана. Ты уже чувствуешь привкус текилы в пиве.&quot; : &quot;&quot;)&gt;&gt;\n\t&lt;&lt;elseif $highballBeer == 0&gt;&gt;\n\t\t&lt;&lt;if $beerJustStarted&gt;&gt;\n\t\t\t&lt;&lt;if $highballChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\t\t\tТы выдыхаешь и опрокидываешь &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;, забыв про стопку внутри. Она больно бьёт тебя по зубам и ты едва не разбрызгиваешь остатки пива. Мда, не вышло.\n\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\tТы выдыхаешь и опрокидываешь &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt;, допивая остатки пива.\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;if $highballChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\t\t\tТы, наконец, допиваешь остатки пива вперемешку с текилой — стопка легонько стукается о зубы — и, отняв &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt; ото рта, шумно выдыхаешь и вытираешь выступившие слёзы.\n\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\tТы, наконец, допиваешь остатки пива и, отняв &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt; ото рта, шумно выдыхаешь и вытираешь выступившие слёзы.\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="beerDrinkAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if !$beerDrinking == 1&gt;&gt;\n\t\t&lt;&lt;set $beerJustStarted = 1&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;unset $beerJustStarted&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;set $beerDrinking = 1&gt;&gt;\n\t&lt;&lt;set $minute += 5&gt;&gt;\n\t&lt;&lt;set $recipeLog.push(&quot;drinkBeer&quot;)&gt;&gt;\n\t&lt;&lt;set $beerDrinkTimes++&gt;&gt;\n\t&lt;&lt;if $beerDrinkTimes % 4 == 0&gt;&gt;\n\t\t&lt;&lt;set $drunkness += 10&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;set $highballBeer--&gt;&gt;\n\t&lt;&lt;if $highballBeer == 0&gt;&gt;\n\t\t&lt;&lt;removeobj &quot;beer&quot;&gt;&gt;\n\t\t&lt;&lt;if $highballChildren.contains(&quot;shot&quot;)&gt;&gt;\n\t\t\t&lt;&lt;if !$beerJustStarted &amp;&amp; !$DepthChargeCondition&gt;&gt;\n\t\t\t\t&lt;&lt;set $recipeLog[0] = &quot;done&quot;&gt;&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t\t&lt;&lt;removeobj &quot;tequila&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $drunkness += 10&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="beerStopDrinking" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты отнимаешь &lt;&lt;object &quot;стакан&quot; &quot;highball&quot;&gt;&gt; ото рта и выдыхаешь. В нём ещё остаётся &lt;&lt;if $highballBeer == 3&gt;&gt;три четверти&lt;&lt;elseif $highballBeer == 2&gt;&gt;половина&lt;&lt;elseif $highballBeer == 1&gt;&gt;четверть&lt;&lt;/if&gt;&gt; пива.</div><div tiddler="beerStopDrinkingAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;unset $beerDrinking&gt;&gt;\n\n\n/%\n\t\t                                                  #####  \n\t\t                                                 #     # \n\t\t  #####  ######   #####  ######  ##   ##  ####         # \n\t\t ##        ##    ##   ## ##   ## ##  ##      ##   #####  \n\t\t ##        ##    ##   ## ##   ## #####    #####  #       \n\t\t ##        ##    ##   ## ##   ## ##  ##  ##  ##  #       \n\t\t  #####    ##     #####  ##   ## ##   ##  ###### #######\n%/</div><div tiddler="shot2Init" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $shot2Children = []&gt;&gt;\n\t&lt;&lt;set $shot2Name = &quot;стопка для чейзера&quot;&gt;&gt;\n\t&lt;&lt;set $shot2NameG = &quot;стопку для чейзера&quot;&gt;&gt;\n\t&lt;&lt;set $shot2Parent = &quot;counter&quot;&gt;&gt;\n\t&lt;&lt;unset $shot2Disabled $shot2Limed $shot2Salted $shot2Ready&gt;&gt;\n\t&lt;&lt;set $shot2contents = {\n\t\thoney: 0,\n\t\tjuice: 0,\n\t\tlime: false,\n\t\tsalt: false,\n\t}&gt;&gt;</div><div tiddler="shot2Desc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Стеклянный полый цилиндр с толстым дном.\n\t&lt;&lt;if $shot2contents.honey || $shot2contents.juice || $shot2contents.lime || $shot2contents.salt&gt;&gt;\n\t\tВнутри: \n\t\t&lt;&lt;if $shot2contents.honey&gt;&gt;\n\t\t\t&lt;&lt;print $shot2contents.honey&gt;&gt; мл. медового сиропа\n\t\t\t&lt;&lt;if ($shot2contents.juice &amp;&amp; ($shot2contents.lime || $shot2contents.salt)) || ($shot2contents.lime &amp;&amp; $shot2contents.salt)&gt;&gt;\n\t\t\t\t, \n\t\t\t&lt;&lt;elseif $shot2contents.juice || $shot2contents.lime || $shot2contents.salt&gt;&gt;\n\t\t\t\t и \n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if $shot2contents.juice&gt;&gt;\n\t\t\t&lt;&lt;print $shot2contents.juice&gt;&gt; мл. грейпфрутового сока\n\t\t\t&lt;&lt;if $shot2contents.lime &amp;&amp; $shot2contents.salt&gt;&gt;\n\t\t\t\t, \n\t\t\t&lt;&lt;elseif $shot2contents.lime || $shot2contents.salt&gt;&gt;\n\t\t\t\t и \n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if $shot2contents.lime&gt;&gt;\n\t\t\tнемного сока лайма\n\t\t\t&lt;&lt;if $shot2contents.salt&gt;&gt;\n\t\t\t\t и \n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if $shot2contents.salt&gt;&gt;\n\t\t\tщепотка соли\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t.\n\t\t&lt;&lt;if $shot2contents.honey == 10 &amp;&amp; $shot2contents.juice == 30 &amp;&amp; $shot2contents.lime &amp;&amp; $shot2contents.salt&gt;&gt;\n\t\t\t Всё в точности по рецепту.\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;if $shot2contents.honey != 10 &amp;&amp; $shot2contents.juice != 30 &amp;&amp; ($shot2contents.honey + $shot2contents.juice &gt;= 40) &amp;&amp; $shot2contents.lime &amp;&amp; $shot2contents.salt&gt;&gt;\n\t\t\t Все ингридиенты Палома чейзера на месте, но пропорции рецепта не соблюдены. Придётся выпить то, что получилось, и начинать заново.\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t Пустой.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="shot2Inv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $shot2contents.honey || $shot2contents.juice || $shot2contents.lime || $shot2contents.salt&gt;&gt;\n\t\t&lt;&lt;object &quot;стопка&quot; &quot;shot2&quot;&gt;&gt; для чейзера\n\t&lt;&lt;else&gt;&gt;\n\t\tпустая &lt;&lt;object &quot;стопка&quot; &quot;shot2&quot;&gt;&gt; для чейзера\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="shot2Act" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $shot2Parent != &quot;lefthand&quot; and $shot2Parent != &quot;righthand&quot; &amp;&amp; $shot2Parent == &quot;counter&quot;&gt;&gt;\n\t\t&lt;&lt;Take &quot;shot2&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if $shot2contents.honey || $shot2contents.juice || $shot2contents.lime&gt;&gt;\n\t\t\t&lt;&lt;if $shot2Ready&gt;&gt;\n\t\t\t\t&lt;&lt;ActVerb &quot;shot2&quot; &quot;Выпить Палома чейзер&quot; &quot;shot2Drink&quot;&gt;&gt;&lt;br&gt;\n\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\t&lt;&lt;ActVerb &quot;shot2&quot; &quot;Выпить содержимое&quot; &quot;shot2Drink&quot;&gt;&gt;&lt;br&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;PutOn &quot;shot2&quot; &quot;counter&quot; &quot;поставить&quot; &quot;на&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="shot2PutOnCounter" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты со стуком ставишь стопку на &lt;&lt;object &quot;стойку&quot; &quot;counter&quot;&gt;&gt;.</div><div tiddler="shot2SqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты выдавливаешь всю лаймовую дольку в &lt;&lt;object &quot;стопку&quot; &quot;shot2&quot;&gt;&gt;.</div><div tiddler="shot2SqueezeLimeAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $limeSqueezed = true&gt;&gt;\n\t&lt;&lt;set $shot2contents.lime = true&gt;&gt;</div><div tiddler="shot2Salt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты сыпешь немного соли в &lt;&lt;object &quot;стопку&quot; &quot;shot2&quot;&gt;&gt; для чейзера.</div><div tiddler="shot2SaltAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $shot2contents.salt = true&gt;&gt;</div><div tiddler="shot2Drink" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $shot2Ready&gt;&gt;\n\t\tТы залпом выпиваешь Палома чейзер из стопки. Вкусно.\n\t&lt;&lt;else&gt;&gt;\n\t\tТы залпом выпиваешь из стопки то, что там вместо Палома чейзера.\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;set $shot2contents.honey = 0&gt;&gt;\n\t&lt;&lt;set $shot2contents.juice = 0&gt;&gt;\n\t&lt;&lt;set $shot2contents.lime = false&gt;&gt;\n\t&lt;&lt;set $shot2contents.salt = false&gt;&gt;</div><div tiddler="shot2DrinkAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $recipeLog[0] == &quot;drinkTequila&quot; &amp;&amp; $shot2Ready&gt;&gt;\n\t\t&lt;&lt;set $recipeLog[1] = &quot;drinkPaloma&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\n\n/%\n\t\t  #####  ##   ## ######   #####  ######  \n\t\t ##      ##  ### ##   ## ##   ## ##   ## \n\t\t ##      ## # ## ######  ##   ## ##   ## \n\t\t ##      ###  ## ##      ##   ## ##   ## \n\t\t  #####  ##   ## ##       #####  ##   ##\n%/</div><div tiddler="honeyInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $honeyChildren = []&gt;&gt;\n\t&lt;&lt;set $honeyName = &quot;бутылка сиропа&quot;&gt;&gt;\n\t&lt;&lt;set $honeyNameG = &quot;бутылку сиропа&quot;&gt;&gt;\n\t&lt;&lt;set $honeyParent = &quot;counter&quot;&gt;&gt;\n\t&lt;&lt;unset $honeyDisabled&gt;&gt;</div><div tiddler="honeyDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Стеклянная бутылка полная медового сиропа. На этикетке нарисована пчела и написано «Monin Miel».</div><div tiddler="honeyInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;object &quot;бутылка&quot; &quot;honey&quot;&gt;&gt; медового сиропа</div><div tiddler="honeyAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $honeyParent != &quot;lefthand&quot; and $honeyParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;Take &quot;honey&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if ($jiggerTurned &amp;&amp; $jiggerContents.honey + $jiggerContents.juice == 30) || (!$jiggerTurned &amp;&amp; $jiggerContents.honey + $jiggerContents.juice == 10)&gt;&gt;\n\t\t\t&lt;&lt;NoActVerb &quot;honey&quot; &quot;Налить сироп в джиггер&quot; &quot;honeyPourFail&quot;&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;ActVerb &quot;honey&quot; &quot;Налить сироп в джиггер&quot; &quot;honeyPour&quot;&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;PutOn &quot;honey&quot; &quot;поставить&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="honeyPutOnCounter" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты возвращаешь бутылку с сиропом на &lt;&lt;object &quot;стойку&quot; &quot;counter&quot;&gt;&gt;.</div><div tiddler="honeySqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Крышка бутылки закручена. Да и вообще, зачем тебе портить целую бутылку первоклассного медового сиропа? Тебе так интересно, что же автор там написал в ответ, или у этих вспышек вандализма нет никаких веских причин?  Тогда, может, пора задуматься?</div><div tiddler="honeySalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Крышка бутылки закручена. Да и вообще, зачем тебе портить целую бутылку первоклассного медового сиропа? Тебе так интересно, что же автор там написал в ответ, или у этих вспышек вандализма нет никаких веских причин?  Тогда, может, пора задуматься?</div><div tiddler="honeyPourFail" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты собираешься налить медового сиропа в &lt;&lt;object &quot;джиггер&quot; &quot;jigger&quot;&gt;&gt;, но тот уже полон.</div><div tiddler="honeyPour" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты доверху наполняешь &lt;&lt;object &quot;джиггер&quot; &quot;jigger&quot;&gt;&gt; медовым сиропом.</div><div tiddler="honeyPourAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $jiggerTurned&gt;&gt;\n\t\t&lt;&lt;set $jiggerContents.honey = 30&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $jiggerContents.honey = 10&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\n\n/%\n\t\t  #####   #####  ##   ## \n\t\t ##      ##   ## ##  ##  \n\t\t ##      ##   ## #####   \n\t\t ##      ##   ## ##  ##  \n\t\t  #####   #####  ##   ## \n%/</div><div tiddler="juiceInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $juiceChildren = []&gt;&gt;\n\t&lt;&lt;set $juiceName = &quot;коробка сока&quot;&gt;&gt;\n\t&lt;&lt;set $juiceNameG = &quot;коробку сока&quot;&gt;&gt;\n\t&lt;&lt;set $juiceParent = &quot;counter&quot;&gt;&gt;\n\t&lt;&lt;unset $juiceDisabled&gt;&gt;</div><div tiddler="juiceDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Вытянутая по высоте коробка грейпфрутового сока из тех марок, что рекламируют по телевизору.</div><div tiddler="juiceInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;object &quot;коробка&quot; &quot;juice&quot;&gt;&gt; грейпфрутового сока</div><div tiddler="juiceAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $juiceParent != &quot;lefthand&quot; and $juiceParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;Take &quot;juice&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if ($jiggerTurned &amp;&amp; $jiggerContents.honey + $jiggerContents.juice == 30) || (!$jiggerTurned &amp;&amp; $jiggerContents.honey + $jiggerContents.juice == 10)&gt;&gt;\n\t\t\t&lt;&lt;NoActVerb &quot;juice&quot; &quot;Налить сок в джиггер&quot; &quot;juicePourFail&quot;&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;ActVerb &quot;juice&quot; &quot;Налить сок в джиггер&quot; &quot;juicePour&quot;&gt;&gt;&lt;br&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;PutOn &quot;juice&quot; &quot;поставить&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="juicePutOnCounter" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты ставишь коробку с соком на &lt;&lt;object &quot;стойку&quot; &quot;counter&quot;&gt;&gt;.</div><div tiddler="juiceSqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Одной дольки лайма мало, чтобы хоть сколько-нибудь изменить вкус целой коробки грейпфрутового сока. Поэтому ты решаешь не выдавливать эту дольку.</div><div tiddler="juiceSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Тут всей солонки не хватит, чтобы хоть как-то изменить вкус целой коробки сока. Поэтому ты решаешь отказаться от своей идеи.</div><div tiddler="juicePourFail" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты собираешься налить грейпфрутового сока в &lt;&lt;object &quot;джиггер&quot; &quot;jigger&quot;&gt;&gt;, но тот уже полон.</div><div tiddler="juicePour" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты доверху наполняешь &lt;&lt;object &quot;джиггер&quot; &quot;jigger&quot;&gt;&gt; грейпфрутовым соком.</div><div tiddler="juicePourAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $jiggerTurned&gt;&gt;\n\t\t&lt;&lt;set $jiggerContents.juice = 30&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $jiggerContents.juice = 10&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\n\n/%\n\t\t   ####                                                  \n\t\t      ## ## # ## ##   ##  #####   #####   #####  ######  \n\t\t   #####  # # #  ##  ###      ##      ## ##   ## ##   ## \n\t\t  ##  ##   ###   ## # ##  #####   #####  ######  ######  \n\t\t ##   ##  # # #  ###  ## ##      ##      ##      ##      \n\t\t  #####  ## # ## ##   ##  ######  ######  #####  ##     \n%/</div><div tiddler="jiggerInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $jiggerChildren = []&gt;&gt;\n\t&lt;&lt;set $jiggerName = &quot;джиггер&quot;&gt;&gt;\n\t&lt;&lt;set $jiggerNameG = &quot;джиггер&quot;&gt;&gt;\n\t&lt;&lt;set $jiggerParent = &quot;counter&quot;&gt;&gt;\n\t&lt;&lt;unset $jiggerDisabled $jiggerTurned&gt;&gt;\n\t&lt;&lt;set $jiggerContents = {\n\t\thoney: 0,\n\t\tjuice: 0,\n\t\tlime: false,\n\t\tsalt: false,\n\t}&gt;&gt;</div><div tiddler="jiggerDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Двусторонний мерный стаканчик из нержавеющей стали. Объём верхней ёмкости &lt;&lt;print ($jiggerTurned ? &quot;30 мл., нижней 10 мл&quot; : &quot;10 мл., нижней 30 мл&quot;)&gt;&gt;.\n\t&lt;&lt;if $jiggerContents.honey || $jiggerContents.juice || $jiggerContents.lime&gt;&gt;\n\t\t В джиггер сейчас \n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if $jiggerContents.honey &amp;&amp; $jiggerContents.lime&gt;&gt;\n\t\tмедовый\tсироп и немного сока лайма\n\t&lt;&lt;elseif $jiggerContents.honey&gt;&gt;\n\t\tналит медовый сироп\n\t&lt;&lt;elseif $jiggerContents.juice &amp;&amp; $jiggerContents.lime&gt;&gt;\n\t\tгрейпрфутовый сок и немного сока лайма\n\t&lt;&lt;elseif $jiggerContents.juice&gt;&gt;\n\t\tналит грейпфрутовый сок\n\t&lt;&lt;elseif $jiggerContents.lime&gt;&gt;\n\t\tнемного сока лайма\n\t&lt;&lt;/if&gt;&gt;\n\t.</div><div tiddler="jiggerInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;object &quot;джиггер&quot; &quot;jigger&quot;&gt;&gt;</div><div tiddler="jiggerAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $jiggerParent != &quot;lefthand&quot; and $jiggerParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;Take &quot;jigger&quot;&gt;&gt;\n\t\t&lt;br&gt;\n\t\t&lt;&lt;ActVerb &quot;jigger&quot; &quot;Перевернуть джиггер&quot; &quot;jiggerTurn&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if $jiggerContents.honey || $jiggerContents.juice || $jiggerContents.lime&gt;&gt;\n\t\t\t&lt;&lt;if $shot2contents.honey + $shot2contents.juice &lt; 50&gt;&gt;\n\t\t\t\t&lt;&lt;ActVerb &quot;jigger&quot; &quot;Перелить содержимое в стопку&quot; &quot;jiggerPour&quot;&gt;&gt;&lt;br&gt;\n\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\t&lt;&lt;NoActVerb &quot;jigger&quot; &quot;Перелить содержимое в стопку&quot; &quot;jiggerPourFail&quot;&gt;&gt;&lt;br&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;ActVerb &quot;jigger&quot; &quot;Перевернуть джиггер&quot; &quot;jiggerTurn&quot;&gt;&gt;\n\t\t&lt;br&gt;\n\t\t&lt;&lt;PutOn &quot;jigger&quot; &quot;поставить&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="jiggerPutOnCounter" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты ставишь джиггер на &lt;&lt;object &quot;стойку&quot; &quot;counter&quot;&gt;&gt;.</div><div tiddler="jiggerTurn" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $jiggerContents.honey || $jiggerContents.juice || $jiggerContents.lime&gt;&gt;\n\t\tТы переворачиваешь джиггер и всё содержимое верхней ёмкости выплёскивается на стойку. Подоспевший бармен протирает её, не обращая внимания на твои неуклюжие извинения.\n\t\t&lt;&lt;set $jiggerContents.honey = 0&gt;&gt;\n\t\t&lt;&lt;set $jiggerContents.juice = 0&gt;&gt;\n\t\t&lt;&lt;set $jiggerContents.lime = false&gt;&gt;\n\t\t&lt;&lt;set $jiggerContents.salt = false&gt;&gt;\n\t\t&lt;&lt;unset $counterSalted $counterLimed&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\tТы переворачиваешь джиггер, теперь сверху ёмкость объёмом &lt;&lt;print ($jiggerTurned ? &quot;30 мл., снизу 10 мл&quot; : &quot;10 мл., снизу 30 мл&quot;)&gt;&gt;.\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="jiggerTurnAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $jiggerTurned = !$jiggerTurned&gt;&gt;</div><div tiddler="jiggerSqueezeLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты выдавливаешь лайм в &lt;&lt;object &quot;джиггер&quot; &quot;jigger&quot;&gt;&gt;.</div><div tiddler="jiggerSqueezeLimeAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $limeSqueezed = true&gt;&gt;\n\t&lt;&lt;set $jiggerContents.lime = true&gt;&gt;</div><div tiddler="jiggerSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты сыпешь немного соли в &lt;&lt;object &quot;джиггер&quot; &quot;jigger&quot;&gt;&gt;.</div><div tiddler="jiggerSaltAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $jiggerContents.salt = true&gt;&gt;</div><div tiddler="jiggerPour" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты переливаешь содержимое джиггера в &lt;&lt;object &quot;стопку&quot; &quot;shot2&quot;&gt;&gt; для чейзера\n\t&lt;&lt;if $shot2contents.honey + $shot2contents.juice &gt; 50&gt;&gt;\n\t\t&lt;&lt;set $x = Math.abs($shot2contents.honey + $shot2contents.juice - 50)&gt;&gt;\n\t\t&lt;&lt;if !$shot2contents.honey&gt;&gt;\n\t\t\t&lt;&lt;set $shot2contents.juice -= $x&gt;&gt;\n\t\t&lt;&lt;elseif !$shot2contents.juice&gt;&gt;\n\t\t\t&lt;&lt;set $shot2contents.honey -= $x&gt;&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;set $shot2contents.honey -= $x/2&gt;&gt;\n\t\t\t&lt;&lt;set $shot2contents.juice -= $x/2&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t, но немного не рассчитываешь: она переполняется и излишки выплёскиваются наружу. Оказавшийся рядом бармен подхватывает переполненную стопку, вытирает стойку под ней и осторожно ставит обратно\n\t&lt;&lt;/if&gt;&gt;\n\t.</div><div tiddler="jiggerPourAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $shot2contents.honey += $jiggerContents.honey&gt;&gt;\n\t&lt;&lt;set $shot2contents.juice += $jiggerContents.juice&gt;&gt;\n\t&lt;&lt;if $jiggerContents.lime&gt;&gt;\n\t\t&lt;&lt;set $shot2contents.lime = true&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if $jiggerContents.salt&gt;&gt;\n\t\t&lt;&lt;set $shot2contents.salt = true&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;set $jiggerContents.honey = 0&gt;&gt;\n\t&lt;&lt;set $jiggerContents.juice = 0&gt;&gt;\n\t&lt;&lt;set $jiggerContents.lime = false&gt;&gt;\n\t&lt;&lt;set $jiggerContents.salt = false&gt;&gt;</div><div tiddler="jiggerPourFail" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты собираешься перелить содержимое джиггера в &lt;&lt;object &quot;стопку&quot; &quot;shot2&quot;&gt;&gt; для чейзера, но та уже полная.\n\n\n/%\n\t\t   #####  #####  ## # ## ##   ##  ####   \n\t\t  ##  ## ##   ##  # # #  ##  ##      ##  \n\t\t  ##  ## ##   ##   ###   #####    #####  \n\t\t  ##  ## ##   ##  # # #  ##  ##  ##  ##  \n\t\t ##   ##  #####  ## # ## ##   ##  ###### \n%/</div><div tiddler="spoonInit" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;set $spoonChildren = []&gt;&gt;\n\t&lt;&lt;set $spoonName = &quot;ложка&quot;&gt;&gt;\n\t&lt;&lt;set $spoonNameG = &quot;ложку&quot;&gt;&gt;\n\t&lt;&lt;set $spoonParent = &quot;counter&quot;&gt;&gt;\n\t&lt;&lt;unset $spoonDisabled&gt;&gt;</div><div tiddler="spoonDesc" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Специальная ложка для смешивания коктейлей с длинной, витой ручкой.</div><div tiddler="spoonInv" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">коктейльная &lt;&lt;object &quot;ложка&quot; &quot;spoon&quot;&gt;&gt; в высоком тонком стакане</div><div tiddler="spoonAct" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;br&gt;\n\t&lt;&lt;if $spoonParent != &quot;lefthand&quot; and $spoonParent != &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;Take &quot;spoon&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;if $shot2contents.honey || $shot2contents.juice || $shot2contents.lime&gt;&gt;\n\t\t\t&lt;&lt;if $shot2Ready&gt;&gt;\n\t\t\t\t&lt;&lt;NoActVerb &quot;spoon&quot; &quot;Помешать Палома чейзер&quot; &quot;spoonMix&quot;&gt;&gt;&lt;br&gt;\n\t\t\t&lt;&lt;else&gt;&gt;\n\t\t\t\t&lt;&lt;NoActVerb &quot;spoon&quot; &quot;Помешать в стопке для чейзера&quot; &quot;spoonMix&quot;&gt;&gt;&lt;br&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;PutOn &quot;spoon&quot; &quot;counter&quot; &quot;вернуть&quot; &quot;на&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;</div><div tiddler="spoonPutOnCounter" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты возвращаешь ложку в её стакан.</div><div tiddler="spoonSalt" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты сыпешь пару крупинок соли на ложку. Они с неё ссыпаются.</div><div tiddler="spoonLime" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">Ты выдавливаешь пару капель лаймового сока на ложку. Они с неё скатываются.</div><div tiddler="spoonMix" tags="nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;if $shot2Ready&gt;&gt;\n\t\tТы неспеша размешиваешь коктейль в стопке. Всё, Палома чейзер готов к употреблению.\n\t&lt;&lt;else&gt;&gt;\n\t\tТы неспеша помешиваешь в стопке для чейзера.\n\t&lt;&lt;/if&gt;&gt;\n\n\n\n\n\n\n\n\n/%\n\t\t ######                                                  \n\t\t ##   ##           ####                                  \n\t\t ##   ## ##   ##      ## ## # ##  #####  ######  ##   ## \n\t\t ######  ##  ###   #####  # # #  ##   ##   ##    ##   ## \n\t\t ##   ## ## # ##  ##  ##   ###   ######    ##    ####  # \n\t\t ##   ## ###  ## ##   ##  # # #  ##        ##    ##  # # \n\t\t ######  ##   ##  #####  ## # ##  #####    ##    ####  #\n %/</div><div tiddler="MahWidgets" tags="widget nobr" created="201602092239" modifier="twee" twine-position="0,0">&lt;&lt;widget &quot;object&quot;&gt;&gt;&lt;&lt;click $args[0]&gt;&gt;\n\t\t&lt;&lt;if $MODE&gt;&gt;\n\t\t\t&lt;&lt;removeclass &quot;.decor&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t\t&lt;&lt;removeclass &quot;.inventory&quot; &quot;fluence&quot;&gt;&gt;\n\t\t\t&lt;&lt;removeclass &quot;.history&quot; &quot;fluence&quot;&gt;&gt;\n\t\t\t&lt;&lt;removeclass &quot;.focus&quot; &quot;fluence&quot;&gt;&gt;\n\t\t\t&lt;&lt;removeclass &quot;.actions&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t\t/%&lt;&lt;removeclass &quot;.hint&quot; &quot;turnoff&quot;&gt;&gt;%/\n\t\t\t&lt;&lt;if $MODE == &quot;salting&quot;&gt;&gt;\n\t\t\t\t&lt;&lt;saltingmode $args[1]&gt;&gt;\n\t\t\t&lt;&lt;elseif $MODE == &quot;liming&quot;&gt;&gt;\n\t\t\t\t&lt;&lt;limingmode $args[1]&gt;&gt;\n\t\t\t&lt;&lt;elseif $MODE == &quot;squeezing&quot;&gt;&gt;\n\t\t\t\t&lt;&lt;squeezingmode $args[1]&gt;&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t\t&lt;&lt;set $MODE = &quot;&quot;&gt;&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;print &quot;&lt;&lt;set $recipeDaemon = '&quot;+$recipe+&quot;Daemon'&gt;&gt;&quot;&gt;&gt; /% запоминаем демона локации %/\n\t\t\t&lt;&lt;display $recipeDaemon&gt;&gt; /% показываем демона локации %/\n\t\t\t&lt;&lt;print &quot;&lt;&lt;set $recipeEvent = $&quot;+$recipe+&quot;Event&gt;&gt;&quot;&gt;&gt;\n\t\t\t&lt;&lt;if $historyArr.contains($args[1])&gt;&gt; /% если в списке истории уже есть этот объект, удаляем его оттуда %/\n\t\t\t\t&lt;&lt;set $historyArr.splice($historyArr.indexOf($args[1]), 1)&gt;&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t\t&lt;&lt;print &quot;&lt;&lt;set $objectDisabled = $&quot;+$focus+&quot;Disabled&gt;&gt;&quot;&gt;&gt;\n\t\t\t&lt;&lt;if $focus &amp;&amp; $focus != $args[1] &amp;&amp; !$objectDisabled&gt;&gt; /% если уже есть объект в старом фокусе и этот объект не равен объекту в фокусе новом и не отключён, перемещаем его в историю %/\n\t\t\t\t&lt;&lt;set $historyArr.push($focus)&gt;&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t\t&lt;&lt;set $focus = $args[1]&gt;&gt; /% обновляем фокус %/\n\t\t\t&lt;&lt;history&gt;&gt; /% обновляем историю %/\n\t\t\t&lt;&lt;replace &quot;.focus&quot;&gt;&gt; /% выводим данные объекта в фокусе %/\n\t\t\t\t&lt;br&gt;&lt;br&gt;\n\t\t\t\t&lt;&lt;print &quot;&lt;&lt;set $objectName = $&quot;+$args[1]+&quot;Name&gt;&gt;&quot;&gt;&gt;\n\t\t\t\t&lt;&lt;print &quot;&lt;&lt;set $objectDesc = '&quot;+$args[1]+&quot;Desc'&gt;&gt;&quot;&gt;&gt;\n\t\t\t\t&lt;&lt;print &quot;&lt;&lt;set $objectAct = '&quot;+$args[1]+&quot;Act'&gt;&gt;&quot;&gt;&gt;\n\t\t\t\t&lt;&lt;set $objectName = $objectName.charAt(0).toUpperCase()+$objectName.slice(1)&gt;&gt; /% у имени объекта делаем первую букву заглавной %/\n\t\t\t\t• ''&lt;&lt;print $objectName&gt;&gt;'' /% выводим имя %/\n\t\t\t\t&lt;br&gt;\n\t\t\t\t&lt;&lt;display $objectDesc&gt;&gt; /% выводим описание %/\n\t\t\t&lt;&lt;/replace&gt;&gt;\n\t\t\t&lt;&lt;replace &quot;.actions&quot;&gt;&gt;\n\t\t\t\t&lt;&lt;if tale.has($objectAct)&gt;&gt;\n\t\t\t\t\t&lt;&lt;display $objectAct&gt;&gt; /% выводим действия %/\n\t\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t\t&lt;&lt;/replace&gt;&gt;\n\t\t\t&lt;&lt;replace &quot;.events&quot;&gt;&gt;\n\t\t\t\t&lt;&lt;print $recipeEvent&gt;&gt;\n\t\t\t&lt;&lt;/replace&gt;&gt;\n\t\t\t&lt;&lt;if $recipeEvent&gt;&gt;\n\t\t\t\t&lt;&lt;prepend &quot;.events&quot;&gt;&gt;\n\t\t\t\t\t&lt;br&gt;\n\t\t\t\t&lt;&lt;/prepend&gt;&gt;\n\t\t\t\t&lt;&lt;print &quot;&lt;&lt;set $&quot;+$recipe+&quot;Event = ''&gt;&gt;&quot;&gt;&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/click&gt;&gt;&lt;&lt;/widget&gt;&gt;\n\n\n/% виджет вывода истории просмотренных объектов %/\n&lt;&lt;widget &quot;history&quot;&gt;&gt;\n\t&lt;&lt;replace &quot;.history&quot;&gt;&gt; /% для начала сбрасываем существующий текст %/\n\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;if $historyArr.length != 0&gt;&gt; /% если история есть, выводим её %/\n\t\t&lt;&lt;append &quot;.history&quot;&gt;&gt;&lt;br&gt;&lt;br&gt;&lt;&lt;/append&gt;&gt;\n\t\t&lt;&lt;for $i = 0; $i &lt; $historyArr.length; $i++&gt;&gt; /% перебираем содержимое массива истории %/\n\t\t\t&lt;&lt;print &quot;&lt;&lt;set $objectName = $&quot;+$historyArr[$i]+&quot;Name&gt;&gt;&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $objectName = $objectName.charAt(0).toUpperCase()+$objectName.slice(1)&gt;&gt; /% у очередногообъекта в истории делаем первую букву заглавной %/\n\t\t\t&lt;&lt;append &quot;.history&quot;&gt;&gt; /% добавляем объект в виде ссылки, если он не последний, ещё и переводим строку %/\n\t\t\t• &lt;&lt;object $objectName $historyArr[$i]&gt;&gt;\n\t\t\t&lt;&lt;if $i &lt; $historyArr.length-1&gt;&gt;\n\t\t\t\t&lt;br&gt;\n\t\t\t&lt;&lt;/if&gt;&gt;\n\t\t\t&lt;&lt;/append&gt;&gt;\n\t\t&lt;&lt;/for&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% виджет обновления экрана при действии объекта на объект %/\n&lt;&lt;widget &quot;fluencerefresh&quot;&gt;&gt;\n\t&lt;&lt;if $MODE&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.decor&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.inventory&quot; &quot;fluence&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.history&quot; &quot;fluence&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.focus&quot; &quot;fluence&quot;&gt;&gt;\n\t\t&lt;&lt;addclass &quot;.actions&quot; &quot;turnoff&quot;&gt;&gt;\n\t\t/%&lt;&lt;addclass &quot;.hint&quot; &quot;turnoff&quot;&gt;&gt;%/\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $recipeDaemon = '&quot;+$recipe+&quot;Daemon'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;display $recipeDaemon&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $recipeEvent = $&quot;+$recipe+&quot;Event&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;replace &quot;.inventory&quot;&gt;&gt;\n\t\t&lt;&lt;print $recipeInv&gt;&gt;\n\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;history&gt;&gt;\n\t&lt;&lt;replace &quot;.focus&quot;&gt;&gt;\n\t\t&lt;br&gt;&lt;br&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $objectName = $&quot;+$focus+&quot;Name&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $objectDesc = '&quot;+$focus+&quot;Desc'&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;set $objectName = $objectName.charAt(0).toUpperCase()+$objectName.slice(1)&gt;&gt;\n\t\t• ''&lt;&lt;print $objectName&gt;&gt;''\n\t\t&lt;br&gt;\n\t\t&lt;&lt;display $objectDesc&gt;&gt;\n\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;replace &quot;.actions&quot;&gt;&gt;\n\t\t&lt;&lt;if tale.has($objectAct)&gt;&gt;\n\t\t\t&lt;&lt;display $objectAct&gt;&gt; /% выводим действия %/\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/replace&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% виджет обновления экрана по действию %/\n&lt;&lt;widget &quot;actrefresh&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $recipeDaemon = '&quot;+$recipe+&quot;Daemon'&gt;&gt;&quot;&gt;&gt; /% запоминаем демона локации %/\n\t&lt;&lt;display $recipeDaemon&gt;&gt; /% показываем демона локации %/\n\t&lt;&lt;print &quot;&lt;&lt;set $recipeEvent = $&quot;+$recipe+&quot;Event&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;replace &quot;.inventory&quot;&gt;&gt; /% обновляем инвентарную часть описания %/\n\t\t&lt;&lt;print $recipeInv&gt;&gt;\n\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;history&gt;&gt; /% обновляем историю %/\n\t&lt;&lt;replace &quot;.focus&quot;&gt;&gt; /% выводим описание действия %/\n\t\t&lt;br&gt;&lt;br&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $objectName = $&quot;+$focus+&quot;Name&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $objectAct = '&quot;+$focus+&quot;Act'&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $objectDisabled = $&quot;+$focus+&quot;Disabled&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;set $objectName = $objectName.charAt(0).toUpperCase()+$objectName.slice(1)&gt;&gt;\n\t\t• \n\t\t&lt;&lt;if !$objectDisabled&gt;&gt; /% если объект не отключён — выводим его имя ссылкой %/\n\t\t\t&lt;&lt;object $objectName $focus&gt;&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t''&lt;&lt;print $objectName&gt;&gt;''\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t: ''&lt;&lt;print $args[1]&gt;&gt;''\n\t\t&lt;br&gt;\n\t\t&lt;&lt;print $args[2]&gt;&gt; /% выводим описание действия %/\n\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;replace &quot;.actions&quot;&gt;&gt;\n\t\t&lt;&lt;if !$objectDisabled and tale.has($objectAct)&gt;&gt; /% если объект не отключён и у него есть действия — выводим список действий %/\n\t\t\t&lt;&lt;display $objectAct&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;replace &quot;.events&quot;&gt;&gt;\n\t\t&lt;&lt;print $recipeEvent&gt;&gt;\n\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;if $recipeEvent&gt;&gt;\n\t\t&lt;&lt;prepend &quot;.events&quot;&gt;&gt;\n\t\t\t&lt;br&gt;\n\t\t&lt;&lt;/prepend&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $&quot;+$recipe+&quot;Event = ''&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;replace &quot;.drunkness&quot;&gt;&gt;\n\t\t&lt;&lt;display &quot;HowDrunkAreYou&quot;&gt;&gt;\n\t&lt;&lt;/replace&gt;&gt;\n\t&lt;&lt;set $quickcommand = 0&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% виджет осмотра декораций %/\n&lt;&lt;widget &quot;prop&quot;&gt;&gt;&lt;&lt;click $args[0]&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $recipeDaemon = '&quot;+$recipe+&quot;Daemon'&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;display $recipeDaemon&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $recipeEvent = $&quot;+$recipe+&quot;Event&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $objectDisabled = $&quot;+$focus+&quot;Disabled&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;if $focus &amp;&amp; !$objectDisabled&gt;&gt; /% если уже есть объект в старом фокусе и этот объект не равен объекту в фокусе новом и не отключён, перемещаем его в историю %/\n\t\t\t&lt;&lt;set $historyArr.push($focus)&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;set $focus = &quot;&quot;&gt;&gt;\n\t\t&lt;&lt;history&gt;&gt;\n\t\t&lt;&lt;replace &quot;.focus&quot;&gt;&gt;\n\t\t\t&lt;br&gt;&lt;br&gt;\n\t\t\t&lt;&lt;print &quot;&lt;&lt;set $propName = $&quot;+$args[1]+&quot;Name&gt;&gt;&quot;&gt;&gt;\n\t\t\t&lt;&lt;print &quot;&lt;&lt;set $propDesc = '&quot;+$args[1]+&quot;Desc'&gt;&gt;&quot;&gt;&gt;\n\t\t\t&lt;&lt;set $propName = $propName.charAt(0).toUpperCase()+$propName.slice(1)&gt;&gt;\n\t\t\t• ''&lt;&lt;print $propName&gt;&gt;''\n\t\t\t&lt;br&gt;\n\t\t\t&lt;&lt;display $propDesc&gt;&gt;\n\t\t&lt;&lt;/replace&gt;&gt;\n\t\t&lt;&lt;replace &quot;.actions&quot;&gt;&gt;\n\t\t&lt;&lt;/replace&gt;&gt;\n\t\t&lt;&lt;replace &quot;.events&quot;&gt;&gt;\n\t\t\t&lt;&lt;print $recipeEvent&gt;&gt;\n\t\t&lt;&lt;/replace&gt;&gt;\n\t\t&lt;&lt;if $recipeEvent&gt;&gt;\n\t\t\t&lt;&lt;prepend &quot;.events&quot;&gt;&gt;\n\t\t\t\t&lt;br&gt;\n\t\t\t&lt;&lt;/prepend&gt;&gt;\n\t\t\t&lt;&lt;print &quot;&lt;&lt;set $&quot;+$recipe+&quot;Event = ''&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;/click&gt;&gt;&lt;&lt;/widget&gt;&gt;\n\n\n/% виджет удаления объекта %/\n&lt;&lt;widget &quot;removeobj&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectParent = $&quot;+$args[0]+&quot;Parent&gt;&gt;&quot;&gt;&gt; /% запоминаем «родителя» объекта %/\n\t&lt;&lt;if $objectParent&gt;&gt; /% если «родитель» есть, то удаляем объект из его «детей» %/\n\t\t&lt;&lt;print &quot;&lt;&lt;set $objectParentChildren = $&quot;+$objectParent+&quot;Children&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;set $objectParentChildren.splice($objectParentChildren.indexOf($args[0]), 1)&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $&quot;+$args[0]+&quot;Disabled = 1&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;if $historyArr.contains ($args[0])&gt;&gt; /% удаляем объект из истории %/\n\t\t&lt;&lt;set $historyArr.splice($historyArr.indexOf($args[0]), 1)&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% виджет перемещения объекта %/\n&lt;&lt;widget &quot;moveobj&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectParent = $&quot;+$args[0]+&quot;Parent&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;if $objectParent&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $objectParentChildren = $&quot;+$objectParent+&quot;Children&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;set $objectParentChildren.splice($objectParentChildren.indexOf($args[0]), 1)&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $&quot;+$args[0]+&quot;Parent = $args[1]&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectParentChildren = $&quot;+$args[1]+&quot;Children&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;set $objectParentChildren.push($args[0])&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% «Взять» %/\n&lt;&lt;widget &quot;Take&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectNameG = $&quot;+$args[0]+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectActResult = '&quot;+$args[0]+&quot;Take'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;set $linktext = &quot;Взять &quot;+$objectNameG&gt;&gt;\n\t&lt;&lt;if !$righthandChildren[0]&gt;&gt;\n\t\t&lt;&lt;if tale.has($objectActResult)&gt;&gt;\n\t\t\t&lt;&lt;set $objectActResult = tale.get($objectActResult).processText()&gt;&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;set $objectActResult = &quot;Ты берёшь &quot;+$objectNameG+&quot; в правую руку.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;click '&quot;+$linktext+&quot;'&gt;&gt;&lt;&lt;moveobj '&quot;+$args[0]+&quot;' 'righthand'&gt;&gt;&lt;&lt;actrefresh '&quot;+$args[0]+&quot;' '&quot;+$linktext+&quot;' '&quot;+$objectActResult+&quot;'&gt;&gt;&lt;&lt;/click&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;elseif !$lefthandChildren[0]&gt;&gt;\n\t\t&lt;&lt;if tale.has($objectActResult)&gt;&gt;\n\t\t\t&lt;&lt;set $objectActResult = tale.get($objectActResult).processText()&gt;&gt;\n\t\t&lt;&lt;else&gt;&gt;\n\t\t\t&lt;&lt;set $objectActResult = &quot;Ты берёшь &quot;+$objectNameG+&quot; в левую руку.&quot;&gt;&gt;\n\t\t&lt;&lt;/if&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;click '&quot;+$linktext+&quot;'&gt;&gt;&lt;&lt;moveobj '&quot;+$args[0]+&quot;' 'lefthand'&gt;&gt;&lt;&lt;actrefresh '&quot;+$args[0]+&quot;' '&quot;+$linktext+&quot;' '&quot;+$objectActResult+&quot;'&gt;&gt;&lt;&lt;/click&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;NoActVerb $args[0] $linktext &quot;handsTakeFull&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% «Выпить» %/\n&lt;&lt;widget &quot;Drink&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectNameG = $&quot;+$args[0]+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectActResult = '&quot;+$args[0]+&quot;Drink'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $quickcommand = '&quot;+$args[0]+&quot;DrinkAct'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;if tale.has($quickcommand)&gt;&gt;\n\t\t&lt;&lt;set $quickcommand = &quot;&lt;&lt;display '&quot;+ $quickcommand +&quot;'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if $args[1]&gt;&gt;\n\t\t&lt;&lt;set $linktext = $args[1].charAt(0).toUpperCase()+$args[1].slice(1)+&quot; &quot;+$objectNameG&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $linktext = &quot;Выпить &quot;+$objectNameG&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if tale.has($objectActResult)&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = tale.get($objectActResult).processText()&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = &quot;Ты выпиваешь &quot;+$objectNameG+&quot;.&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;click '&quot;+$linktext+&quot;'&gt;&gt;&quot;+$quickcommand+&quot;&lt;&lt;actrefresh '&quot;+$args[0]+&quot;' '&quot;+$linktext+&quot;' '&quot;+$objectActResult+&quot;'&gt;&gt;&lt;&lt;/click&gt;&gt;&quot;&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% «Съесть» %/\n&lt;&lt;widget &quot;Eat&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectNameG = $&quot;+$args[0]+&quot;NameG&gt;&gt;&quot;&gt;&gt; /% запоминаем имя объекта в родительском падеже %/\n\t&lt;&lt;print &quot;&lt;&lt;set $objectActResult = '&quot;+$args[0]+&quot;Eat'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $quickcommand = '&quot;+$args[0]+&quot;EatAct'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;if tale.has($quickcommand)&gt;&gt;\n\t\t&lt;&lt;set $quickcommand = &quot;&lt;&lt;display '&quot;+ $quickcommand +&quot;'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if $args[1]&gt;&gt;\n\t\t&lt;&lt;set $linktext = $args[1].charAt(0).toUpperCase()+$args[1].slice(1)+&quot; &quot;+$objectNameG&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $linktext = &quot;Съесть &quot;+$objectNameG&gt;&gt; /% текст ссылки %/\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if tale.has($objectActResult)&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = tale.get($objectActResult).processText()&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = &quot;Ты съедаешь &quot;+$objectNameG+&quot;.&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;click '&quot;+$linktext+&quot;'&gt;&gt;&quot;+$quickcommand+&quot;&lt;&lt;removeobj '&quot;+$args[0]+&quot;'&gt;&gt;&lt;&lt;actrefresh '&quot;+$args[0]+&quot;' '&quot;+$linktext+&quot;' '&quot;+$objectActResult+&quot;'&gt;&gt;&lt;&lt;/click&gt;&gt;&quot;&gt;&gt; /% удаляем объект и обновляем экран по действию %/\n&lt;&lt;/widget&gt;&gt;\n\n\n/% «Лизать» %/\n&lt;&lt;widget &quot;Lick&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectNameG = $&quot;+$args[0]+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectActResult = '&quot;+$args[0]+&quot;Lick'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $quickcommand = '&quot;+$args[0]+&quot;LickAct'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;if tale.has($quickcommand)&gt;&gt;\n\t\t&lt;&lt;set $quickcommand = &quot;&lt;&lt;display '&quot;+ $quickcommand +&quot;'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if $args[1]&gt;&gt;\n\t\t&lt;&lt;set $linktext = $args[1]&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $linktext = &quot;Облизать &quot;+$objectNameG&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if tale.has($objectActResult)&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = tale.get($objectActResult).processText()&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = &quot;Ты лижешь &quot;+$objectNameG+&quot;.&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;click '&quot;+$linktext+&quot;'&gt;&gt;&quot;+$quickcommand+&quot;&lt;&lt;set $&quot;+$args[0]+&quot;Salted = 0&gt;&gt;&lt;&lt;set $&quot;+$args[0]+&quot;Limed = 0&gt;&gt;&lt;&lt;actrefresh '&quot;+$args[0]+&quot;' '&quot;+$linktext+&quot;' '&quot;+$objectActResult+&quot;'&gt;&gt;&lt;&lt;/click&gt;&gt;&quot;&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% «Положить» %/\n&lt;&lt;widget &quot;PutOn&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectNameG = $&quot;+$args[0]+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $subjectNameG = $&quot;+$args[1]+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;if $args.length == 2&gt;&gt;\n\t\t&lt;&lt;set $linktext = $args[1].charAt(0).toUpperCase()+$args[1].slice(1)+&quot; &quot;+$objectNameG&gt;&gt;\n\t\t&lt;&lt;set $subject = &quot;counter&quot;&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $objectActResult = '&quot;+$args[0]+&quot;PutOnCounter'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $quickcommand = '&quot;+$args[0]+&quot;PutOnCounterAct'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;elseif $args.length == 4&gt;&gt;\n\t\t&lt;&lt;set $linktext = $args[2].charAt(0).toUpperCase()+$args[2].slice(1)+&quot; &quot;+$objectNameG+&quot; &quot;+$args[3]+&quot; &quot;+$subjectNameG&gt;&gt;\n\t\t&lt;&lt;set $subject = $args[1]&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $objectActResult = '&quot;+$args[0]+&quot;PutOn&quot;+ $args[1].charAt(0).toUpperCase()+$args[1].slice(1) +&quot;'&gt;&gt;&quot;&gt;&gt;\n\t\t&lt;&lt;print &quot;&lt;&lt;set $quickcommand = '&quot;+$args[0]+&quot;PutOn&quot;+ $args[1].charAt(0).toUpperCase()+$args[1].slice(1) +&quot;Act'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if tale.has($quickcommand)&gt;&gt;\n\t\t&lt;&lt;set $quickcommand = &quot;&lt;&lt;display '&quot;+ $quickcommand +&quot;'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;if tale.has($objectActResult)&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = tale.get($objectActResult).processText()&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = &quot;Ты убираешь &quot;+$objectNameG+&quot;.&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;click '&quot;+$linktext+&quot;'&gt;&gt;&quot;+$quickcommand+&quot;&lt;&lt;moveobj '&quot;+$args[0]+&quot;' '&quot;+$subject+&quot;'&gt;&gt;&lt;&lt;actrefresh '&quot;+$args[0]+&quot;' '&quot;+$linktext+&quot;' '&quot;+$objectActResult+&quot;'&gt;&gt;&lt;&lt;/click&gt;&gt;&quot;&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% «Переложить из руки в руку» %/\n&lt;&lt;widget &quot;ChangeHands&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectNameG = $&quot;+$args[0]+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectActResult = '&quot;+$args[0]+&quot;ChangeHands'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectParent = $&quot;+$args[0]+&quot;Parent&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;set $linktext = &quot;Переложить &quot;+$objectNameG+&quot; в другую руку&quot;&gt;&gt;\n\t&lt;&lt;if $objectParent == &quot;lefthand&quot;&gt;&gt;\n\t\t&lt;&lt;set $otherhand = &quot;righthand&quot;&gt;&gt;\n\t&lt;&lt;elseif $objectParent == &quot;righthand&quot;&gt;&gt;\n\t\t&lt;&lt;set $otherhand = &quot;lefthand&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $subject = $&quot;+$otherhand+&quot;Children[0]&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $subjectNameG = $&quot;+$subject+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $otherhandNameG = $&quot;+$otherhand+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectParentNameG = $&quot;+$objectParent+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;if $subject&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = &quot;Ты берёшь &quot;+$objectNameG+&quot; в &quot;+$otherhandNameG+&quot;, а &quot;+$subjectNameG+&quot; в &quot;+$objectParentNameG+&quot;.&quot;&gt;&gt;\n\t\t&lt;&lt;set $whereto = &quot;&lt;&lt;moveobj '&quot;+$args[0]+&quot;' '&quot;+$otherhand+&quot;'&gt;&gt;&lt;&lt;moveobj '&quot;+$subject+&quot;' '&quot;+$objectParent+&quot;'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = &quot;Ты перекладываешь &quot;+$objectNameG+&quot; в &quot;+$otherhandNameG+&quot;.&quot;&gt;&gt;\n\t\t&lt;&lt;set $whereto = &quot;&lt;&lt;moveobj '&quot;+$args[0]+&quot;' '&quot;+$otherhand+&quot;'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;click '&quot;+$linktext+&quot;'&gt;&gt;&quot;+$whereto+&quot;&lt;&lt;actrefresh '&quot;+$args[0]+&quot;' '&quot;+$linktext+&quot;' '&quot;+$objectActResult+&quot;'&gt;&gt;&lt;&lt;/click&gt;&gt;&quot;&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% «Посолить» %/\n&lt;&lt;widget &quot;SaltSmthng&quot;&gt;&gt;\n\t&lt;&lt;if $args[0]&gt;&gt;\n\t\t&lt;&lt;set $linktext = $args[0]&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $linktext = &quot;Посолить что-нибудь&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;click $linktext&gt;&gt;\n\t\t&lt;&lt;set $MODE = &quot;salting&quot;&gt;&gt;\n\t\t&lt;&lt;fluencerefresh&gt;&gt;\n\t&lt;&lt;/click&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% «Смочить лаймом» %/\n&lt;&lt;widget &quot;LimeSmthng&quot;&gt;&gt;\n\t&lt;&lt;if $args[0]&gt;&gt;\n\t\t&lt;&lt;set $linktext = $args[0]&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $linktext = &quot;Смочить что-нибудь соком лайма&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;click $linktext&gt;&gt;\n\t\t&lt;&lt;set $MODE = &quot;liming&quot;&gt;&gt;\n\t\t&lt;&lt;fluencerefresh&gt;&gt;\n\t&lt;&lt;/click&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% «Выдавить лайм» %/\n&lt;&lt;widget &quot;SqueezeLimeOnSmthng&quot;&gt;&gt;\n\t&lt;&lt;if $args[0]&gt;&gt;\n\t\t&lt;&lt;set $linktext = $args[0]&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $linktext = &quot;Выдавить лайм куда-нибудь&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;click $linktext&gt;&gt;\n\t\t&lt;&lt;set $MODE = &quot;squeezing&quot;&gt;&gt;\n\t\t&lt;&lt;fluencerefresh&gt;&gt;\n\t&lt;&lt;/click&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n\n/% Глагол с удалением объекта %/\n&lt;&lt;widget &quot;RemoveVerb&quot;&gt;&gt;\n\t&lt;&lt;set $objectActResult = tale.get($args[2]).processText()&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;click '&quot;+$args[1]+&quot;'&gt;&gt;&lt;&lt;removeobj '&quot;+$args[0]+&quot;'&gt;&gt;&lt;&lt;actrefresh '&quot;+$args[0]+&quot;' '&quot;+$args[1]+&quot;' '&quot;+$objectActResult+&quot;'&gt;&gt;&lt;&lt;/click&gt;&gt;&quot;&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% Глагол без последствий — выводит только описание %/\n&lt;&lt;widget &quot;NoActVerb&quot;&gt;&gt;\n\t&lt;&lt;set $objectActResult = tale.get($args[2]).processText()&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;click '&quot;+$args[1]+&quot;'&gt;&gt;&lt;&lt;actrefresh '&quot;+$args[0]+&quot;' '&quot;+$args[1]+&quot;' '&quot;+$objectActResult+&quot;'&gt;&gt;&lt;&lt;/click&gt;&gt;&quot;&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% Одноразовый глагол с некоторым кодом %/\n&lt;&lt;widget &quot;ActVerb&quot;&gt;&gt;\n\t&lt;&lt;set $objectActResult = tale.get($args[2]).processText()&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;click '&quot;+$args[1]+&quot;'&gt;&gt;&lt;&lt;display '&quot;+$args[2]+&quot;Act'&gt;&gt;&lt;&lt;actrefresh '&quot;+$args[0]+&quot;' '&quot;+$args[1]+&quot;' '&quot;+$objectActResult+&quot;'&gt;&gt;&lt;&lt;/click&gt;&gt;&quot;&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% Режим соления %/\n&lt;&lt;widget &quot;saltingmode&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectNameG = $&quot;+$args[0]+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectActResult = '&quot;+$args[0]+&quot;Salt'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $quickcommand = '&quot;+$args[0]+&quot;SaltAct'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;if tale.has($quickcommand)&gt;&gt;\n\t\t&lt;&lt;set $quickcommand = &quot;&lt;&lt;display '&quot;+ $quickcommand +&quot;'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $&quot;+$args[0]+&quot;Salted = 1&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;set $linktext = &quot;Посолить &quot;+$objectNameG&gt;&gt;\n\t&lt;&lt;if tale.has($objectActResult)&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = tale.get($objectActResult).processText()&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = &quot;Ты солишь &quot;+$objectNameG+&quot;.&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print $quickcommand&gt;&gt;\n\t&lt;&lt;actrefresh $args[0] $linktext $objectActResult&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% Режим смачивания лаймом %/\n&lt;&lt;widget &quot;limingmode&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectNameG = $&quot;+$args[0]+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectActResult = '&quot;+$args[0]+&quot;Lime'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $quickcommand = '&quot;+$args[0]+&quot;LimeAct'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;if tale.has($quickcommand)&gt;&gt;\n\t\t&lt;&lt;set $quickcommand = &quot;&lt;&lt;display '&quot;+ $quickcommand +&quot;'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $&quot;+$args[0]+&quot;Limed = 1&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;set $linktext = &quot;Смочить &quot;+$objectNameG+&quot; соком лайма&quot;&gt;&gt;\n\t&lt;&lt;if tale.has($objectActResult)&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = tale.get($objectActResult).processText()&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = &quot;Ты смачиваешь &quot;+$objectNameG+&quot;.&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print $quickcommand&gt;&gt;\n\t&lt;&lt;actrefresh $args[0] $linktext $objectActResult&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n/% Режим выдавливания лайма %/\n&lt;&lt;widget &quot;squeezingmode&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectNameG = $&quot;+$args[0]+&quot;NameG&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $objectActResult = '&quot;+$args[0]+&quot;SqueezeLime'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $quickcommand = '&quot;+$args[0]+&quot;SqueezeLimeAct'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;if tale.has($quickcommand)&gt;&gt;\n\t\t&lt;&lt;set $quickcommand = &quot;&lt;&lt;display '&quot;+ $quickcommand +&quot;'&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print &quot;&lt;&lt;set $&quot;+$args[0]+&quot;Limed = true&gt;&gt;&quot;&gt;&gt;\n\t&lt;&lt;set $linktext = &quot;Выдавить лайм в &quot;+$objectNameG&gt;&gt;\n\t&lt;&lt;if tale.has($objectActResult)&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = tale.get($objectActResult).processText()&gt;&gt;\n\t&lt;&lt;else&gt;&gt;\n\t\t&lt;&lt;set $objectActResult = &quot;Ты выдавливаешь лайм в &quot;+$objectNameG+&quot;.&quot;&gt;&gt;\n\t&lt;&lt;/if&gt;&gt;\n\t&lt;&lt;print $quickcommand&gt;&gt;\n\t&lt;&lt;actrefresh $args[0] $linktext $objectActResult&gt;&gt;\n&lt;&lt;/widget&gt;&gt;\n\n\n&lt;&lt;widget &quot;clockwork&quot;&gt;&gt;&lt;&lt;if $minute &gt;= 60&gt;&gt;&lt;&lt;set $minute -= 60&gt;&gt;&lt;&lt;set $hour++&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $hour &gt;= 24&gt;&gt;&lt;&lt;set $hour -= 24&gt;&gt;&lt;&lt;elseif $hour &lt; 0&gt;&gt;&lt;&lt;set $hour += 24&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $args[0]&gt;&gt;&lt;&lt;set $xhour = $hour + $args[0]&gt;&gt;&lt;&lt;else&gt;&gt;&lt;&lt;set $xhour = $hour&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;if $xhour &gt;= 24&gt;&gt;&lt;&lt;set $xhour -= 24&gt;&gt;&lt;&lt;elseif $xhour &lt; 0&gt;&gt;&lt;&lt;set $xhour += 24&gt;&gt;&lt;&lt;/if&gt;&gt;&lt;&lt;print &quot;&lt;&lt;print ($xhour &lt; 10 ? '0' : '')&gt;&gt;&quot;+$xhour+&quot;:&lt;&lt;print ($minute &lt; 10 ? '0' : '')&gt;&gt;&quot;+$minute&gt;&gt;&lt;&lt;/widget&gt;&gt;</div><div tiddler="Leon's Replace" tags="script" created="201602092239" modifier="twee" twine-position="0,0">(function(){version.extensions.replaceMacrosCombined={major:1,minor:1,revision:4};var nullobj={handler:function(){}};function showVer(n,notrans){if(!n){return\n}n.innerHTML=&quot;&quot;;new Wikifier(n,n.tweecode);n.setAttribute(&quot;data-enabled&quot;,&quot;true&quot;);n.style.display=&quot;inline&quot;;n.classList.remove(&quot;revision-span-out&quot;);\nif(!notrans){n.classList.add(&quot;revision-span-in&quot;);if(n.timeout){clearTimeout(n.timeout)}n.timeout=setTimeout(function(){n.classList.remove(&quot;revision-span-in&quot;);\nn=null},1)}}function hideVer(n,notrans){if(!n){return}n.setAttribute(&quot;data-enabled&quot;,&quot;false&quot;);n.classList.remove(&quot;revision-span-in&quot;);\nif(n.timeout){clearTimeout(n.timeout)}if(!notrans){n.classList.add(&quot;revision-span-out&quot;);n.timeout=setTimeout(function(){if(n.getAttribute(&quot;data-enabled&quot;)==&quot;false&quot;){n.classList.remove(&quot;revision-span-out&quot;);\nn.style.display=&quot;none&quot;;n.innerHTML=&quot;&quot;}n=null},1000)}else{n.style.display=&quot;none&quot;;n.innerHTML=&quot;&quot;;n=null}}function tagcontents(b,starttags,desttags,endtags,k){var l=0,c=&quot;&quot;,tg,a,i;\nfunction tagfound(i,e){for(var j=0;j&lt;e.length;j++){if(a.indexOf(&quot;&lt;&lt;&quot;+e[j],i)==i){return e[j]}}}a=b.source.slice(k);for(i=0;\ni&lt;a.length;i++){if(tg=tagfound(i,starttags)){l++}else{if((tg=tagfound(i,desttags))&amp;&amp;l==0){b.nextMatch=k+i+tg.length+4;return[c,tg]\n}else{if(tg=tagfound(i,endtags)){l--;if(l&lt;0){return null}}}}c+=a.charAt(i)}return null}var begintags=[];var endtags=[];function revisionSpanHandler(g,e,f,b){var k=b.source.indexOf(&quot;&gt;&gt;&quot;,b.matchStart)+2,vsns=[],vtype=e,flen=f.length,becomes,c,cn,m,h,vsn;\nfunction mkspan(vtype){h=insertElement(m,&quot;span&quot;,null,&quot;revision-span &quot;+vtype);h.setAttribute(&quot;data-enabled&quot;,false);h.style.display=&quot;none&quot;;\nh.tweecode=&quot;&quot;;return h}if(this.shorthand&amp;&amp;flen){while(f.length&gt;0){vsns.push([f.shift(),(this.flavour==&quot;insert&quot;?&quot;gains&quot;:&quot;becomes&quot;)])\n}}else{if(this.flavour==&quot;insert&quot;||(this.flavour==&quot;continue&quot;&amp;&amp;this.trigger==&quot;time&quot;)){vsns.push([&quot;&quot;,&quot;becomes&quot;])}}if(this.flavour==&quot;continue&quot;&amp;&amp;flen){b.nextMatch=k+b.source.slice(k).length;\nvsns.push([b.source.slice(k),vtype])}else{becomes=[&quot;becomes&quot;,&quot;gains&quot;];c=tagcontents(b,begintags,becomes.concat(endtags),endtags,k);\nif(c&amp;&amp;endtags.indexOf(c[1])==-1){while(c){vsns.push(c);c=tagcontents(b,begintags,becomes,endtags,b.nextMatch)}c=tagcontents(b,begintags,[&quot;end&quot;+e],endtags,b.nextMatch)\n}if(!c){throwError(g,&quot;can't find matching end&quot;+e);return}vsns.push(c);if(this.flavour==&quot;continue&quot;){k=b.nextMatch;b.nextMatch=k+b.source.slice(k).length;\nvsns.push([b.source.slice(k),&quot;&quot;])}}if(this.flavour==&quot;remove&quot;){vsns.push([&quot;&quot;,&quot;becomes&quot;])}cn=0;m=insertElement(g,&quot;span&quot;,null,e);\nm.setAttribute(&quot;data-flavour&quot;,this.flavour);h=mkspan(&quot;initial&quot;);vsn=vsns.shift();h.tweecode=vsn[0];showVer(h,true);while(vsns.length&gt;0){if(vsn){vtype=vsn[1]\n}vsn=vsns.shift();h=mkspan(vtype);h.tweecode=vsn[0]}if(typeof this.setup==&quot;function&quot;){this.setup(m,g,f)}}function quantity(m){return(m.children.length-1)+(m.getAttribute(&quot;data-flavour&quot;)==&quot;remove&quot;)\n}function revisionSetup(m,g,f){m.className+=&quot; &quot;+f[0].replace(&quot; &quot;,&quot;_&quot;)}function keySetup(m,g,f){var key=f[0];m.setEventListener(&quot;keydown&quot;,function l(e){var done=!revise(&quot;revise&quot;,m);\nif(done){m.removeEventListener(&quot;keydown&quot;,l)}})}function timeSetup(m,g,f){function cssTimeUnit(s){if(typeof s==&quot;string&quot;){if(s.slice(-2).toLowerCase()==&quot;ms&quot;){return Number(s.slice(0,-2))||0\n}else{if(s.slice(-1).toLowerCase()==&quot;s&quot;){return Number(s.slice(0,-1))*1000||0}}}throwError(g,s+&quot; isn't a CSS time unit&quot;);\nreturn 0}var tm=cssTimeUnit(f[0]);setTimeout(function timefn(){var done=!revise(&quot;revise&quot;,m);if(!done){setTimeout(timefn,tm)\n}},tm)}function hoverSetup(m){var fn,noMouseEnter=(document.head.onmouseenter!==null),m1=m.children[0],m2=m.children[1];if(!m1||!m2){return\n}m1.onmouseenter=function(e){if(this.getAttribute(&quot;data-enabled&quot;)!=&quot;false&quot;){revise(&quot;revise&quot;,this.parentNode)}};m2.onmouseleave=function(e){if(this.getAttribute(&quot;data-enabled&quot;)!=&quot;false&quot;){revise(&quot;revert&quot;,this.parentNode)\n}};if(noMouseEnter){fn=function(n){return function(e){if(!event.relatedTarget||(event.relatedTarget!=this&amp;&amp;!(this.compareDocumentPosition(event.relatedTarget)&amp;Node.DOCUMENT_POSITION_CONTAINED_BY))){this[n]()\n}}};m1.onmouseover=fn(&quot;onmouseenter&quot;);m2.onmouseout=fn(&quot;onmouseleave&quot;)}m=null}function mouseSetup(m){var evt=(document.head.onmouseenter===null?&quot;onmouseenter&quot;:&quot;onmouseover&quot;);\nm[evt]=function(){var done=!revise(&quot;revise&quot;,this);if(done){this[evt]=null}};m=null}function linkSetup(m,g,f){var l=Wikifier.createInternalLink(),p=m.parentNode;\nl.className=&quot;internalLink replaceLink&quot;;p.insertBefore(l,m);l.insertBefore(m,null);l.onclick=function(){var p,done=false;if(m&amp;&amp;m.parentNode==this){done=!revise(&quot;revise&quot;,m);\nscrollWindowTo(m)}if(done){this.parentNode.insertBefore(m,this);this.parentNode.removeChild(this)}};l=null}function visitedSetup(m,g,f){var i,done,shv=state.history[0].variables,os=&quot;once seen&quot;,d=(m.firstChild&amp;&amp;(this.flavour==&quot;insert&quot;?m.firstChild.nextSibling:m.firstChild).tweecode);\nshv[os]=shv[os]||{};if(d&amp;&amp;!shv[os].hasOwnProperty(d)){shv[os][d]=1}else{for(i=shv[os][d];i&gt;0&amp;&amp;!done;i--){done=!revise(&quot;revise&quot;,m,true)\n}if(shv[os].hasOwnProperty(d)){shv[os][d]+=1}}}[{name:&quot;insert&quot;,flavour:&quot;insert&quot;,trigger:&quot;link&quot;,setup:linkSetup},{name:&quot;timedinsert&quot;,flavour:&quot;insert&quot;,trigger:&quot;time&quot;,setup:timeSetup},{name:&quot;insertion&quot;,flavour:&quot;insert&quot;,trigger:&quot;revisemacro&quot;,setup:revisionSetup},{name:&quot;later&quot;,flavour:&quot;insert&quot;,trigger:&quot;visited&quot;,setup:visitedSetup},{name:&quot;keyinsert&quot;,flavour:&quot;insert&quot;,trigger:&quot;key&quot;,setup:keySetup},{name:&quot;replace&quot;,flavour:&quot;replace&quot;,trigger:&quot;link&quot;,setup:linkSetup},{name:&quot;timedreplace&quot;,flavour:&quot;replace&quot;,trigger:&quot;time&quot;,setup:timeSetup},{name:&quot;mousereplace&quot;,flavour:&quot;replace&quot;,trigger:&quot;mouse&quot;,setup:mouseSetup},{name:&quot;hoverreplace&quot;,flavour:&quot;replace&quot;,trigger:&quot;hover&quot;,setup:hoverSetup},{name:&quot;revision&quot;,flavour:&quot;replace&quot;,trigger:&quot;revisemacro&quot;,setup:revisionSetup},{name:&quot;keyreplace&quot;,flavour:&quot;replace&quot;,trigger:&quot;key&quot;,setup:keySetup},{name:&quot;timedremove&quot;,flavour:&quot;remove&quot;,trigger:&quot;time&quot;,setup:timeSetup},{name:&quot;mouseremove&quot;,flavour:&quot;remove&quot;,trigger:&quot;mouse&quot;,setup:mouseSetup},{name:&quot;hoverremove&quot;,flavour:&quot;remove&quot;,trigger:&quot;hover&quot;,setup:hoverSetup},{name:&quot;removal&quot;,flavour:&quot;remove&quot;,trigger:&quot;revisemacro&quot;,setup:revisionSetup},{name:&quot;once&quot;,flavour:&quot;remove&quot;,trigger:&quot;visited&quot;,setup:visitedSetup},{name:&quot;keyremove&quot;,flavour:&quot;remove&quot;,trigger:&quot;key&quot;,setup:keySetup},{name:&quot;continue&quot;,flavour:&quot;continue&quot;,trigger:&quot;link&quot;,setup:linkSetup},{name:&quot;timedcontinue&quot;,flavour:&quot;continue&quot;,trigger:&quot;time&quot;,setup:timeSetup},{name:&quot;mousecontinue&quot;,flavour:&quot;continue&quot;,trigger:&quot;mouse&quot;,setup:mouseSetup},{name:&quot;keycontinue&quot;,flavour:&quot;continue&quot;,trigger:&quot;key&quot;,setup:keySetup},{name:&quot;cycle&quot;,flavour:&quot;cycle&quot;,trigger:&quot;revisemacro&quot;,setup:revisionSetup},{name:&quot;mousecycle&quot;,flavour:&quot;cycle&quot;,trigger:&quot;mouse&quot;,setup:mouseSetup},{name:&quot;timedcycle&quot;,flavour:&quot;cycle&quot;,trigger:&quot;time&quot;,setup:timeSetup},{name:&quot;keycycle&quot;,flavour:&quot;replace&quot;,trigger:&quot;key&quot;,setup:keySetup}].forEach(function(e){e.handler=revisionSpanHandler;\ne.shorthand=([&quot;link&quot;,&quot;mouse&quot;,&quot;hover&quot;].indexOf(e.trigger)&gt;-1);macros[e.name]=e;macros[&quot;end&quot;+e.name]=nullobj;begintags.push(e.name);\nendtags.push(&quot;end&quot;+e.name)});function insideDepartingSpan(elem){var r=elem.parentNode;while(!r.classList.contains(&quot;passage&quot;)){if(r.classList.contains(&quot;revision-span-out&quot;)){return true\n}r=r.parentNode}}function reviseAll(rt,rname){var rall=document.querySelectorAll(&quot;.passage [data-flavour].&quot;+rname),ret=false;\nfor(var i=0;i&lt;rall.length;i++){if(!insideDepartingSpan(rall[i])){ret=revise(rt,rall[i])||ret}}return ret}function revise(rt,r,notrans){var ind2,curr,next,ind=-1,rev=(rt==&quot;revert&quot;),rnd=(rt.indexOf(&quot;random&quot;)&gt;-1),fl=r.getAttribute(&quot;data-flavour&quot;),rc=r.childNodes,cyc=(fl==&quot;cycle&quot;),rcl=rc.length-1;\nfunction doToGainerSpans(n,fn){for(var k=n-1;k&gt;=0;k--){if(rc[k+1].classList.contains(&quot;gains&quot;)){fn(rc[k],notrans)}else{break\n}}}for(var k=0;k&lt;=rcl;k++){if(rc[k].getAttribute(&quot;data-enabled&quot;)==&quot;true&quot;){ind=k}}if(rev){ind-=1}curr=(ind&gt;=0?rc[ind]:(cyc?rc[rcl]:null));\nind2=ind;if(rnd){ind2=(ind+(Math.floor(Math.random()*rcl)))%rcl}next=((ind2&lt;rcl)?rc[ind2+1]:(cyc?rc[0]:null));var docurr=(rev?showVer:hideVer);\nvar donext=(rev?hideVer:showVer);var currfn=function(){if(!(next&amp;&amp;next.classList.contains(&quot;gains&quot;))||rnd){docurr(curr,notrans);\ndoToGainerSpans(ind,docurr,notrans)}};var nextfn=function(){donext(next,notrans);if(rnd){doToGainerSpans(ind2+1,donext,notrans)\n}};if(!rev){currfn();nextfn()}else{nextfn();currfn()}return(cyc?true:(rev?(ind&gt;0):(ind2&lt;rcl-1)))}macros.revert=macros.revise=macros.randomise=macros.randomize={handler:function(a,b,c){var l,rev,rname;\nfunction disableLink(l){l.style.display=&quot;none&quot;}function enableLink(l){l.style.display=&quot;inline&quot;}function updateLink(l){if(l.className.indexOf(&quot;random&quot;)&gt;-1){enableLink(l);\nreturn}var rall=document.querySelectorAll(&quot;.passage [data-flavour].&quot;+rname),cannext,canprev,i,ind,r,fl;for(i=0;i&lt;rall.length;\ni++){r=rall[i],fl=r.getAttribute(&quot;data-flavour&quot;);if(insideDepartingSpan(r)){continue}if(fl==&quot;cycle&quot;){cannext=canprev=true\n}else{if(r.firstChild.getAttribute(&quot;data-enabled&quot;)==!1+&quot;&quot;){canprev=true}if(r.lastChild.getAttribute(&quot;data-enabled&quot;)==!1+&quot;&quot;){cannext=true\n}}}var can=(l.classList.contains(&quot;revert&quot;)?canprev:cannext);(can?enableLink:disableLink)(l)}function toggleText(w){w.classList.toggle(rl+&quot;Enabled&quot;);\nw.classList.toggle(rl+&quot;Disabled&quot;);w.style.display=((w.style.display==&quot;none&quot;)?&quot;inline&quot;:&quot;none&quot;)}var rl=&quot;reviseLink&quot;;if(c.length&lt;2){throwError(a,b+&quot; macro needs 2 parameters&quot;);\nreturn}rname=c.shift().replace(&quot; &quot;,&quot;_&quot;);l=Wikifier.createInternalLink(a,null);l.className=&quot;internalLink &quot;+rl+&quot; &quot;+rl+&quot;_&quot;+rname+&quot; &quot;+b;\nvar v=&quot;&quot;;var end=false;var out=false;if(c.length&gt;1&amp;&amp;c[0][0]==&quot;$&quot;){v=c[0].slice(1);c.shift()}switch(c[c.length-1]){case&quot;end&quot;:end=true;\nc.pop();break;case&quot;out&quot;:out=true;c.pop();break}var h=state.history[0].variables;for(var i=0;i&lt;c.length;i++){var on=(i==Math.max(c.indexOf(h[v]),0));\nvar d=insertElement(null,&quot;span&quot;,null,rl+((on)?&quot;En&quot;:&quot;Dis&quot;)+&quot;abled&quot;);if(on){h[v]=c[i];l.setAttribute(&quot;data-cycle&quot;,i)}else{d.style.display=&quot;none&quot;\n}insertText(d,c[i]);l.appendChild(d)}l.onclick=function(){reviseAll(b,rname);var t=this.childNodes,u=this.getAttribute(&quot;data-cycle&quot;)-0,m=t.length,n,lall,i;\nif((end||out)&amp;&amp;u==m-(end?2:1)){if(end){n=this.removeChild(t[u+1]);n.className=rl+&quot;End&quot;;n.style.display=&quot;inline&quot;;this.parentNode.replaceChild(n,this)\n}else{this.parentNode.removeChild(this);return}}else{toggleText(t[u]);u=(u+1)%m;if(v){h[v]=c[u]}toggleText(t[u]);this.setAttribute(&quot;data-cycle&quot;,u)\n}lall=document.getElementsByClassName(rl+&quot;_&quot;+rname);for(i=0;i&lt;lall.length;i++){updateLink(lall[i])}};l=null}};macros.mouserevise=macros.hoverrevise={handler:function(a,b,c,d){var endtags=[&quot;end&quot;+b],evt=(window.onmouseenter===null?&quot;onmouseenter&quot;:&quot;onmouseover&quot;),t=tagcontents(d,[b],endtags,endtags,d.source.indexOf(&quot;&gt;&gt;&quot;,d.matchStart)+2);\nif(t){var rname=c[0].replace(&quot; &quot;,&quot;_&quot;),h=insertElement(a,&quot;span&quot;,null,&quot;hoverrevise hoverrevise_&quot;+rname),f=function(){var done=!reviseAll(&quot;revise&quot;,rname);\nif(b!=&quot;hoverrevise&quot;&amp;&amp;done){this[evt]=null}};new Wikifier(h,t[0]);if(b==&quot;hoverrevise&quot;){h.onmouseover=f;h.onmouseout=function(){reviseAll(&quot;revert&quot;,rname)\n}}else{h[evt]=f}h=null}}};macros.instantrevise={handler:function(a,b,c,d){reviseAll(&quot;revise&quot;,c[0].replace(&quot; &quot;,&quot;_&quot;))}};macros.endmouserevise=nullobj;\nmacros.endhoverrevise=nullobj}());</div><div tiddler="Leon's Goto" tags="script" created="201602092239" modifier="twee" twine-position="0,0">version.extensions.timedgotoMacro={major:1,minor:2,revision:0};\nmacros[&quot;goto&quot;]=macros.timedgoto={timer:null,handler:function(a,b,c,d){function cssTimeUnit(s){if(typeof s==&quot;string&quot;){if(s.slice(-2).toLowerCase()==&quot;ms&quot;){return +(s.slice(0,-2))||0\n}else{if(s.slice(-1).toLowerCase()==&quot;s&quot;){return +(s.slice(0,-1))*1000||0\n}}}throwError(a,s+&quot; isn't a CSS time unit&quot;);return 0}var t,d,m,s;\nt=c[c.length-1];d=d.fullArgs();m=0;if(b!=&quot;goto&quot;){d=d.slice(0,d.lastIndexOf(t));\nm=cssTimeUnit(t)}d=eval(Wikifier.parse(d));if(d+&quot;&quot;&amp;&amp;state&amp;&amp;state.init){if(macros[&quot;goto&quot;].timer){clearTimeout(macros[&quot;goto&quot;].timer)\n}s=state.history[0].passage.title;macros[&quot;goto&quot;].timer=setTimeout(function(){if(state.history[0].passage.title==s){state.display(d,a)\n}},m)}}};</div><div tiddler="Leon's Tag" tags="script" created="201602092239" modifier="twee" twine-position="0,0">version.extensions[&quot;toggletagMacros&quot;]={major:1,minor:1,revision:0};\nmacros[&quot;toggletag&quot;]={\n  handler:function(a,b,c){\n    var p=e(a);\n    var d=document.body;\n    if(p){\n      var t=p.getAttribute(&quot;data-tags&quot;);\n      var i=t.indexOf(c[0]);\n      if(b!=&quot;addtag&quot;&amp;&amp;i&gt;=0){\n        var r=t.replace(c[0],&quot;&quot;);\n        p.setAttribute(&quot;data-tags&quot;,r);\n        d.setAttribute(&quot;data-tags&quot;,r);\n      }\n      else{\n        if(b!=&quot;removetag&quot;&amp;&amp;i&lt;0){\n          var r=t+&quot; &quot;+c[0];\n          p.setAttribute(&quot;data-tags&quot;,r);\n          d.setAttribute(&quot;data-tags&quot;,r);\n        }\n      }\n    }\n    function e(f){\n      while(f.parentNode&amp;&amp;!f.classList.contains(&quot;passage&quot;)){\n        f=f.parentNode;\n      }\n      if(f!=document&amp;&amp;f.getAttribute(&quot;data-tags&quot;)){return f;}\n      return null;\n    }\n  }\n};\nmacros[&quot;addtag&quot;]=macros[&quot;toggletag&quot;];macros[&quot;removetag&quot;]=macros[&quot;toggletag&quot;];</div><div tiddler="9999 Macro while.twee" tags="script" created="201602092239" modifier="twee" twine-position="0,0">try { \n\nversion.extensions.whileMacros = {\n    major: 1, minor: 0, revision: 0\n};\n\nmacros['while'] = { \n  handler: function(place, macroName, params, parser) {\n    var srcOffset = parser.source.indexOf(&quot;&gt;&gt;&quot;, parser.matchStart) + 2,\n      src = parser.source.slice(srcOffset),\n      endPos = -1,\n      condition = parser.fullArgs().trim(),\n      body = &quot;&quot;,\n      nestlevel = 0,\n      i = 0;\n        \n    for (; i &lt; src.length; i++) {\n      if (src.substr(i, 8) == &quot;&lt;&lt;while &quot;) {\n        nestlevel++;\n      }\n      if (src.substr(i, 12) == &quot;&lt;&lt;endwhile&gt;&gt;&quot;) {\n        nestlevel--;\n        if (nestlevel &lt; 0) {\n          endPos = srcOffset + i + 12;\n          break;\n        }\n      }\n      body += src.charAt(i);\n    }\n    body = body.trim();\n\n    if (endPos != -1) {\n      parser.nextMatch = endPos;\n      try {\n        while (internalEval(condition)) {\n          new Wikifier(place, body);\n        }\n      } catch (e) {\n        throwError(place, &quot;&lt;&lt;while&gt;&gt; bad condition: &quot; + condition, parser.fullMatch());\n      }\n    } else {\n      throwError(place, &quot;I can't find a matching &lt;&lt;endwhile&gt;&gt;&quot;, parser.fullMatch());\n    }\n  },\n  init: function() { }\n};\n\nmacros[&quot;endwhile&quot;] = {\n  handler: function () {}\n};\n\n} catch(e) { \n  throwError(place,&quot;Macro while Error: &quot;+e.message); \n}</div><div tiddler="Own Sound" tags="script" created="201602092239" modifier="twee" twine-position="0,0">//requires jQuery\nmacros['checkpassage'] = {\n  handler: function(place, macroName, params, parser) {\n    var k = &quot;[tiddler='&quot;+params[0]+&quot;']&quot;;\n    if (document.querySelector(k) != undefined) {\n        $(&quot;[tiddler='VERBRESULTPASSAGE']&quot;).html(document.querySelector(k).innerHTML);\n      } else {\n        $(&quot;[tiddler='VERBRESULTPASSAGE']&quot;).text(params[1]);\n      }\n  }\n}</div><div tiddler="Sugarcube CSS" tags="stylesheet" created="201602092239" modifier="twee" twine-position="0,0">/* APPEARANCE */\n\n@import url(http://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic&amp;subset=cyrillic,latin);\n@import url(http://fonts.googleapis.com/css?family=Comfortaa:700&amp;subset=cyrillic);\n\nbody {\n\t/*запретить выделение текста игроком\n\t-webkit-touch-callout: none;\n\t-webkit-user-select: none;\n\t-khtml-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\tuser-select: none;*/\n\tcursor: default;\n\n\tcolor: #fff;\n\tbackground-color: #111;\n\tfont-family: 'PT Sans', sans-serif;\n\tfont-size: 16px;\n\t/*white-space: pre-wrap;*/\n\ttab-size: 4;\n}\na {\n\tcursor: pointer;\n\tcolor: #CC9933;\n}\na:hover {\n\tcolor: #CC9933;\n}\na:active {\n\tcolor: #f70;\n}\na.link-internal, a.link-external {\n\tfont-weight: bold;\n\t/*font-weight: normal;*/\n\ttext-decoration: none;\n}\na.link-internal:hover, a.link-external:hover {\n\ttext-decoration: none;\n}\na.link-broken {\n\tpadding: 3px;\n\tcolor: #000;\n\tbackground-color: red;\n\tfont-weight: bold;\n\ttext-decoration: none;\n}\nhr {\n\theight: 1px;\n\tborder: none;\n\tbackground-color: #fff;\n}\ninput, textarea {\n\tcolor: #fff;\n\tbackground-color: #333;\n\tborder: 1px solid #fff;\n}\ninput[type=&quot;text&quot;], textarea {\n\tmin-width: 16em;\n}\ninput {\n\tpadding: 2px 3px;\n}\ninput:focus, textarea:focus {\n\tborder: 1px solid #292;\n}\ninput:hover, textarea:hover {\n\tborder: 1px solid #f70;\n}\ntextarea {\n\toverflow: auto; /* fixes IE inanity */\n}\nbutton {\n\tcursor: pointer;\n\tpadding: 4px 6px;\n\tcolor: #fff;\n\tbackground-color: #36c;\n\tborder: 1px solid #58e;\n\t-webkit-border-radius: 4px;\n\t-moz-border-radius: 4px;\n\tborder-radius: 4px;\n\ttext-decoration: none;\n\ttext-shadow: 1px 1px rgba(0, 0, 0, 0.4);\n\t-webkit-transition-duration: 200ms;\n\t-moz-transition-duration: 200ms;\n\ttransition-duration: 200ms;\n}\nbutton:hover {\n\tbackground-color: #58e;\n\tborder-color: #7af;\n}\nbutton:active {\n\tbackground-color: #f70;\n\tborder-color: #f92;\n}\nabbr {\n\tborder-bottom: none;\n\t/*border-bottom: 1px dotted white;*/ /* подчёркивание под хинтом */\n}\n\n.music a.link-external{\n\tcolor: #46D;\n}\n.error {\n\tmargin: 0 12px 0 3px;\n\tpadding: 3px 5px;\n\tcolor: #000;\n\tbackground-color: red;\n\tfont-weight: bold;\n}\n.error[title] {\n\tcursor: help;\n}\n.highlight, .marked {\n\tcolor: yellow;\n\tfont-weight: bold;\n\tfont-style: italic;\n}\n.nobr {\n\twhite-space: nowrap;\n}\n.transition-in {\n\topacity: 0;\n}\n\n#ui-bar {\n\tbackground-color: #222;\n\tborder-right: 1px solid #fff;\n}\n#ui-bar header, #menu, #ui-bar footer {\n\ttext-align: right;\n}\n#ui-bar header, #menu {\n\tfont-weight: bold;\n}\n#menu, #ui-bar footer {\n\tmargin-top: 3em;\n}\n#menu ul {\n\tmargin: 1em 0;\n\tpadding: 0;\n\tlist-style: none;\n}\n#menu li {\n\tmargin-bottom: 1em;\n}\n#menu li a {\n\ttext-decoration: none;\n}\n#menu ul:last-child, #menu ul:last-child li:last-child {\n\tmargin-bottom: 0;\n}\n\n#story-title {\n\tmargin: 0;\n\tfont-size: 210%;\n}\n#story-subtitle {\n\tfont-size: 111%;\n}\n#story-author {\n\tfont-size: 111%;\n}\n#story-caption {\n\tmargin-top: 3em;\n\ttext-align: right;\n}\n\n[data-icon], a.link-back:before, a.link-return:after, a.link-external:after,\n#menu-saves a:before, #menu-rewind a:before, #menu-restart a:before, #menu-options a:before, #menu-share a:before,\n#ui-body-close, #ui-body.options a[id|=&quot;option-input&quot;]:before, #ui-body.options a[id|=&quot;option-input&quot;].enabled:before {\n\tfont-family: 'icomoon-sugarcube';\n\tspeak: none;\n\tfont-style: normal;\n\tfont-weight: normal;\n\tfont-variant: normal;\n\ttext-transform: none;\n\tline-height: 1;\n\t-webkit-font-smoothing: antialiased;\n\t-moz-osx-font-smoothing: grayscale;\n}\n[data-icon]:before {\n\tcontent: attr(data-icon) &quot;\s00a0\s00a0&quot;;\n}\na.link-back:before {\n\tcontent: &quot;\se00a\s00a0\s00a0&quot;;\n}\na.link-return:after {\n\tcontent: &quot;\s00a0\s00a0\se00b&quot;;\n}\n#passages a.link-external:after {\n\t/*content: &quot;\s00a0\se010&quot;;*/ /* значок внешней ссылки */\n\tcontent: none;\n}\n#menu-saves a:before {\n\tcontent: &quot;\se011\s00a0\s00a0&quot;;\n}\n#menu-rewind a:before {\n\tcontent: &quot;\se012\s00a0\s00a0&quot;;\n}\n#menu-restart a:before {\n\tcontent: &quot;\se013\s00a0\s00a0&quot;;\n}\n#menu-options a:before {\n\tcontent: &quot;\se014\s00a0\s00a0&quot;;\n}\n#menu-share a:before {\n\tcontent: &quot;\se015\s00a0\s00a0&quot;;\n}\n\n#credits, #version {\n\tmargin-top: 1em;\n\tcolor: #999;\n\tfont-weight: normal;\n\tfont-size: 71%;\n}\n\n/* Default menu styling */\n#ui-overlay {\n\topacity: 0.8;\n\tbackground-color: #000;\n}\n#ui-body-close {\n\topacity: 1;\n\tcursor: pointer;\n\tfont-size: 111%;\n\tmargin: 0;\n\tpadding: 3px 4px;\n\tfont-weight: normal;\n\tcolor: #fff;\n\tbackground-color: #36c;\n\tborder: 1px solid #58e;\n\t-webkit-border-radius: 4px;\n\t-moz-border-radius: 4px;\n\tborder-radius: 4px;\n\ttext-decoration: none;\n\ttext-shadow: 1px 1px rgba(0, 0, 0, 0.4);\n\t-webkit-transition-duration: 200ms;\n\t-moz-transition-duration: 200ms;\n\ttransition-duration: 200ms;\n}\n#ui-body-close:hover {\n\tbackground-color: #58e;\n\tborder-color: #7af;\n}\n#ui-body-close:active {\n\tbackground-color: #f70;\n\tborder-color: #f92;\n}\n#ui-body {\n\topacity: 1;\n\tbackground-color: #222;\n\tborder: 1px solid #fff;\n\ttext-align: left;\n\tline-height: 2;\n}\n#ui-body div {\n\tpadding: 0.2em;\n}\n\n/* Default menu button styling */\n#ui-body &gt; ul &gt; li + li &gt; button {\n\tmargin-left: 12px;\n}\n\n/* General dialog styling */\n#ui-body.dialog {\n\tmin-width: 280px;\n\tpadding: 0.33em 1em 0.66em;\n}\n#ui-body.dialog &gt; ul {\n\tdisplay: block;\n\twidth: 100%;\n\tmargin: 0;\n\tpadding: 0;\n\tlist-style: none;\n\ttext-align: left;\n}\n#ui-body.dialog &gt; ul li {\n\tdisplay: inline-block;\n\tmargin: 0;\n\tpadding: 0.4em 0.4em 0.5em;\n}\n\n/* List-based dialog styling (primarily for the Rewind &amp; Share menus) */\n#ui-body.dialog-list ul {\n\tmargin: 0;\n\tpadding: 0;\n\tlist-style: none;\n}\n#ui-body.dialog-list li {\n\tmargin: 0;\n}\n#ui-body.dialog-list li:nth-child(even) {\n\tbackground-color: rgba(255,255,255,0.08);\n}\n#ui-body.dialog-list li a {\n\tdisplay: block;\n\tpadding: 0.25em 0.75em;\n\tcolor: #fff;\n\tfont-weight: normal;\n\ttext-decoration: none;\n}\n#ui-body.dialog-list li a:hover {\n\tbackground-color: #47b;\n}\n#ui-body.dialog-list li a:active {\n\tbackground-color: #f70;\n}\n\n/* Saves menu styling */\n#ui-body.saves table {\n\tborder-spacing: 0;\n\tmin-width: 320px;\n\twidth: 100%;\n}\n#ui-body.saves tr:nth-child(even) {\n\tbackground-color: rgba(255,255,255,0.08);\n}\n#ui-body.saves td {\n\tpadding: 0.33em 0.33em;\n\tline-height: 1.2;\n}\n#ui-body.saves td:first-child {\n\tmin-width: 1.5em;\n\ttext-align: center;\n}\n#ui-body.saves .empty {\n\tcolor: #999;\n}\n#ui-body.saves ul {\n\tdisplay: block;\n\tmargin: 0;\n\tpadding: 0;\n\tlist-style: none;\n\twhite-space: nowrap;\n}\n#ui-body.saves li {\n\tdisplay: inline-block;\n\tmargin: 0;\n\tpadding: 0.33em 0.33em 0.4em;\n}\n#ui-body.saves &gt; div:not(:first-child) {\n\tborder-top: 1px solid #fff;\n}\n#saves-import-label {\n\tmargin: 0 6px;\n\tfont-weight: bold;\n}\n#saves-import-file {\n\tmargin: 0 6px 6px;\n}\n\n/* Options menu styling */\n#ui-body.options div[id|=&quot;option-body&quot;] + div[id|=&quot;option-body&quot;],\n#ui-body.options div[id|=&quot;option-body&quot;] + br + div[id|=&quot;option-body&quot;] {\n\tmargin-top: 0.5em;\n}\n#ui-body.options select[id|=&quot;option-input&quot;] {\n\tcursor: pointer;\n\tpadding: 3px 6px;\n\tfont-weight: normal;\n\tcolor: #fff;\n\tbackground-color: #36c;\n\tborder: 1px solid #58e;\n\t-webkit-border-radius: 4px;\n\t-moz-border-radius: 4px;\n\tborder-radius: 4px;\n\ttext-decoration: none;\n\ttext-shadow: 1px 1px rgba(0, 0, 0, 0.4);\n\t-webkit-transition-duration: 200ms;\n\t-moz-transition-duration: 200ms;\n\ttransition-duration: 200ms;\n\twhite-space: nowrap;\n}\n#ui-body.options a[id|=&quot;option-input&quot;] {\n\tcursor: pointer;\n\tpadding: 4px 6px;\n\tfont-weight: normal;\n\tcolor: #fff;\n\tbackground-color: #36c;\n\tborder: 1px solid #58e;\n\t-webkit-border-radius: 4px;\n\t-moz-border-radius: 4px;\n\tborder-radius: 4px;\n\ttext-decoration: none;\n\ttext-shadow: 1px 1px rgba(0, 0, 0, 0.4);\n\t-webkit-transition-duration: 200ms;\n\t-moz-transition-duration: 200ms;\n\ttransition-duration: 200ms;\n\twhite-space: nowrap;\n}\n#ui-body.options a[id|=&quot;option-input&quot;]:hover {\n\tbackground-color: #58e;\n\tborder-color: #7af;\n}\n#ui-body.options a[id|=&quot;option-input&quot;].enabled {\n\tbackground-color: #292;\n\tborder-color: #4b4;\n}\n#ui-body.options a[id|=&quot;option-input&quot;].enabled:hover {\n\tbackground-color: #4b4;\n\tborder-color: #6d6;\n}\n#ui-body.options a[id|=&quot;option-input&quot;]:before {\n\tcontent: &quot;\se002\s00a0\s00a0&quot;;\n}\n#ui-body.options a[id|=&quot;option-input&quot;].enabled:before {\n\tcontent: &quot;\se003\s00a0\s00a0&quot;;\n}\n\n/* Passages area styling */\n.passage {\n\t/*line-height: 1.75;*/\n\tline-height: normal;\n\ttext-align: left;\n\ttransition: opacity 0ms ease-in;\n\t-webkit-transition: opacity 0ms ease-in;\n}\n.passage ul, .passage ol {\n\tmargin-left: 0.5em;\n\tpadding-left: 1.5em;\n}\n.passage table {\n\tmargin: 1em 0;\n\tborder-collapse: collapse;\n\tfont-size: 100%;\n}\n.passage tr, .passage th, .passage td, .passage caption {\n\tpadding: 5px;\n\tborder: 1px solid #000;\n}\n\n\n/* STRUCTURAL */\n\n\nbody {\n\t/*margin: 3.5em 3.5em 3.5em 21em;*/\n\tmargin: 1.5em 25% 1.5em 25%;\n}\n\n#store-area {\n\tdisplay: none;\n\tz-index: 0;\n}\n\n#ui-bar {\n\tdisplay: none;\n\tposition: fixed;\n\tz-index: 50;\n\ttop: 0;\n\tleft: 0;\n\twidth: 14.5em;\n\theight: 100%;\n\tmargin: 0;\n\tpadding: 3.5em 1.5em 0 3.5em;\n}\n\n/* Default dialog styling */\nhtml.ui-open body {\n\toverflow: hidden;\n}\n#ui-overlay {\n\tdisplay: none;\n\tz-index: 1000;\n\tposition: fixed;\n\ttop: 0px;\n\tleft: 0px;\n\theight: 100%;\n\twidth: 100%;\n}\n#ui-body-close {\n\tdisplay: none;\n\tz-index: 1110;\n\tposition: fixed;\n\twhite-space: nowrap;\n}\n#ui-body {\n\tdisplay: none;\n\tz-index: 1100;\n\tposition: fixed;\n\toverflow: auto;\n\tmin-width: 140px;\n\tmax-width: 90%;\n\tmax-height: 90%;\n}\n\n/* Options dialog styling */\n#ui-body.options [id|=&quot;option-body&quot;] {\n\tdisplay: table;\n\twidth: 100%;\n}\n#ui-body.options [id|=&quot;option-label&quot;] {\n\tdisplay: table-cell;\n\twidth: 80%;\n\tpadding: 0.33em 2em 0.4em 0.33em;\n}\n#ui-body.options [id|=&quot;option-control&quot;] {\n\tdisplay: table-cell;\n\tpadding: 0.33em 0.33em 0.4em;\n\twhite-space: nowrap;\n}\n\n/* Passages area styling */\n#passages {\n\tz-index: 10;\n\t/*margin-right: 26%;*/\n\tmargin-right: 0px;\n    padding: 1em 1em;\n    border-radius: 5px;\n    box-shadow: 0 0 20px #592500;\n    background-color: #FFF;\n}\n\n/* Stop text selection on UI widgets */\nbutton, #ui-body-close, #ui-body.dialog-list a, #ui-body.options a[id|=&quot;option-input&quot;] {\n\t-webkit-user-select: none;\n\t-khtml-user-select: none;\n\t-moz-user-select: none;\n\t-ms-user-select: none;\n\t-o-user-select: none;\n\tuser-select: none;\n}\n\n\n/* MEDIA-QUERIES */\n\n\n/* Increase viewport utilization as its size decreases. */\n@media screen and (max-width: 1440px) {\n\t#passages {\n\t\t/*margin-right: 8%;*/\n\t}\n}\n@media screen and (max-width: 1136px) {\n\tbody {\n\t\t/*margin: 3.5% 3.5% 3.5% 20em;*/\n\t\tmargin: 1.5% 20% 1.5% 20%;\n\t}\n\t#ui-bar {\n\t\tpadding-top: 3.5%;\n\t\tpadding-left: 2.5em;\n\t}\n\t#passages {\n\t\tmargin: 0;\n\t}\n}\n\n\n/* MEDIA-QUERIES-NARROW */\n\n\n\n/* Handle very narrow viewports. */\n@media screen and (max-width: 1000px) {\n\tbody {\n\t\tmargin: 0;\n\t}\n\t#ui-bar {\n\t\tposition: relative;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: auto;\n\t\theight: auto;\n\t\tmargin: 0;\n\t\tpadding: 2.5% 3.5% 0;\n\t\tborder: none;\n\t\tborder-bottom: 1px solid #fff;\n\t}\n\t#ui-bar header, #story-caption, #ui-bar footer {\n\t\ttext-align: left;\n\t\twidth: 66%;\n\t}\n\t#menu {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tright: 0;\n\t\tmargin: 2.5% 3.5% 0 0;\n\t}\n\t#menu ul {\n\t\tmargin: 0;\n\t}\n\t#menu li {\n\t\tmargin-bottom: 0.5em;\n\t}\n\t#passages {\n\t\twidth: auto;\n\t\tmargin: 1.5em 3.5% 3.5%;\n\t}\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/*************************************************************\n* BLEACHED - A primarily white style for SugarCube (v1.0.4+) *\n*************************************************************/\nbody {\n\tcolor: #333;\n\tbackground-color: saddlebrown;\n}\na {\n\tcolor: #5A8BBC;\n}\na:hover {\n\tcolor: #5A8BBC;\n}\na:active {\n\t/*color: #f70;*/\n}\nhr {\n\theight: 1px;\n\tborder: none;\n\tbackground-color: #000;\n}\ninput, textarea {\n\tcolor: #000;\n\tbackground-color: #ddd;\n\tborder-color: #000;\n}\n#ui-bar, #ui-body {\n\tbackground-color: #eee;\n\tborder-color: #000;\n}\n#credits, #version {\n\tcolor: #6f6f6f;\n}\nbutton, #ui-body-close,\n#ui-body.options a[id|=&quot;option-input&quot;],\n#ui-body.options select[id|=&quot;option-input&quot;] {\n\tborder-color: #36c;\n}\nbutton:hover, #ui-body-close:hover,\n#ui-body.options a[id|=&quot;option-input&quot;]:hover {\n\tborder-color: #58e;\n}\nbutton:active, #ui-body-close:active {\n\tborder-color: #f70;\n}\n#ui-body.options a[id|=&quot;option-input&quot;].enabled {\n\tborder-color: #292;\n}\n#ui-body.options a[id|=&quot;option-input&quot;].enabled:hover {\n\tborder-color: #4b4;\n}\n#ui-body.dialog-list li:nth-child(even) {\n\tbackground-color: rgba(0,0,0,0.07);\n}\n#ui-body.dialog-list li a {\n\tcolor: #222;\n}\n#ui-body.dialog-list li a:hover {\n\tcolor: #fff;\n\tbackground-color: #47b;\n}\n#ui-body.dialog-list li a:active {\n\tcolor: #fff;\n\tbackground-color: #f70;\n}\n#ui-body.saves table {\n\tborder-color: #000;\n}\n#ui-body.saves tr:nth-child(even) {\n\tbackground-color: rgba(0,0,0,0.07);\n}\n#ui-body.saves .empty {\n\tcolor: #444;\n}\n#ui-body.saves &gt; div:not(:first-child) {\n\tborder-color: #000;\n}\n\n\n#story {\n\tmargin: 0;\n}\n\n.disclaimer {\n\twidth: 100%;\n\theight: 400px;\n\tbackground-color: black;\n\tcolor: white;\n\tfont-size: 20px;\n\tfont-weight: bold;\n    text-align: center;\n    border-radius: 5px;\n}\n\n.title {\n\tbackground-color: white;\n}\n\n.disclaimer table{\n\twidth: 100%;\n\theight: 100%;\n}\n\n.disclaimer table, .disclaimer th, .disclaimer tr {\n\tmargin: 0;\n\tpadding: 0;\n\tborder: none;\n}\n\n.plus18 {\n\tline-height: 2.5em;\n\twidth: 2.5em;\n\tmargin: auto;\n\tfont-size: 30px;\n\tborder: 5px solid red;\n\tborder-radius: 2em;\n}\n\n.warning {\n}\n\n.decor &gt; a {\n\tcolor: saddlebrown;\n}\n\n.notab {\n\twhite-space: normal;\n}\n\n.actions, .outcome {\n\tdisplay: block;\n\ttext-align: center;\n}\n\n.hidden {\n\tdisplay: none;\n}\n\n.events {\n\tfont-style: italic;\n}\n\n.fluence &gt; a {\n\tcolor: green;\n}\n\n.turnoff &gt; a {\n\tcolor: inherit;\n    pointer-events: none;\n    cursor: default;\n    text-decoration: none;\n}\n\n.commandline {\n\toverflow: hidden;\n\tmargin-bottom: 1em;\n\tbackground-color: #333;\n\tcolor: white;\n    border-radius: 5px;\n    font-size: 14px;\n}\n\n.hint {\n\tfloat:left;\n\tmargin: 0;\n\tpadding: 0.3em 0.5em;\n}\n\n.hint &gt; a {\n\tcolor: inherit;\n\tfont-weight: normal;\n}\n\n.hint &gt; a:hover {\n\ttext-decoration: underline;\n}\n\n.drunkness {\n\tfloat:right;\n\tmargin: 0;\n\tpadding: 0.3em 0.5em;\n}\n\n.drunkness100 {\n\t-webkit-filter: blur(1px);\n\tfilter: blur(1px);\n}\n\n.drunkness110 {\n\t-webkit-filter: blur(1.2px);\n\tfilter: blur(1.2px);\n}\n\n.drunkness120 {\n\t-webkit-filter: blur(1.5px);\n\tfilter: blur(1.5px);\n}</div></div>
	<script id="script-sugarcube" type="text/javascript">
	/*! SugarCube JS

	SugarCube includes code from TiddlyWiki 1.2.39, which has the following license:
	--------------------------------------------------------------------------------

	TiddlyWiki 1.2.39 by Jeremy Ruston, (jeremy [at] osmosoft [dot] com)

	Published under a BSD open source license

	Copyright (c) Osmosoft Limited 2005

	Redistribution and use in source and binary forms, with or without modification,
	are permitted provided that the following conditions are met:

	Redistributions of source code must retain the above copyright notice, this list
	of conditions and the following disclaimer.

	Redistributions in binary form must reproduce the above copyright notice, this
	list of conditions and the following disclaimer in the documentation and/or
	other materials provided with the distribution.

	Neither the name of the Osmosoft Limited nor the names of its contributors may
	be used to endorse or promote products derived from this software without
	specific prior written permission.

	THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
	ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
	WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
	DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
	ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
	(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
	LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
	ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
	(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
	SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
	*/
	if(document.documentElement.classList.contains("init-loading")){!function(window,document,jQuery,undefined){"use strict";function alertUser(e,t,r,a){var n="Apologies! A "+e+" problem has occurred.";switch(e){case"fatal":n+=" Aborting.";break;case"technical":n+=" You may be able to continue, but some parts may not work properly."}(null!=t||null!=r)&&(n+="\n\nError",null!=t&&(n+=" ["+t+"]"),n+=": "+(null!=r?r.replace(/^(?:(?:Uncaught\s+)?Error:\s+)+/,""):"unknown error")+"."),a&&a.stack&&(n+="\n\nStack Trace:\n"+a.stack),window.alert(n)}function fatalAlert(e,t,r){alertUser("fatal",e,t,r)}function technicalAlert(e,t,r){alertUser("technical",e,t,r)}function clone(e){if("object"!=typeof e||null==e)return e;if("function"==typeof e.clone)return e.clone(!0);if(e.nodeType&&"function"==typeof e.cloneNode)return e.cloneNode(!0);var t;if(Array.isArray(e))t=[];else switch(Object.prototype.toString.call(e)){case"[object Date]":t=new Date(e.getTime());break;case"[object Map]":t=new Map,e.forEach(function(e,r){t.set(r,clone(e))});break;case"[object RegExp]":t=new RegExp(e);break;case"[object Set]":t=new Set,e.forEach(function(e){t.add(clone(e))});break;default:var r=Object.getPrototypeOf(e);t=r?Object.create(r):e.constructor.prototype}return Object.keys(e).forEach(function(r){t[r]=clone(e[r])}),t}function addAccessibleClickHandler(e,t,r,a,n){if(arguments.length<2)throw new Error("addAccessibleClickHandler insufficient number of parameters");if("function"==typeof t&&(n=a,a=r,r=t,t=undefined),"function"!=typeof r)throw new TypeError("addAccessibleClickHandler handler parameter must be a function");return jQuery(e).ariaClick({namespace:n,one:!!a,selector:t},r)}function insertElement(e,t,r,a,n,i){var s=document.createElement(t);return r&&(s.id=r),a&&(s.className=a),i&&(s.title=i),n&&insertText(s,n),e&&e.appendChild(s),s}function insertText(e,t){return e.appendChild(document.createTextNode(t))}function removeChildren(e){if(e)for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function removeElement(e){"function"==typeof e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)}function convertBreaksToParagraphs(e){for(var t,r=document.createDocumentFragment(),a=document.createElement("p");null!==(t=e.firstChild);){if(t.nodeType===Node.ELEMENT_NODE){var n=t.nodeName.toUpperCase();switch(n){case"BR":if(null!==t.nextSibling&&t.nextSibling.nodeType===Node.ELEMENT_NODE&&"BR"===t.nextSibling.nodeName.toUpperCase()){e.removeChild(t.nextSibling),e.removeChild(t),r.appendChild(a),a=document.createElement("p");continue}if(!a.hasChildNodes()){e.removeChild(t);continue}break;case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":a.hasChildNodes()&&(r.appendChild(a),a=document.createElement("p")),r.appendChild(t);continue}}a.appendChild(t)}a.hasChildNodes()&&r.appendChild(a),e.appendChild(r)}function setPageElement(e,t,r){var a="object"==typeof e?e:document.getElementById(e);if(null==a)return null;removeChildren(a),Array.isArray(t)||(t=[t]);for(var n=0,i=t.length;i>n;++n)if(Story.has(t[n]))return new Wikifier(a,Story.get(t[n]).processText().trim()),a;return null!=r&&(r=r.trim(),""!==r&&new Wikifier(a,r)),a}function addStyle(e){var t=document.getElementById("style-story");null===t&&(t=document.createElement("style"),t.id="style-story",t.type="text/css",document.head.appendChild(t)),t=new StyleWrapper(t);var r=/\[[<>]?[Ii][Mm][Gg]\[(?:\s|\S)*?\]\]+/g;r.test(e)&&(e=e.replace(r,function(e){var t=Wikifier.helpers.parseSquareBracketedMarkup({source:e,matchStart:0});if(t.hasOwnProperty("error")||t.pos<e.length)return e;var r=t.source;if("data:"!==r.slice(0,5)&&Story.has(r)){var a=Story.get(r);a.tags.contains("Twine.image")&&(r=a.text)}return'url("'+r.replace(/"/g,"%22")+'")'})),t.add(e)}function throwError(e,t,r){return insertElement(e,"span",null,"error",strings.errors.title+": "+t,r),!1}function printableStringOrDefault(e,t){switch(typeof e){case"number":if(isNaN(e))return t;break;case"object":return null===e?t:Array.isArray(e)||e instanceof Set?Array.from(e).map(function(e){return printableStringOrDefault(e,t)}).join(", "):e instanceof Map?Array.from(e).map(function(e){return"("+printableStringOrDefault(e[0],t)+" ⇒ "+printableStringOrDefault(e[1],t)+")"}).join(", "):e instanceof Date?e.toLocaleString():"[object]";case"function":case"undefined":return t}return String(e)}function safeActiveElement(){try{return document.activeElement||null}catch(e){return null}}function fade(e,t){function r(){n+=.05*o,a(s,Math.easeInOut(n)),(1===o&&n>=1||-1===o&&0>=n)&&(e.style.visibility="in"===t.fade?"visible":"hidden",s.parentNode.replaceChild(e,s),s=null,window.clearInterval(i),t.onComplete&&t.onComplete())}function a(e,t){var r=Math.floor(100*t);e.style.zoom=1,e.style.filter="alpha(opacity="+r+")",e.style.opacity=t}var n,i,s=e.cloneNode(!0),o="in"===t.fade?1:-1;e.parentNode.replaceChild(s,e),"in"===t.fade?(n=0,s.style.visibility="visible"):n=1,a(s,n),i=window.setInterval(r,25)}function scrollWindowTo(e,t){function r(){l+=t,window.scroll(0,i+u*o*Math.easeInOut(l)),l>=1&&window.clearInterval(c)}function a(e){for(var t=0;e.offsetParent;)t+=e.offsetTop,e=e.offsetParent;return t}function n(e){var t=a(e),r=t+e.offsetHeight,n=window.scrollY?window.scrollY:document.body.scrollTop,i=window.innerHeight?window.innerHeight:document.body.clientHeight,s=n+i;return n>t?t:r>s&&e.offsetHeight<i?t-(i-e.offsetHeight)+20:t}null==t?t=.1:("number"!=typeof t&&(t=Number(t)),isNaN(t)||0>t?t=.1:t>1&&(t=1));var i=window.scrollY?window.scrollY:document.body.scrollTop,s=n(e),o=Math.abs(i-s),l=0,u=i>s?-1:1,c=window.setInterval(r,25)}function SeedablePRNG(e,t){Object.defineProperties(this,new Math.seedrandom(e,t,function(e,t){return{_prng:{value:e},seed:{writable:!0,value:t},pull:{writable:!0,value:0},random:{value:function(){return++this.pull,this._prng()}}}}))}function StyleWrapper(e){if(null==e)throw new TypeError("StyleWrapper style parameter must be an HTMLStyleElement object");Object.defineProperties(this,{style:{value:e}})}function AudioWrapper(e){Object.defineProperties(this,{audio:{value:e},_faderId:{writable:!0,value:null}})}function MacroContext(e){if(e=Object.assign({parent:null,macro:null,name:"",rawArgs:"",args:[],payload:null,parser:null,source:""},e),null===e.macro||""===e.name||null===e.parser)throw new TypeError("context object missing required properties");Object.defineProperties(this,{parent:{value:e.parent},self:{value:e.macro},name:{value:e.name},args:{value:e.args},payload:{value:e.payload},parser:{value:e.parser},output:{value:e.parser.output},source:{value:e.source}}),Object.defineProperties(this.args,{raw:{value:e.rawArgs},full:{value:Wikifier.parse(e.rawArgs)}})}function getWikifyEvalHandler(e,t,r){return function(){if(""!==e){var a;try{"undefined"!=typeof t&&(State.variables.hasOwnProperty("args")&&(a=State.variables.args),State.variables.args=t),Wikifier.wikifyEval(e)}finally{"undefined"!=typeof t&&(delete State.variables.args,"undefined"!=typeof a&&(State.variables.args=a))}}"function"==typeof r&&r.call(this)}}function either(){return 0!==arguments.length?Array.prototype.concat.apply([],arguments).random():void 0}function lastVisited(){if(State.isEmpty()||0===arguments.length)return-1;var e,t=Array.prototype.concat.apply([],arguments);if(t.length>1){e=State.length;for(var r=0,a=t.length;a>r;++r)e=Math.min(e,lastVisited(t[r]))}else{var n=State.history,i=t[0];for(e=State.length-1;e>=0&&n[e].title!==i;--e);-1!==e&&(e=State.length-1-e)}return e}function passage(){return State.passage}function previous(e){if(0!==arguments.length){if(1>e)throw new RangeError("previous offset parameter must be a positive integer greater than zero");return State.length>e?State.peek(e).title:""}for(var t=State.length-2;t>=0;--t)if(State.history[t].title!==State.passage)return State.history[t].title;return State.expiredUnique}function random(e,t){if(0===arguments.length)throw new Error("random called with insufficient arguments");if(1===arguments.length&&(t=e,e=0),e>t){var r=t;t=e,e=r}return Math.floor(State.random()*(t-e+1))+e}function randomFloat(e,t){if(0===arguments.length)throw new Error("randomFloat called with insufficient arguments");if(1===arguments.length&&(t=e,e=0),e>t){var r=t;t=e,e=r}return State.random()*(t-e)+e}function tags(){if(0===arguments.length)return Story.get(State.passage).tags.slice(0);for(var e=Array.prototype.concat.apply([],arguments),t=[],r=0,a=e.length;a>r;++r)t=t.concat(Story.get(e[r]).tags);return t}function time(){return null===State.lastPlay?0:Date.now()-State.lastPlay}function turns(){return State.expired+State.length}function variables(){return State.variables}function visited(){if(State.isEmpty())return 0;var e,t=Array.prototype.concat.apply([],0===arguments.length?[State.passage]:arguments);if(t.length>1){e=State.length;for(var r=0,a=t.length;a>r;++r)e=Math.min(e,visited(t[r]))}else{var n=State.history,i=t[0];e=0;for(var r=0,a=State.length;a>r;++r)n[r].title===i&&++e}return e}function visitedTags(){if(0===arguments.length)return 0;for(var e=Array.prototype.concat.apply([],arguments),t=e.length,r=0,a=0,n=State.length;n>a;++a){var i=Story.get(State.history[a].title).tags;if(0!==i.length){for(var s=0,o=0;t>o;++o)i.contains(e[o])&&++s;s===t&&++r}}return r}Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");return-1!==Array.prototype.indexOf.apply(this,arguments)}}),Object.create&&"function"==typeof Object.create||Object.defineProperty(Object,"create",{configurable:!0,writable:!0,value:function(){function e(){}return function(t){if(0===arguments.length)throw new Error("polyfill Object.create implementation requires a parameter");if(1!==arguments.length)throw new Error("polyfill Object.create implementation only accepts one parameter");var r;if(null===t)r={__proto__:null};else{if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("polyfill Object.create proto parameter must be an object or null");e.prototype=t,r=new e,r.__proto__=t}return r}}()}),Object.defineProperty(Array,"random",{configurable:!0,writable:!0,value:function(e,t,r){return 2===arguments.length&&(r=t,t=0),Array.isArray(e)?e.random(t,r):e.hasOwnProperty("length")?Array.from(e).random(t,r):undefined}}),Object.defineProperty(Array.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.contains called on null or undefined");return-1!==Array.prototype.indexOf.apply(this,arguments)}}),Object.defineProperty(Array.prototype,"containsAll",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAll called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.containsAll.apply(this,arguments[0]):-1!==Array.prototype.indexOf.apply(this,arguments);for(var e=0,t=arguments.length;t>e;++e)if(!Array.prototype.some.call(this,function(e){return e===this.val},{val:arguments[e]}))return!1;return!0}}),Object.defineProperty(Array.prototype,"containsAny",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.containsAny called on null or undefined");if(1===arguments.length)return Array.isArray(arguments[0])?Array.prototype.containsAny.apply(this,arguments[0]):-1!==Array.prototype.indexOf.apply(this,arguments);for(var e=0,t=arguments.length;t>e;++e)if(Array.prototype.some.call(this,function(e){return e===this.val},{val:arguments[e]}))return!0;return!1}}),Object.defineProperty(Array.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.count called on null or undefined");for(var e=Array.prototype.indexOf,t=arguments[0],r=Number(arguments[1]||0),a=0;-1!==(r=e.call(this,t,r));)++a,++r;return a}}),Object.defineProperty(Array.prototype,"flatten",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.flatten called on null or undefined");return this.reduce(function(e,t){return e.concat(Array.isArray(t)?t.flatten():t)},[])}}),Object.defineProperty(Array.prototype,"pluck",{configurable:!0,writable:!0,value:function(e,t){if(null==this)throw new TypeError("Array.prototype.pluck called on null or undefined");if(0!==this.length)return 1===arguments.length&&(t=e,e=0),null==e?e=0:0>e?e=0:e>=this.length&&(e=this.length-1),null==t?t=this.length-1:0>t?t=0:t>=this.length&&(t=this.length-1),Array.prototype.splice.call(this,random(e,t),1)[0]}}),Object.defineProperty(Array.prototype,"random",{configurable:!0,writable:!0,value:function(e,t){if(null==this)throw new TypeError("Array.prototype.random called on null or undefined");if(0!==this.length)return 1===arguments.length&&(t=e,e=0),null==e?e=0:0>e?e=0:e>=this.length&&(e=this.length-1),null==t?t=this.length-1:0>t?t=0:t>=this.length&&(t=this.length-1),this[random(e,t)]}}),Object.defineProperty(Array.prototype,"shuffle",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Array.prototype.shuffle called on null or undefined");if(0!==this.length){for(var e=this.length-1;e>0;--e){var t=Math.floor(Math.random()*(e+1)),r=this[e];this[e]=this[t],this[t]=r}return this}}}),Object.defineProperty(Function.prototype,"partial",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("Function.prototype.partial called on null or undefined");var e=Array.prototype.slice,t=this,r=e.call(arguments,0);return function(){for(var a=[],n=0,i=0;i<r.length;++i)a.push(r[i]===undefined?arguments[n++]:r[i]);return t.apply(this,a.concat(e.call(arguments,n)))}}}),Object.defineProperty(Math,"clamp",{configurable:!0,writable:!0,value:function(e,t,r){return e=Number(e),isNaN(e)?NaN:e.clamp(t,r)}}),Object.defineProperty(Math,"easeInOut",{configurable:!0,writable:!0,value:function(e){return e=Number(e),1-(Math.cos(e*Math.PI)+1)/2}}),Object.defineProperty(Number.prototype,"clamp",{configurable:!0,writable:!0,value:function(e,t){var r=Number(this);return e>r&&(r=e),r>t&&(r=t),r}}),Object.defineProperty(RegExp,"escape",{configurable:!0,writable:!0,value:function(e){return String(e).replace(/[-.*+?^${}()|\[\]\/\\]/g,"\\$&")}}),Object.defineProperty(String,"format",{configurable:!0,writable:!0,value:function(e){function t(e,t,r){if(!t)return e;var a=Math.abs(t)-e.length;if(1>a)return e;var n=Array(a+1).join(r);return 0>t?e+n:n+e}if(arguments.length<2)return 0===arguments.length?"":e;var r=2===arguments.length&&Array.isArray(arguments[1])?arguments[1].slice(0):Array.prototype.slice.call(arguments,1);return 0===r.length?e:e.replace(/{(\d+)(?:,([+-]?\d+))?}/g,function(e,a,n){var i=r[a];if(null==i)return"";for(;"function"==typeof i;)i=i();switch(typeof i){case"string":break;case"object":i=JSON.stringify(i);break;default:i=String(i)}return t(i,n?parseInt(n,10):0," ")})}}),Object.defineProperty(String.prototype,"contains",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.contains called on null or undefined");return-1!==String.prototype.indexOf.apply(this,arguments)}}),Object.defineProperty(String.prototype,"count",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.count called on null or undefined");var e=String(arguments[0]||"");if(""===e)return 0;for(var t=String.prototype.indexOf,r=e.length,a=Number(arguments[1]||0),n=0;-1!==(a=t.call(this,e,a));)++n,a+=r;return n}}),Object.defineProperty(String.prototype,"splice",{configurable:!0,writable:!0,value:function(e,t,r){if(null==this)throw new TypeError("String.prototype.splice called on null or undefined");var a=this.length>>>0;if(0===a)return"";e=+e||0,isFinite(e)?0>e&&(e+=a,0>e&&(e=0)):e=0,e>a&&(e=a),t=+t||0,(!isFinite(t)||0>t)&&(t=0);var n=this.slice(0,e);return"undefined"!=typeof r&&(n+=r),a>e+t&&(n+=this.slice(e+t)),n}}),Object.defineProperty(String.prototype,"splitOrEmpty",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.splitOrEmpty called on null or undefined");return""===String(this)?[]:String.prototype.split.apply(this,arguments)}}),String.prototype.trimLeft||Object.defineProperty(String.prototype,"trimLeft",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimLeft called on null or undefined");return this.replace(/^[\s\uFEFF\xA0]+/,"")}}),String.prototype.trimRight||Object.defineProperty(String.prototype,"trimRight",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.trimRight called on null or undefined");return this.replace(/[\s\uFEFF\xA0]+$/,"")}}),Object.defineProperty(String.prototype,"ltrim",{configurable:!0,writable:!0,value:String.prototype.trimLeft}),Object.defineProperty(String.prototype,"rtrim",{configurable:!0,writable:!0,value:String.prototype.trimRight}),Object.defineProperty(String.prototype,"readBracketedList",{configurable:!0,writable:!0,value:function(){if(null==this)throw new TypeError("String.prototype.readBracketedList called on null or undefined");for(var e,t=new RegExp("(?:\\[\\[((?:\\s|\\S)*?)\\]\\])|([^\"'\\s]\\S*)","gm"),r=[];null!==(e=t.exec(this));)e[1]?r.push(e[1]):e[2]&&r.push(e[2]);return r}}),Object.defineProperty(Date.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:date)",this.toISOString()]}}),Object.defineProperty(Function.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)",this.toString()]}}),Object.defineProperty(Map.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:map)",Array.from(this)]}}),Object.defineProperty(RegExp.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:eval)",this.toString()]}}),Object.defineProperty(Set.prototype,"toJSON",{configurable:!0,writable:!0,value:function(){return["(revive:set)",Array.from(this)]}}),Object.defineProperty(JSON,"reviveWrapper",{configurable:!0,writable:!0,value:function(e){if("string"!=typeof e)throw new TypeError("JSON.reviveWrapper code parameter must be a string");return["(revive:eval)",e]}}),Object.defineProperties(JSON,{_real_parse:{value:JSON.parse},parse:{configurable:!0,writable:!0,value:function(text,reviver){return JSON._real_parse(text,function(key,value){if(Array.isArray(value)&&2===value.length)switch(value[0]){case"(revive:set)":value=new Set(value[1]);break;case"(revive:map)":value=new Map(value[1]);break;case"(revive:date)":value=new Date(value[1]);break;case"(revive:eval)":try{value=eval(value[1])}catch(e){}}else if("string"==typeof value&&"@@revive@@"===value.slice(0,10))try{value=eval(value.slice(10))}catch(e){}if("function"==typeof reviver)try{value=reviver(key,value)}catch(e){}return value})}}}),function(){var e=function(e){(13===e.which||32===e.which)&&(e.preventDefault(),jQuery(safeActiveElement()||this).trigger("click"))},t=function(e){return function(){var t=jQuery(this);t.is("[aria-pressed]")&&t.attr("aria-pressed","true"===t.attr("aria-pressed")?"false":"true"),e.apply(this,arguments)}},r=function(e){return t(function(){jQuery(this).off(".aria-clickable").removeAttr("tabindex aria-controls aria-pressed").not("a,button").removeAttr("role").end().filter("button").prop("disabled",!0),e.apply(this,arguments)})};jQuery.fn.extend({ariaClick:function(a,n){return 0===arguments.length?this:(null==n&&(n=a,a=undefined),a=jQuery.extend({namespace:undefined,one:!1,selector:undefined,data:undefined,controls:undefined,pressed:undefined,label:undefined},a),"string"!=typeof a.namespace?a.namespace="":"."!==a.namespace[0]&&(a.namespace="."+a.namespace),"boolean"==typeof a.pressed&&(a.pressed=a.pressed?"true":"false"),this.filter("button").prop("type","button"),this.not("a,button").attr("role","button"),this.attr("tabindex",0),null!=a.controls&&this.attr("aria-controls",a.controls),null!=a.pressed&&this.attr("aria-pressed",a.pressed),null!=a.label&&this.attr({"aria-label":a.label,title:a.label}),this.not("button").on("keypress.aria-clickable"+a.namespace,a.selector,e),this.on("click.aria-clickable"+a.namespace,a.selector,a.data,a.one?r(n):t(n)),this)}})}();var Browser=Object.freeze(function(){var e={userAgent:navigator.userAgent.toLowerCase()};return e.isGecko=navigator&&"Gecko"===navigator.product&&!/webkit|trident/.test(e.userAgent),e.isIE=/msie|trident/.test(e.userAgent)&&!e.userAgent.contains("opera"),e.ieVersion=function(){var t=/(?:msie\s+|rv:)(\d{1,2}\.\d)/.exec(e.userAgent);return t?+t[1]:0}(),e.isOpera=e.userAgent.contains("opera")||e.userAgent.contains(" opr/"),e.operaVersion=function(){var t=new RegExp((/applewebkit|chrome/.test(e.userAgent)?"opr":"version")+"\\/(\\d{1,2}\\.\\d+)"),r=t.exec(e.userAgent);return r?+r[1]:0}(),e.isMobile=Object.freeze({any:function(){var t=e.isMobile;return t.Android||t.BlackBerry||t.iOS||t.Windows},Android:/android/.test(e.userAgent),BlackBerry:/blackberry/.test(e.userAgent),iOS:/ip(?:hone|ad|od)/.test(e.userAgent),Windows:/iemobile/.test(e.userAgent)}),e}()),Has=Object.freeze({localStorage:"localStorage"in window&&function(e){try{if(null!=e&&e.length>=0){var t="SugarCube.localStorage.test",r="1701 Guilty Scott";if(e.setItem(t,r),e.getItem(t)===r)return e.removeItem(t),!0}return!1}catch(e){return!1}}(window.localStorage),sessionStorage:"sessionStorage"in window&&function(e){try{if(null!=e&&e.length>=0){var t="SugarCube.sessionStorage.test",r="1701 Guilty Scott";if(e.setItem(t,r),e.getItem(t)===r)return e.removeItem(t),!0}return!1}catch(e){return!1}}(window.sessionStorage),fileAPI:"File"in window&&"FileList"in window&&"FileReader"in window&&!Browser.isMobile.any()&&(!Browser.isOpera||Browser.operaVersion>=15),audio:"function"==typeof document.createElement("audio").canPlayType});window.onerror=function(e,t,r,a,n){technicalAlert(null,e,n)};var strings={identity:"game",aborting:"Aborting",cancel:"Cancel",close:"Close",ok:"OK",errors:{title:"Error",nonexistentPassage:'the passage "%passage%" does not exist',saveMissingData:"save is missing required data. Either you've loaded a file which is not a save or the save has become corrupted",saveIdMismatch:"save is from the wrong %identity%"},warnings:{degraded:"Apologies! Your browser either lacks some of the capabilities required by this %identity% or has disabled them, so this %identity% is running in a degraded mode. You may be able to continue, but some parts may not work properly.\n\nThe former may, probably, be solved by upgrading your browser. The latter may be solved by loosening its security restrictions"+("file:"===window.location.protocol?" or, perhaps, by viewing this %identity% via the HTTP protocol.":".")},uiBar:{toggle:"Toggle the UI bar",backward:"Go backward within the %identity% history",forward:"Go forward within the %identity% history",jumpto:"Jump to a specific point within the %identity% history"},jumpto:{title:"Jump To",turn:"Turn",unavailable:"No jump points currently available…"},saves:{title:"Saves",disallowed:"Saving has been disallowed on this passage.",emptySlot:"— slot empty —",incapable:'Apologies! Your browser either lacks the capabilities required to support saves or has disabled them, so saves have been disabled for this session.<br><br>The former may, probably, be solved by <a href="http://browsehappy.com/" target="_blank">upgrading your browser</a>. The latter may be solved by loosening its security restrictions'+("file:"===window.location.protocol?" or, perhaps, by viewing this %identity% via the HTTP protocol.":"."),labelAuto:"Autosave",labelDelete:"Delete",labelExport:"Save to Disk…",labelImport:"Load from Disk…",labelLoad:"Load",labelClear:"Delete All",labelSave:"Save",labelSlot:"Slot",savedOn:"Saved on",unavailable:"No save slots found…",unknownDate:"unknown"},settings:{title:"Settings",off:"Off",on:"On",reset:"Reset to Defaults"},restart:{title:"Restart",prompt:"Are you sure that you want to restart? Unsaved progress will be lost."},share:{title:"Share"},alert:{},autoload:{title:"Autoload",cancel:"Go to start",ok:"Load autosave",prompt:"An autosave exists. Load it now or go to the start?"},macros:{back:{text:"Back"},return:{text:"Return"}}},KeyValueStore=function(){function e(e,a,n){var i=null;switch(e){case"cookie":i=new r(a,n);break;case"webStorage":i=new t(a,n),i._ok||(i=new r(a,n));break;default:throw new Error("unknown driver type")}if(!i._ok)throw new Error("unknown driver error");Object.defineProperties(this,{_driver:{value:i},name:{value:i.name},type:{value:e},id:{value:n},persist:{value:a}})}function t(e,t){var r=null,a=null;e?Has.localStorage&&(r=window.localStorage,a="localStorage"):Has.sessionStorage&&(r=window.sessionStorage,a="sessionStorage"),Object.defineProperties(this,{_ok:{value:null!==r},_engine:{value:r},_prefix:{value:t+"."},_prefixRe:{value:new RegExp("^"+RegExp.escape(t+"."))},name:{value:a},id:{value:t},persist:{value:e}})}function r(e,t){Object.defineProperties(this,{_ok:{value:"cookie"in document},_prefix:{value:t+"."},_prefixRe:{value:new RegExp("^"+RegExp.escape(t+"."))},name:{value:"cookie"},id:{value:t},persist:{value:e}})}return Object.defineProperties(e.prototype,{length:{get:function(){return null===this._driver?0:this._driver.length}},keys:{value:function(){return null===this._driver?[]:this._driver.keys()}},clear:{value:function(){if(null===this._driver)return!1;for(var e=this.keys(),t=0;t<e.length;++t)this.delete(e[t]);return!0}},has:{value:function(e){return null!==this._driver&&e?this._driver.has(e):!1}},get:{value:function(e){if(null===this._driver||!e)return null;var t=this._driver.get(e);if(null==t)return null;var r=!1;if("#~"===t.slice(0,2))t=this._driver.deserialize(t.slice(2)),r=!0;else try{t=this._driver.deserialize(t)}catch(e){t=JSON.parse(t),r=!0}if(r&&!this.set(e,t,!0))throw new Error('unable to upgrade legacy value for key "'+e+'" to new format');return t}},set:{value:function(e,t,r){return null!==this._driver&&e?this._driver.set(e,this._driver.serialize(t),r):!1}},delete:{value:function(e,t){return null!==this._driver&&e?this._driver.delete(e,t):!1}},deleteMatching:{value:function(e,t){if(null===this._driver||!e)return!1;for(var r=this.keys(),a=new RegExp("^"+RegExp.escape(e)),n=0;n<r.length;++n)a.test(r[n])&&this.delete(r[n],t);return!0}}}),Object.defineProperties(t.prototype,{serialize:{value:function(e){return LZString.compressToUTF16(JSON.stringify(e))}},deserialize:{value:function(e){return JSON.parse(LZString.decompressFromUTF16(e))}},length:{get:function(){return this.keys().length}},keys:{value:function(){if(null===this._engine)return[];for(var e=[],t=0;t<this._engine.length;++t){var r=this._engine.key(t);this._prefixRe.test(r)&&e.push(r.replace(this._prefixRe,""))}return e}},has:{value:function(e){return null!==this._engine&&e?null!=this._engine.getItem(this._prefix+e):!1}},get:{value:function(e){return null!==this._engine&&e?this._engine.getItem(this._prefix+e):null}},set:{value:function(e,t,r){if(null===this._engine||!e)return!1;try{this._engine.setItem(this._prefix+e,t)}catch(t){return r||technicalAlert(null,'unable to set key "'+e+'"; '+(/quota_?(?:exceeded|reached)/i.test(t.name)?this.name+" quota exceeded":"unknown error"),t),!1}return!0}},delete:{value:function(e){return null!==this._engine&&e?(this._engine.removeItem(this._prefix+e),!0):!1}}}),Object.defineProperties(r.prototype,{_setCookie:{value:function(e,t,r){if("cookie"in document){var a=encodeURIComponent(this._prefix+e)+"=";null!=t&&(a+=encodeURIComponent(t)),null!=r&&(a+="; "+r),a+="; path=/",document.cookie=a}}},_getCookies:{value:function(){var e={};if("cookie"in document&&""!==document.cookie)for(var t=document.cookie.split(/;\s*/),r=0;r<t.length;++r){var a=t[r].split("="),n=decodeURIComponent(a[0]);this._prefixRe.test(n)&&(e[n]=decodeURIComponent(a[1]))}return e}},serialize:{value:function(e){return LZString.compressToBase64(JSON.stringify(e))}},deserialize:{value:function(e){return JSON.parse(LZString.decompressFromBase64(e))}},length:{get:function(){return this.keys().length}},keys:{value:function(){return Object.keys(this._getCookies())}},has:{value:function(e){return e?this._getCookies().hasOwnProperty(this._prefix+e):!1}},get:{value:function(e){if(!e)return null;var t=this._getCookies(),r=this._prefix+e;return t.hasOwnProperty(r)?t[r]:null}},set:{value:function(e,t,r){if(!e)return!1;try{this._setCookie(e,t,this.persist?"Tue, 19 Jan 2038 03:14:07 GMT":undefined)}catch(t){return r||technicalAlert(null,'unable to set key "'+e+'"; cookie error: '+t.message,t),!1}return this.has(e)?!0:(r||technicalAlert(null,'unable to set key "'+e+'"; unknown cookie error'),!1)}},delete:{value:function(e,t){if(!e)return!1;try{this._setCookie(e,undefined,"Thu, 01 Jan 1970 00:00:00 GMT")}catch(r){return t||technicalAlert(null,'unable to delete key "'+e+'"; cookie error: '+r.message,r),!1}var r=this.get(e);return null!==r&&""!==r?(t||technicalAlert(null,'unable to delete key "'+e+'"; unknown cookie error'),!1):!0}}}),e}(),Util=Object.defineProperties({},{isNumeric:{value:function(e){switch(typeof e){case"number":break;case"string":e=Number(e);break;default:return!1}return isFinite(e)&&!isNaN(e)}},isBoolean:{value:function(e){return"boolean"==typeof e||"string"==typeof e&&("true"===e||"false"===e)}},slugify:{value:function(e){return String(e).trim().replace(/[^\w\s\u2013\u2014-]+/g,"").replace(/[_\s\u2013\u2014-]+/g,"-").toLocaleLowerCase()}},escape:{value:function(e){if(null==e)return"";var t=/[&<>"'`]/g,r=RegExp(t.source),a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};return e=String(e),e&&r.test(e)?e.replace(t,function(e){return a[e]}):e}},unescape:{value:function(e){if(null==e)return"";var t=/&(?:amp|lt|gt|quot|#39|#96);/g,r=RegExp(t.source),a={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"};return e=String(e),e&&r.test(e)?e.replace(t,function(e){return a[e]}):e}},evalExpression:{value:function(expression){return eval("("+expression+")")}},evalStatements:{value:function(statements){return eval("(function(){"+statements+"\n})();"),!0}},DiffOp:{value:Object.freeze({Delete:0,SpliceArray:1,Copy:2,CopyDate:3})},diff:{value:function(e,t){for(var r,a=Object.prototype.toString,n=Array.isArray(e),i=[].concat(Object.keys(e),Object.keys(t)).sort().filter(function(e,t,r){return 0===t||r[t-1]!==e}),s={},o=0,l=i.length;l>o;++o){var u=i[o],c=e[u],d=t[u];if(e.hasOwnProperty(u))if(t.hasOwnProperty(u)){if(c===d)continue;if(typeof c==typeof d)if("function"==typeof c)c.toString()!==d.toString()&&(s[u]=[Util.DiffOp.Copy,d]);else if("object"!=typeof c||null===c)s[u]=[Util.DiffOp.Copy,d];else{var h=a.call(c),p=a.call(d);if(h===p)if("[object Date]"===h)+c!==+d&&(s[u]=[Util.DiffOp.CopyDate,+d]);else if("[object RegExp]"===h)c.toString()!==d.toString()&&(s[u]=[Util.DiffOp.Copy,clone(d)]);else{var f=Util.diff(c,d);null!==f&&(s[u]=f)}else s[u]=[Util.DiffOp.Copy,clone(d)]}else s[u]=[Util.DiffOp.Copy,"object"!=typeof d||null===d?d:clone(d)]}else if(n&&Util.isNumeric(u)){var g=+u;if(!r){r="";do r+="~";while(i.some(function(e){return e===this.val},{val:r}));s[r]=[Util.DiffOp.SpliceArray,g,g]}g<s[r][1]&&(s[r][1]=g),g>s[r][2]&&(s[r][2]=g)}else s[u]=Util.DiffOp.Delete;else s[u]=[Util.DiffOp.Copy,"object"!=typeof d||null===d?d:clone(d)]}return 0!==Object.keys(s).length?s:null}},patch:{value:function(e,t){for(var r=Object.keys(t||{}),a=clone(e),n=0,i=r.length;i>n;++n){var s=r[n],o=t[s];if(o===Util.DiffOp.Delete)delete a[s];else if(Array.isArray(o))switch(o[0]){case Util.DiffOp.SpliceArray:a.splice(o[1],1+(o[2]-o[1]));break;case Util.DiffOp.Copy:a[s]=clone(o[1]);break;case Util.DiffOp.CopyDate:a[s]=new Date(o[1])}else a[s]=Util.patch(a[s],o)}return a}},fromCSSTime:{value:function(e){var t=/^([+-]?[0-9]+(?:\.[0-9]+)?)\s*(m?s)$/,r=t.exec(e);if(null===r)throw new Error('invalid time value: "'+e+'"');return"ms"===r[2]?Number(r[1]):1e3*Number(r[1])}},toCSSTime:{value:function(e){
if("number"!=typeof e||isNaN(e)||!isFinite(e)){var t;switch(typeof e){case"string":t='"'+e+'"';break;case"number":t=String(e);break;default:t=Object.prototype.toString.call(e)}throw new Error("invalid milliseconds: "+t)}return e+"ms"}}});Object.defineProperties(Util,{random:{value:Math.random},entityEncode:{value:Util.escape},entityDecode:{value:Util.unescape}}),Object.defineProperties(SeedablePRNG,{marshal:{value:function(e){if(!e||!e.hasOwnProperty("seed")||!e.hasOwnProperty("pull"))throw new Error("PRNG is missing required data");return{seed:e.seed,pull:e.pull}}},unmarshal:{value:function(e){if(!e||!e.hasOwnProperty("seed")||!e.hasOwnProperty("pull"))throw new Error("PRNG object is missing required data");for(var t=new SeedablePRNG(e.seed,!1),r=e.pull;r>0;--r)t.random();return t}}}),Object.defineProperties(StyleWrapper.prototype,{isEmpty:{value:function(){return 0===this.style.cssRules.length}},set:{value:function(e){this.clear(),this.add(e)}},add:{value:function(e){this.style.styleSheet?this.style.styleSheet.cssText+=e:this.style.appendChild(document.createTextNode(e))}},clear:{value:function(){this.style.styleSheet?this.style.styleSheet.cssText="":removeChildren(this.style)}}}),Object.defineProperties(AudioWrapper.prototype,{duration:{get:function(){return this.audio.duration}},time:{get:function(){return this.audio.currentTime},set:function(e){this.hasMetadata()?this.audio.currentTime=e:jQuery(this.audio).off("loadedmetadata.AudioWrapper:time").one("loadedmetadata.AudioWrapper:time",function(){this.currentTime=e})}},volume:{get:function(){return this.audio.volume},set:function(e){this.audio.volume=Math.clamp(e,0,1)}},controls:{get:function(){return this.audio.controls},set:function(e){this.audio.controls=!!e}},hasMetadata:{value:function(){return this.audio.readyState>=HTMLAudioElement.HAVE_METADATA}},hasData:{value:function(){return this.audio.readyState>=HTMLAudioElement.HAVE_CURRENT_DATA}},isPlaying:{value:function(){return!(this.audio.ended||this.audio.paused)}},isEnded:{value:function(){return this.audio.ended}},isPaused:{value:function(){return this.audio.paused}},isMuted:{value:function(){return this.audio.muted}},isLooped:{value:function(){return this.audio.loop}},load:{value:function(){"auto"!==this.audio.preload&&(this.audio.preload="auto"),this.audio.load()}},play:{value:function(){this.hasData()||this.load(),this.audio.play()}},pause:{value:function(){this.audio.pause()}},stop:{value:function(){this.audio.pause(),this.time=0}},mute:{value:function(){this.audio.muted=!0}},unmute:{value:function(){this.audio.muted=!1}},loop:{value:function(){this.audio.loop=!0}},unloop:{value:function(){this.audio.loop=!1}},fadeWithDuration:{value:function(e,t,r){if(null!==this._faderId&&(clearInterval(this._faderId),this._faderId=null),t=Math.clamp(t,0,1),r=Math.clamp(r,0,1),t!==r){this.hasData()||this.load();var a=25,n=(r-t)/(e/(a/1e3));this._faderId=setInterval(function(e){var a,i;return r>t?(a=t,i=r):(a=r,i=t),e.volume=t,e.play(),function(){return e.isPlaying()?(e.volume=Math.clamp(e.volume+n,a,i),0===e.volume&&e.pause(),void(e.volume===r&&(clearInterval(e._faderId),e._faderId=null))):(clearInterval(e._faderId),void(e._faderId=null))}}(this),a)}}},fade:{value:function(e,t){this.fadeWithDuration(5,e,t)}},fadeIn:{value:function(){this.fade(this.volume,1)}},fadeOut:{value:function(){this.fade(this.volume,0)}},onEnd:{value:function(e){"function"==typeof e?jQuery(this.audio).on("ended.AudioWrapper:onEnd",e):jQuery(this.audio).off("ended.AudioWrapper:onEnd")}},oneEnd:{value:function(e){"function"==typeof e?jQuery(this.audio).one("ended.AudioWrapper:oneEnd",e):jQuery(this.audio).off("ended.AudioWrapper:oneEnd")}},clone:{value:function(){return new AudioWrapper(this.audio.cloneNode(!0))}}});var Wikifier=function(){function e(r,a){this.formatter=t||e.compileFormatters(),this.output=null!=r?r:document.createDocumentFragment(),this.source=a,this.nextMatch=0,this._rawArgs="",this._nobr=[],this.subWikify(this.output),null==r&&"function"==typeof this.output.remove&&this.output.remove()}var t,r=/[\u0150\u0170]/g.test("Ő");return Object.defineProperties(e.prototype,{subWikify:{value:function(e,t,r){var a=this.output;this.output=e;var n,i,s=t?new RegExp("(?:"+t+")",r?"gim":"gm"):null;do{if(this.formatter.formatterRegExp.lastIndex=this.nextMatch,s&&(s.lastIndex=this.nextMatch),i=this.formatter.formatterRegExp.exec(this.source),n=s?s.exec(this.source):null,n&&(!i||n.index<=i.index))return n.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,n.index),this.matchStart=n.index,this.matchLength=n[0].length,this.matchText=n[0],this.nextMatch=s.lastIndex,void(this.output=a);if(i){i.index>this.nextMatch&&this.outputText(this.output,this.nextMatch,i.index),this.matchStart=i.index,this.matchLength=i[0].length,this.matchText=i[0],this.nextMatch=this.formatter.formatterRegExp.lastIndex;for(var o=-1,l=1;l<i.length;++l)if(i[l]){o=l-1;break}if(-1!==o&&(this.formatter.formatters[o].handler(this),null!=runtime.temp.break))break}}while(n||i);null==runtime.temp.break?this.nextMatch<this.source.length&&(this.outputText(this.output,this.nextMatch,this.source.length),this.nextMatch=this.source.length):this.output.lastChild&&this.output.lastChild.nodeType===Node.ELEMENT_NODE&&"BR"===this.output.lastChild.nodeName.toUpperCase()&&removeElement(this.output.lastChild),this.output=a}},outputText:{value:function(e,t,r){insertText(e,this.source.substring(t,r))}},rawArgs:{value:function(){return this._rawArgs}},fullArgs:{value:function(){return e.parse(this.rawArgs())}}}),Object.defineProperties(e,{compileFormatters:{value:function(){for(var r=e.formatters,a=[],n=0,i=r.length;i>n;++n)a.push("("+r[n].match+")");return t={formatters:r,formatterRegExp:new RegExp(a.join("|"),"gm")}}},parse:{value:function(e){for(var t,r=new RegExp("(?:(?:\"((?:(?:\\\\\")|[^\"])+)\")|(?:'((?:(?:\\\\')|[^'])+)')|((?:\"\")|(?:''))|([=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}]+)|([^\"'=+\\-*\\/%<>&\\|\\^~!?:,;\\(\\)\\[\\]{}\\s]+))","g"),a={$:"State.variables.",to:"=",eq:"==",neq:"!=",is:"===",isnot:"!==",gt:">",gte:">=",lt:"<",lte:"<=",and:"&&",or:"||",not:"!",def:'"undefined" !== typeof',ndef:'"undefined" === typeof'};null!==(t=r.exec(e));)if(t[5]){var n=t[5];if("$"===n)continue;if("$"===n[0])n="$";else if("is"===n){var i=r.lastIndex,s=e.slice(i);/^\s+not\b/.test(s)&&(e=e.splice(i,s.search(/\S/)),n="isnot")}a.hasOwnProperty(n)&&(e=e.splice(t.index,n.length,a[n]),r.lastIndex+=a[n].length-n.length)}return e}},getValue:{value:function(t){var r,a=e.parseStoryVariable(t);if(0!==a.length){r=State.variables;for(var n=0,i=a.length;i>n;++n){if("undefined"==typeof r[a[n]]){r=undefined;break}r=r[a[n]]}}return r}},setValue:{value:function(t,r){var a=e.parseStoryVariable(t);if(0!==a.length){for(var n=State.variables,i=a.pop(),s=0,o=a.length;o>s;++s){if("undefined"==typeof n[a[s]]){n=undefined;break}n=n[a[s]]}if(n!==undefined)return n[i]=r,!0}return!1}},parseStoryVariable:{value:function(t){for(var r,a=/^(?:\$(\w+)|\.(\w+)|\[(?:(?:\"((?:\\.|[^\"\\])+)\")|(?:\'((?:\\.|[^\'\\])+)\')|(\$\w.*)|(\d+))\])/,n=[];null!==(r=a.exec(t));)t=t.slice(r[0].length),r[1]?n.push(r[1]):r[2]?n.push(r[2]):r[3]?n.push(r[3]):r[4]?n.push(r[4]):r[5]?n.push(e.getValue(r[5])):r[6]&&n.push(Number(r[6]));return""===t?n:[]}},evalExpression:{value:function(t){return Util.evalExpression(e.parse(t))}},evalStatements:{value:function(t){return Util.evalStatements(e.parse(t))}},wikifyEval:{value:function(t){var r=document.createDocumentFragment();try{for(new e(r,t);r.hasChildNodes();){var a=r.firstChild;if(a.classList&&a.classList.contains("error"))throw new Error(a.textContent.replace(/^(?:(?:Uncaught\s+)?Error:\s+)+/,""));r.removeChild(a)}}finally{removeChildren(r),"function"==typeof r.remove&&r.remove()}}},createInternalLink:{value:function(e,t,r,a){var n=document.createElement("a");return null!=t&&(n.setAttribute("data-passage",t),Story.has(t)?(n.classList.add("link-internal"),config.addVisitedLinkClass&&State.has(t)&&n.classList.add("link-visited")):n.classList.add("link-broken"),jQuery(n).ariaClick({one:!0},function(){"function"==typeof a&&a(),State.play(t)})),r&&insertText(n,r),e&&e.appendChild(n),n}},createExternalLink:{value:function(e,t,r){var a=insertElement(e,"a",null,"link-external",r);return a.target="_blank",null!=t&&(a.href=t,a.setAttribute("tabindex",0)),a}},isExternalLink:{value:function(t){if(Story.has(t))return!1;var r=new RegExp("^"+e.textPrimitives.url,"gim");return r.test(t)||/[\.\/\\#]/.test(t)}}}),Object.defineProperty(e,"textPrimitives",{value:{}}),Object.defineProperties(e.textPrimitives,{anyLetter:{value:r?"[A-Za-z0-9_\\-À-ž]":"[A-Za-z0-9_\\-À-ÿ]"},url:{value:"(?:file|https?|mailto|ftp|javascript|irc|news|data):[^\\s'\"]+(?:/|\\b)"}}),Object.defineProperties(e.textPrimitives,{inlineCSS:{value:["(?:("+e.textPrimitives.anyLetter+"+)\\(([^\\)\\|\\n]+)\\):)","(?:("+e.textPrimitives.anyLetter+"+):([^;\\|\\n]+);)","(?:((?:\\."+e.textPrimitives.anyLetter+"+)+);)","(?:((?:#"+e.textPrimitives.anyLetter+"+)+);)"].join("|")}}),Object.defineProperty(e,"helpers",{value:{}}),Object.defineProperties(e.helpers,{charFormat:{value:function(e){e.subWikify(insertElement(e.output,this.element),this.terminator)}},inlineCSS:{value:function(t){var r,a={styles:[],classes:[],id:""},n=new RegExp(e.textPrimitives.inlineCSS,"gm");do{n.lastIndex=t.nextMatch;var i=n.exec(t.source);r=i&&i.index===t.nextMatch,r&&(i[1]?a.styles.push({style:e.helpers.cssToDOMName(i[1]),value:i[2].trim()}):i[3]?a.styles.push({style:e.helpers.cssToDOMName(i[3]),value:i[4].trim()}):i[5]?a.classes=a.classes.concat(i[5].slice(1).split(/\./)):i[6]&&(a.id=i[6].slice(1).split(/#/).pop()),t.nextMatch=n.lastIndex)}while(r);return a}},cssToDOMName:{value:function(e){if(!e.contains("-")){switch(e){case"bgcolor":e="backgroundColor";break;case"float":e="cssFloat"}return e}for(var t=e.split("-"),r=1;r<t.length;++r)t[r]=t[r].slice(0,1).toUpperCase()+t[r].slice(1);return t.join("")}},evalExpression:{value:function(t){var r;try{r=e.evalExpression(t),null==r||"function"==typeof r?r=t:(r=String(r),/\[(?:object(?:\s+[^\]]+)?|native\s+code)\]/.test(r)&&(r=t))}catch(e){r=t}return r}},evalPassageId:{value:function(t){return null==t||Story.has(t)||(t=e.helpers.evalExpression(t)),t}},parseSquareBracketedMarkup:{value:function(e){var t,r,a,n,i=function(){return g>=e.source.length?h:e.source[g++]},s=function(){return g>=e.source.length?h:e.source[g]},o=function(t){return 1>t||g+t>=e.source.length?h:e.source[g+t]},l=function(){return{error:String.format.apply(null,arguments),pos:g}},u=function(){f=g},c=function(t){var r=e.source.slice(f,g).trim();if(""===r)throw new Error("malformed wiki "+(a?"link":"image")+", empty "+t+" component");"link"===t&&"~"===r[0]?(p.forceInternal=!0,p.link=r.slice(1)):p[t]=r,f=g},d=function(e){++g;e:for(;;){switch(s()){case"\\":++g;var t=s();if(t!==h&&"\n"!==t)break;case h:case"\n":return h;case e:break e}++g}return g},h=-1,p={},f=e.matchStart,g=f+1;if(n=s(),"["===n)a=p.isLink=!0;else{switch(a=!1,n){case"<":p.align="left",++g;break;case">":p.align="right",++g}if(!/^[Ii][Mm][Gg]$/.test(e.source.slice(g,g+3)))return l("malformed square-bracketed wiki markup");g+=3,p.isImage=!0}if("["!==i())return l("malformed wiki {0}",a?"link":"image");t=1,r=0,u();try{e:for(;;){switch(n=s()){case h:case"\n":return l("unterminated wiki {0}",a?"link":"image");case'"':if(d(n)===h)return l("unterminated double quoted string in wiki {0}",a?"link":"image");break;case"'":if((4===r||3===r&&a)&&d(n)===h)return l("unterminated single quoted string in wiki {0}",a?"link":"image");break;case"|":0===r&&(c(a?"text":"title"),++f,r=1);break;case"-":0===r&&">"===o(1)&&(c(a?"text":"title"),++g,f+=2,r=1);break;case"<":0===r&&"-"===o(1)&&(c(a?"link":"source"),++g,f+=2,r=2);break;case"[":if(-1===r)return l("unexpected left square bracket '['");++t,1===t&&(u(),++f);break;case"]":if(--t,0===t){switch(r){case 0:case 1:c(a?"link":"source"),r=3;break;case 2:c(a?"text":"title"),r=3;break;case 3:a?(c("setter"),r=-1):(c("link"),r=4);break;case 4:c("setter"),r=-1}if(++g,"]"===s()){++g;break e}--g}}++g}}catch(e){return l(e.message)}return p.pos=g,p}}}),Object.defineProperty(e,"formatters",{value:[{name:"dollarSign",match:"\\${2}",handler:function(e){insertText(e.output,"$")}},{name:"$variable",match:"\\$\\w+(?:(?:\\.[A-Za-z_$]\\w*)|(?:\\[\\d+\\])|(?:\\[\"(?:\\\\.|[^\"\\\\])+\"\\])|(?:\\['(?:\\\\.|[^'\\\\])+'\\])|(?:\\[\\$\\w+\\]))*",handler:function(t){var r=printableStringOrDefault(e.getValue(t.matchText),null);null===r?insertText(t.output,t.matchText):new e(t.output,r)}},{name:"table",match:"^\\|(?:[^\\n]*)\\|(?:[fhck]?)$",lookahead:"^\\|([^\\n]*)\\|([fhck]?)$",rowTerminator:"\\|(?:[fhck]?)$\\n?",cellPattern:"(?:\\|([^\\n\\|]*)\\|)|(\\|[fhck]?$\\n?)",cellTerminator:"(?:\\x20*)\\|",rowTypes:{c:"caption",h:"thead","":"tbody",f:"tfoot"},handler:function(e){var t,r,a,n,i=insertElement(e.output,"table"),s=new RegExp(this.lookahead,"gm"),o=null,l=[],u=0;e.nextMatch=e.matchStart;do{s.lastIndex=e.nextMatch;var c=s.exec(e.source);n=c&&c.index===e.nextMatch,n&&(t=c[2],"k"===t?(i.className=c[1],e.nextMatch+=c[0].length+1):(t!==o&&(r=insertElement(i,this.rowTypes[t])),o=t,"c"===o?(0===u?r.setAttribute("align","top"):r.setAttribute("align","bottom"),e.nextMatch=e.nextMatch+1,e.subWikify(r,this.rowTerminator)):(a=insertElement(r,"tr"),this.rowHandler(e,a,l)),++u))}while(n)},rowHandler:function(t,r,a){var n,i=0,s=1,o=new RegExp(this.cellPattern,"gm");do{o.lastIndex=t.nextMatch;var l=o.exec(t.source);if(n=l&&l.index===t.nextMatch){if("~"===l[1]){var u=a[i];u&&(++u.rowCount,u.element.setAttribute("rowSpan",u.rowCount),u.element.setAttribute("rowspan",u.rowCount),u.element.valign="center"),t.nextMatch=l.index+l[0].length-1}else if(">"===l[1])++s,t.nextMatch=l.index+l[0].length-1;else{if(l[2]){t.nextMatch=l.index+l[0].length;break}var c,d=!1,h=!1;++t.nextMatch;for(var p=e.helpers.inlineCSS(t);" "===t.source.substr(t.nextMatch,1);)d=!0,++t.nextMatch;"!"===t.source.substr(t.nextMatch,1)?(c=insertElement(r,"th"),++t.nextMatch):c=insertElement(r,"td"),a[i]={rowCount:1,element:c},s>1&&(c.setAttribute("colSpan",s),c.setAttribute("colspan",s),s=1);for(var f=0;f<p.styles.length;++f)c.style[p.styles[f].style]=p.styles[f].value;for(var f=0;f<p.classes.length;++f)c.classList.add(p.classes[f]);""!==p.id&&(c.id=p.id),t.subWikify(c,this.cellTerminator)," "===t.matchText.substr(t.matchText.length-2,1)&&(h=!0),d&&h?c.align="center":d?c.align="right":h&&(c.align="left"),t.nextMatch=t.nextMatch-1}++i}}while(n)}},{name:"heading",match:"^!{1,6}",terminator:"\\n",handler:function(e){var t=function(e){for(var t="function"==typeof window.getComputedStyle,r=e.length-1;r>=0;--r){var a=e[r];switch(a.nodeType){case Node.ELEMENT_NODE:var n=a.nodeName.toUpperCase();if("BR"===n)return!0;var i=t?window.getComputedStyle(a,null):a.currentStyle;if(i&&i.display){if("none"===i.display)continue;return"block"===i.display}switch(n){case"ADDRESS":case"ARTICLE":case"ASIDE":case"BLOCKQUOTE":case"CENTER":case"DIV":case"DL":case"FIGURE":case"FOOTER":case"FORM":case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"HEADER":case"HR":case"MAIN":case"NAV":case"OL":case"P":case"PRE":case"SECTION":case"TABLE":case"UL":return!0}return!1;case Node.COMMENT_NODE:continue;default:return!1}}return!0}(e.output.childNodes);t?e.subWikify(insertElement(e.output,"h"+e.matchLength),this.terminator):insertText(e.output,e.matchText)}},{name:"list",match:"^(?:(?:\\*+)|(?:#+))",lookahead:"^(?:(\\*+)|(#+))",terminator:"\\n",outerElement:"ul",itemElement:"li",handler:function(e){e.nextMatch=e.matchStart;var t,r,a,n,i=new RegExp(this.lookahead,"gm"),s=[e.output],o=null,l=0;do{i.lastIndex=e.nextMatch;var u=i.exec(e.source);if(a=u&&u.index===e.nextMatch){if(t=u[2]?"ol":"ul",r=u[0].length,e.nextMatch+=u[0].length,r>l)for(n=l;r>n;++n)s.push(insertElement(s[s.length-1],t));else if(l>r)for(n=l;n>r;--n)s.pop();else r===l&&t!==o&&(s.pop(),s.push(insertElement(s[s.length-1],t)));l=r,o=t,e.subWikify(insertElement(s[s.length-1],"li"),this.terminator)}}while(a)}},{name:"quoteByBlock",match:"^<<<\\n",terminator:"^<<<\\n",handler:function(e){e.subWikify(insertElement(e.output,"blockquote"),this.terminator)}},{name:"quoteByLine",match:"^>+",terminator:"\\n",element:"blockquote",handler:function(e){var t,r,a=new RegExp(this.match,"gm"),n=[e.output],i=0,s=e.matchLength;do{if(s>i)for(r=i;s>r;++r)n.push(insertElement(n[n.length-1],this.element));else if(i>s)for(r=i;r>s;--r)n.pop();i=s,e.subWikify(n[n.length-1],this.terminator),insertElement(n[n.length-1],"br"),a.lastIndex=e.nextMatch;var o=a.exec(e.source);t=o&&o.index===e.nextMatch,t&&(s=o[0].length,e.nextMatch+=o[0].length)}while(t)}},{name:"rule",match:"^----+$\\n?|<hr ?/?>\\n?",handler:function(e){insertElement(e.output,"hr")}},{name:"monospacedByLine",match:"^\\{\\{\\{\\n",lookahead:"^\\{\\{\\{\\n((?:^[^\\n]*\\n)+?)(^\\}\\}\\}$\\n?)",handler:function(e){var t=new RegExp(this.lookahead,"gm");t.lastIndex=e.matchStart;var r=t.exec(e.source);r&&r.index===e.matchStart&&(insertElement(e.output,"pre",null,null,r[1]),e.nextMatch=t.lastIndex)}},{name:"prettyLink",match:"\\[\\[[^[]",handler:function(t){var r=e.helpers.parseSquareBracketedMarkup(t);if(r.hasOwnProperty("error"))return void t.outputText(t.output,t.matchStart,t.nextMatch);t.nextMatch=r.pos;var a=e.helpers.evalPassageId(r.link),n=r.hasOwnProperty("text")?e.helpers.evalExpression(r.text):a,i=r.hasOwnProperty("setter")?function(t){return function(){e.evalStatements(t)}}(e.parse(r.setter)):null;r.forceInternal||!e.isExternalLink(a)?e.createInternalLink(t.output,a,n,i):e.createExternalLink(t.output,a,n)}},{name:"urlLink",match:e.textPrimitives.url,handler:function(t){t.outputText(e.createExternalLink(t.output,t.matchText),t.matchStart,t.nextMatch)}},{name:"image",match:"\\[[<>]?[Ii][Mm][Gg]\\[",handler:function(t){var r=e.helpers.parseSquareBracketedMarkup(t);if(r.hasOwnProperty("error"))return void t.outputText(t.output,t.matchStart,t.nextMatch);t.nextMatch=r.pos;var a,n=t.output,i=r.hasOwnProperty("setter")?function(t){return function(){e.evalStatements(t)}}(e.parse(r.setter)):null;if(r.hasOwnProperty("link")){var s=e.helpers.evalPassageId(r.link);n=r.forceInternal||!e.isExternalLink(s)?e.createInternalLink(n,s,null,i):e.createExternalLink(n,s),n.classList.add("link-image")}if(n=insertElement(n,"img"),a=e.helpers.evalPassageId(r.source),"data:"!==a.slice(0,5)&&Story.has(a)){var o=Story.get(a);o.tags.contains("Twine.image")&&(n.setAttribute("data-passage",o.title),a=o.text)}n.src=a,r.hasOwnProperty("title")&&(n.title=e.helpers.evalExpression(r.title)),r.hasOwnProperty("align")&&(n.align=r.align)}},{name:"macro",match:"<<",lookaheadRegExp:/<<(\/?[A-Za-z][^>\s]*|[=-])(?:\s*)((?:(?:\"(?:\\.|[^\"\\])*\")|(?:\'(?:\\.|[^\'\\])*\')|(?:\[(?:[<>]?[Ii][Mm][Gg])?\[[^\r\n]*?\]\]+)|[^>]|(?:>(?!>)))*)>>/gm,argsPattern:"(?:"+['("(?:\\\\.|[^"\\\\])+")',"('(?:\\\\.|[^'\\\\])+')","(\"\"|'')","(\\[(?:[<>]?[Ii][Mm][Gg])?\\[[^\\r\\n]*?\\]\\]+)","([^\"'`\\s]\\S*)"].join("|")+")",working:{name:"",handler:"",arguments:"",index:0},context:null,handler:function(e){var t=this.lookaheadRegExp.lastIndex=e.matchStart;if(this.parseTag(e)){var r=e.nextMatch,a=this.working.name,n=this.working.handler,i=this.working.arguments;try{var s=Macro.get(a);if(!s){if(Macro.tags.has(a)){var o=Macro.tags.get(a);return throwError(e.output,"child tag <<"+a+">> was found outside of a call to its parent macro"+(1===o.length?"":"s")+" <<"+o.join(">>, <<")+">>",e.source.slice(t,e.nextMatch))}return throwError(e.output,"macro <<"+a+">> does not exist",e.source.slice(t,e.nextMatch))}var l=null;if(s.hasOwnProperty("tags")&&(l=this.parseBody(e,s.tags),!l))return e.nextMatch=r,throwError(e.output,"cannot find a closing tag for macro <<"+a+">>",e.source.slice(t,e.nextMatch)+"…");if("function"!=typeof s[n])return throwError(e.output,"macro <<"+a+'>> handler function "'+n+'" '+(s.hasOwnProperty(n)?"is not a function":"does not exist"),e.source.slice(t,e.nextMatch));var u=s.hasOwnProperty("skipArgs")&&s.skipArgs?[]:this.parseArgs(i);if(s.hasOwnProperty("_MACRO_API"))try{this.context=new MacroContext({parent:this.context,macro:s,name:a,rawArgs:i,args:u,payload:l,parser:e,source:e.source.slice(t,e.nextMatch)}),s[n].call(this.context)}finally{this.context=this.context.parent}else{var c=e._rawArgs;e._rawArgs=i,s[n](e.output,a,u,e,l),e._rawArgs=c}}catch(r){return throwError(e.output,"cannot execute "+(s&&s.isWidget?"widget":"macro")+" <<"+a+">>: "+r.message,e.source.slice(t,e.nextMatch))}finally{this.working.name="",this.working.handler="",this.working.arguments="",this.working.index=0}}else e.outputText(e.output,e.matchStart,e.nextMatch)},parseTag:function(e){var t=this.lookaheadRegExp.exec(e.source);if(t&&t.index===e.matchStart&&t[1]){e.nextMatch=this.lookaheadRegExp.lastIndex;var r=t[1].indexOf("::");return-1!==r?(this.working.name=t[1].slice(0,r),this.working.handler=t[1].slice(r+2)):(this.working.name=t[1],this.working.handler="handler"),this.working.arguments=t[2],this.working.index=t.index,!0}return!1},parseBody:function(e,t){for(var r=this.working.name,a="/"+r,n="end"+r,i=Array.isArray(t)?t:!1,s=-1,o=1,l=this.working.name,u=this.working.arguments,c=e.nextMatch,d=[];-1!==(e.matchStart=e.source.indexOf(this.match,e.nextMatch));)if(this.parseTag(e)){var h=this.working.name,p=this.working.arguments,f=this.working.index,g=e.nextMatch;switch(h){case r:++o;break;case n:case a:--o;break;default:if(1===o&&i)for(var m=0,v=i.length;v>m;++m)h===i[m]&&(d.push({name:l,arguments:u,contents:e.source.slice(c,f)}),l=h,u=p,c=g)}if(0===o){d.push({name:l,arguments:u,contents:e.source.slice(c,f)}),s=g;break}}else this.lookaheadRegExp.lastIndex=e.nextMatch=e.matchStart+this.match.length;return-1!==s?(e.nextMatch=s,d):null},parseArgs:function(t){for(var r,a=new RegExp(this.argsPattern,"gm"),n=[];null!==(r=a.exec(t));){var i;if(r[1]){i=r[1];try{i=Util.evalExpression(i)}catch(e){throw new Error("unable to parse macro argument '"+i+"': "+e.message)}}else if(r[2]){i=r[2];try{i=Util.evalExpression(i)}catch(e){throw new Error('unable to parse macro argument "'+i+'": '+e.message)}}else if(r[3])i="";else if(r[4]){i=r[4];var s=e.helpers.parseSquareBracketedMarkup({source:i,matchStart:0});if(s.hasOwnProperty("error"))throw new Error('unable to parse macro argument "'+i+'": '+s.error);if(s.pos<i.length)throw new Error('unable to parse macro argument "'+i+'": unexpected character(s) "'+i.slice(s.pos)+'" (pos: '+s.pos+")");s.isLink?(i={isLink:!0},i.count=s.hasOwnProperty("text")?2:1,i.link=e.helpers.evalPassageId(s.link),i.text=s.hasOwnProperty("text")?e.helpers.evalExpression(s.text):i.link,i.external=!s.forceInternal&&e.isExternalLink(i.link),i.setFn=s.hasOwnProperty("setter")?function(t){return function(){e.evalStatements(t)}}(e.parse(s.setter)):null):s.isImage&&(i=function(e){var t={isImage:!0,source:e};if("data:"!==e.slice(0,5)&&Story.has(e)){var r=Story.get(e);r.tags.contains("Twine.image")&&(t.source=r.text,t.passage=r.title)}return t}(s.source),s.hasOwnProperty("align")&&(i.align=s.align),s.hasOwnProperty("title")&&(i.title=e.helpers.evalExpression(s.title)),s.hasOwnProperty("link")&&(i.link=e.helpers.evalPassageId(s.link),i.external=!s.forceInternal&&e.isExternalLink(i.link)),i.setFn=s.hasOwnProperty("setter")?function(t){return function(){e.evalStatements(t)}}(e.parse(s.setter)):null)}else if(r[5])if(i=r[5],/^\$\w+/.test(i))i=e.getValue(i);else if(/^(?:settings|setup)[\.\[]/.test(i))try{i=e.evalExpression(i)}catch(e){throw new Error('unable to parse macro argument "'+i+'": '+e.message)}else if(/^(?:\{.*\}|\[.*\])$/.test(i))try{i=e.evalExpression(i)}catch(e){throw new Error('unable to parse macro argument "'+i+'": '+e.message)}else"null"===i?i=null:"undefined"===i?i=undefined:"true"===i?i=!0:"false"===i?i=!1:!isNaN(parseFloat(i))&&isFinite(i)&&(i=Number(i));n.push(i)}return n}},{name:"html",match:"<[Hh][Tt][Mm][Ll]>",lookaheadRegExp:/<[Hh][Tt][Mm][Ll]>((?:.|\n)*?)<\/[Hh][Tt][Mm][Ll]>/gm,handler:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);if(t&&t.index===e.matchStart){e.nextMatch=this.lookaheadRegExp.lastIndex;var r=document.createDocumentFragment(),a=document.createElement("div");for(a.innerHTML=t[1];a.firstChild;)r.appendChild(a.firstChild);e.output.appendChild(r)}}},{name:"commentByBlock",match:"/(?:%|\\*)",lookaheadRegExp:/\/(%|\*)((?:.|\n)*?)\1\//gm,handler:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);t&&t.index===e.matchStart&&(e.nextMatch=this.lookaheadRegExp.lastIndex)}},{name:"htmlCommentByBlock",match:"<!--",lookaheadRegExp:/<!--((?:.|\\n)*?)-->/gm,handler:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);t&&t.index===e.matchStart&&(e.output.appendChild(document.createComment(t[1])),e.nextMatch=this.lookaheadRegExp.lastIndex)}},{name:"formatByChar",match:"''|//|__|\\^\\^|~~|==|\\{\\{\\{",handler:function(e){switch(e.matchText){case"''":e.subWikify(insertElement(e.output,"strong"),"''");break;case"//":e.subWikify(insertElement(e.output,"em"),"//");break;case"__":e.subWikify(insertElement(e.output,"u"),"__");break;case"^^":e.subWikify(insertElement(e.output,"sup"),"\\^\\^");break;case"~~":e.subWikify(insertElement(e.output,"sub"),"~~");break;case"==":e.subWikify(insertElement(e.output,"s"),"==");break;case"{{{":var t=/\{\{\{((?:.|\n)*?)\}\}\}/gm;t.lastIndex=e.matchStart;var r=t.exec(e.source);r&&r.index===e.matchStart&&(insertElement(e.output,"code",null,null,r[1]),e.nextMatch=t.lastIndex)}}},{name:"customStyle",match:"@@",terminator:"@@",blockRegExp:/\s*\n/gm,handler:function(t){var r=e.helpers.inlineCSS(t);this.blockRegExp.lastIndex=t.nextMatch;var a=this.blockRegExp.exec(t.source),n=a&&a.index===t.nextMatch,i=insertElement(t.output,n?"div":"span");if(0===r.styles.length&&0===r.classes.length&&""===r.id)i.className="marked";else{for(var s=0;s<r.styles.length;++s)i.style[r.styles[s].style]=r.styles[s].value;for(var s=0;s<r.classes.length;++s)i.classList.add(r.classes[s]);""!==r.id&&(i.id=r.id)}n?(t.nextMatch+=a[0].length,t.subWikify(i,"\\n?"+this.terminator)):t.subWikify(i,this.terminator)}},{name:"emdash",match:"--",handler:function(e){insertText(e.output,"—")}},{name:"lineContinuation",match:"\\\\[\\s\\u00a0\\u2028\\u2029]*?(?:\\n|$)",handler:function(e){e.nextMatch=e.matchStart+e.matchLength}},{name:"lineBreak",match:"\\n|<br ?/?>",handler:function(e){0!==e._nobr.length&&e._nobr[0]||insertElement(e.output,"br")}},{name:"rawText",match:'"{3}|<nowiki>',lookaheadRegExp:/(?:\"{3}|<nowiki>)((?:.|\n)*?)(?:\"{3}|<\/nowiki>)/gm,handler:function(e){this.lookaheadRegExp.lastIndex=e.matchStart;var t=this.lookaheadRegExp.exec(e.source);t&&t.index===e.matchStart&&(insertElement(e.output,"span",null,null,t[1]),e.nextMatch=this.lookaheadRegExp.lastIndex)}},{name:"htmlCharacterReference",match:"(?:(?:&#?[a-zA-Z0-9]{2,8};|.)(?:&#?(?:x0*(?:3[0-6][0-9a-fA-F]|1D[c-fC-F][0-9a-fA-F]|20[d-fD-F][0-9a-fA-F]|FE2[0-9a-fA-F])|0*(?:76[89]|7[7-9][0-9]|8[0-7][0-9]|761[6-9]|76[2-7][0-9]|84[0-3][0-9]|844[0-7]|6505[6-9]|6506[0-9]|6507[0-1]));)+|&#?[a-zA-Z0-9]{2,8};)",handler:function(e){var t=document.createElement("span");t.innerHTML=e.matchText,insertText(e.output,t.textContent),"function"==typeof t.remove&&t.remove()}},{name:"htmlTag",match:"<\\w+(?:\\s+[^\\u0000-\\u001F\\u007F-\\u009F\\s\"'>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*?\"|'[^']*?'|[^\\s\"'=<>`]+))?)*\\s*\\/?>",tagPattern:"<(\\w+)",voidElements:["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],nobrElements:["colgroup","datalist","dl","figure","ol","optgroup","select","table","tbody","tfoot","thead","tr","ul"],handler:function(e){var t=new RegExp(this.tagPattern).exec(e.matchText),r=t&&t[1],a=r&&r.toLowerCase();if(a){var n,i,s,o=this.voidElements.contains(a),l=this.nobrElements.contains(a);if(o||(n="<\\/"+a+"\\s*>",i=new RegExp(n,"gim"),i.lastIndex=e.matchStart,s=i.exec(e.source)),o||s){var u=document.createElement(e.output.tagName);for(u.innerHTML=e.matchText;u.firstChild;)u=u.firstChild;if(u.hasAttribute("data-passage")&&this.processDataAttributes(u),s){l?e._nobr.unshift(!0):0!==e._nobr.length&&e._nobr.unshift(!1);try{e.subWikify(u,n,!0)}finally{0!==e._nobr.length&&e._nobr.shift()}}e.output.appendChild(u)}else throwError(e.output,'HTML tag "'+r+'" is not closed',e.matchText+"…")}},processDataAttributes:function(t){var r=t.getAttribute("data-passage");if(null!=r){r=("string"!=typeof r?String(r):r).trim();var a=e.helpers.evalPassageId(r);if(a!==r&&(r=a,t.setAttribute("data-passage",a)),""!==r)if("IMG"===t.tagName.toUpperCase()){var n;"data:"!==r.slice(0,5)&&Story.has(r)&&(r=Story.get(r),r.tags.contains("Twine.image")&&(n=r.text)),t.src=n}else{var i,s=t.getAttribute("data-setter");null!=s&&(s=("string"!=typeof s?String(s):s).trim(),""!==s&&(i=function(t){return function(){e.evalStatements(t)}}(e.parse(s)))),Story.has(r)?(t.classList.add("link-internal"),config.addVisitedLinkClass&&State.has(r)&&t.classList.add("link-visited")):t.classList.add("link-broken"),jQuery(t).ariaClick({one:!0},function(){"function"==typeof i&&i.call(this),State.play(r)})}}}}]}),e}(),Macro=function(){function macrosAdd(e,t,r){if(Array.isArray(e))return void e.forEach(function(e){macrosAdd(e,t,r)});if(macrosHas(e))throw new Error("cannot clobber existing macro <<"+e+">>");if(tagsHas(e))throw new Error("cannot clobber child tag <<"+e+">> of parent macro"+(1===_tags[e].length?"":"s")+" <<"+_tags[e].join(">>, <<")+">>");try{if("object"==typeof t)_macros[e]=r?clone(t):t;else{if(!macrosHas(t))throw new Error("cannot create alias of nonexistent macro <<"+t+">>");_macros[e]=r?clone(_macros[t]):_macros[t]}Object.defineProperty(_macros,e,{writable:!1}),_macros[e]._MACRO_API=!0}catch(t){throw"TypeError"===t.name?new Error("cannot clobber protected macro <<"+e+">>"):new Error("unknown error when attempting to add macro <<"+e+">>: ["+t.name+"] "+t.message)}if(_macros[e].hasOwnProperty("tags"))if(null==_macros[e].tags)tagsRegister(e);else{if(!Array.isArray(_macros[e].tags))throw new Error('bad value for "tags" property of macro <<'+e+">>");tagsRegister(e,_macros[e].tags)}}function macrosDelete(e){if(Array.isArray(e))return void e.forEach(function(e){macrosDelete(e)});if(macrosHas(e)){_macros[e].hasOwnProperty("tags")&&tagsUnregister(e);try{Object.defineProperty(_macros,e,{writable:!0}),delete _macros[e]}catch(t){throw new Error("unknown error removing macro <<"+e+">>: "+t.message)}}else if(tagsHas(e))throw new Error("cannot remove child tag <<"+e+">> of parent macro <<"+_tags[e]+">>")}function macrosIsEmpty(){return 0===Object.keys(_macros).length}function macrosHas(e){return _macros.hasOwnProperty(e)}function macrosGet(e){var t=null;return macrosHas(e)&&"function"==typeof _macros[e].handler?t=_macros[e]:macros.hasOwnProperty(e)&&"function"==typeof macros[e].handler&&(t=macros[e]),t}function macrosEvalStatements(statements,thisp){try{return eval(null==thisp?'var output = document.createElement("div");(function(){'+statements+"\n})();":"var output = thisp.output;(function(){"+statements+"\n}).call(thisp);"),!0}catch(e){if(null==thisp)throw e;return thisp.error("bad evaluation: "+e.message)}}function macrosInit(e){e=e||"init",Object.keys(_macros).forEach(function(t){"function"==typeof _macros[t][e]&&_macros[t][e].call(_macros[t],t)}),Object.keys(macros).forEach(function(t){"function"==typeof macros[t][e]&&macros[t][e].call(macros[t],t)})}function tagsRegister(e,t){if(!e)throw new Error("no parent specified");Array.isArray(t)||(t=[]);for(var r=["/"+e,"end"+e],a=[].concat(r,t),n=0;n<a.length;++n){var i=a[n];if(macrosHas(i))throw new Error("cannot register tag for an existing macro");tagsHas(i)?_tags[i].contains(e)||(_tags[i].push(e),_tags[i].sort()):_tags[i]=[e]}}function tagsUnregister(e){if(!e)throw new Error("no parent specified");Object.keys(_tags).forEach(function(t){var r=_tags[t].indexOf(e);-1!==r&&(1===_tags[t].length?delete _tags[t]:_tags[t].splice(r,1))})}function tagsHas(e){return _tags.hasOwnProperty(e)}function tagsGet(e){
return tagsHas(e)?_tags[e]:null}var _macros={},_tags={};return Object.freeze(Object.defineProperties({},{add:{value:macrosAdd},delete:{value:macrosDelete},isEmpty:{value:macrosIsEmpty},has:{value:macrosHas},get:{value:macrosGet},evalStatements:{value:macrosEvalStatements},init:{value:macrosInit},tags:{value:Object.freeze(Object.defineProperties({},{register:{value:tagsRegister},unregister:{value:tagsUnregister},has:{value:tagsHas},get:{value:tagsGet}}))}}))}();Object.defineProperties(MacroContext.prototype,{contextHas:{value:function(e){for(var t=this;null!==(t=t.parent);)if(e(t))return!0;return!1}},contextSelect:{value:function(e){for(var t=this,r=[];null!==(t=t.parent);)e(t)&&r.push(t);return r}},error:{value:function(e){return throwError(this.output,"<<"+this.name+">>: "+e,this.source)}}}),Macro.add("actions",{handler:function(){var e=insertElement(this.output,"ul");e.classList.add(this.name),State.variables["#actions"]||(State.variables["#actions"]={});for(var t=0;t<this.args.length;++t){var r,a,n,i,s;"object"==typeof this.args[t]&&this.args[t].isImage?(n=document.createElement("img"),n.src=this.args[t].source,this.args[t].hasOwnProperty("passage")&&n.setAttribute("data-passage",this.args[t].passage),this.args[t].hasOwnProperty("title")&&(n.title=this.args[t].title),this.args[t].hasOwnProperty("align")&&(n.align=this.args[t].align),r=this.args[t].link,i=this.args[t].setFn):"object"==typeof this.args[t]?(a=this.args[t].text,r=this.args[t].link,i=this.args[t].setFn):a=r=this.args[t],State.variables["#actions"].hasOwnProperty(r)&&State.variables["#actions"][r]||(s=Wikifier.createInternalLink(insertElement(e,"li"),r,null,function(e,t){return function(){State.variables["#actions"][e]=!0,"function"==typeof t&&t()}}(r,i)),null==n?insertText(s,a):s.appendChild(n),s.classList.add("macro-"+this.name))}}}),Macro.add(["back","return"],{handler:function(){var e,t,r,a,n=-1;if(this.args.length>1)return this.error("too many arguments specified, check the documentation for details");if(1===this.args.length&&("object"==typeof this.args[0]?this.args[0].isImage?(r=document.createElement("img"),r.src=this.args[0].source,this.args[0].hasOwnProperty("passage")&&r.setAttribute("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&(r.title=this.args[0].title),this.args[0].hasOwnProperty("align")&&(r.align=this.args[0].align),this.args[0].hasOwnProperty("link")&&(e=this.args[0].link)):1===this.args[0].count?e=this.args[0].link:(t=this.args[0].text,e=this.args[0].link):1===this.args.length&&(t=this.args[0])),null==e){for(var i=State.length-2;i>=0;--i)if(State.history[i].title!==State.passage){n=i,e=State.history[i].title;break}null==e&&""!==State.expiredUnique&&(e=State.expiredUnique)}else{if(!Story.has(e))return this.error('passage "'+e+'" does not exist');if("back"===this.name){for(var i=State.length-2;i>=0;--i)if(State.history[i].title===e){n=i;break}if(-1===n)return this.error('cannot find passage "'+e+'" in the current story history')}}return null==e?this.error("cannot find passage"):("back"!==this.name||-1!==n?(a=document.createElement("a"),jQuery(a).addClass("link-internal").ariaClick({one:!0},"return"===this.name?function(){State.play(e)}:function(){State.goTo(n)})):(a=document.createElement("span"),a.classList.add("link-disabled")),a.classList.add("macro-"+this.name),null==r?insertText(a,null!=t?t:strings.macros[this.name].text):a.appendChild(r),void this.output.appendChild(a))}}),Macro.add("choice",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var e,t,r,a,n,i=State.passage;if(1===this.args.length?"object"==typeof this.args[0]&&this.args[0].isImage?(r=document.createElement("img"),r.src=this.args[0].source,this.args[0].hasOwnProperty("passage")&&r.setAttribute("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&(r.title=this.args[0].title),this.args[0].hasOwnProperty("align")&&(r.align=this.args[0].align),e=this.args[0].link,a=this.args[0].setFn):"object"==typeof this.args[0]?(t=this.args[0].text,e=this.args[0].link,a=this.args[0].setFn):t=e=this.args[0]:(e=this.args[0],t=this.args[1]),State.variables.hasOwnProperty("#choice")){if(State.variables["#choice"].hasOwnProperty(i)&&State.variables["#choice"][i])return n=insertElement(this.output,"span"),null==r?insertText(n,t):n.appendChild(r),n.classList.add("link-disabled"),n.classList.add("macro-"+this.name),void n.setAttribute("tabindex",-1)}else State.variables["#choice"]={};n=Wikifier.createInternalLink(this.output,e,null,function(){State.variables["#choice"][i]=!0,"function"==typeof a&&a()}),null==r?insertText(n,t):n.appendChild(r),n.classList.add("macro-"+this.name)}}),Macro.add("display",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var e;if(e="object"==typeof this.args[0]?this.args[0].link:this.args[0],!Story.has(e))return this.error('passage "'+e+'" does not exist');var t=this.output;e=Story.get(e),this.args[1]&&(t=insertElement(t,this.args[1],null,e.domId),t.setAttribute("data-passage",e.title)),new Wikifier(t,e.processText())}}),Macro.add("nobr",{skipArgs:!0,tags:null,handler:function(){new Wikifier(this.output,this.payload[0].contents.replace(/^\n+|\n+$/g,"").replace(/\n+/g," "))}}),Macro.add(["print","=","-"],{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");try{var e=printableStringOrDefault(Util.evalExpression(this.args.full),null);null!==e&&new Wikifier(this.output,"-"===this.name?Util.escape(e):e)}catch(e){return this.error("bad expression: "+e.message)}}}),Macro.add("silently",{skipArgs:!0,tags:null,handler:function(){var e=document.createDocumentFragment(),t=[];for(new Wikifier(e,this.payload[0].contents.trim());e.hasChildNodes();){var r=e.firstChild;r.classList&&r.classList.contains("error")&&t.push(r.textContent),e.removeChild(r)}return t.length>0?this.error("error"+(1===t.length?"":"s")+" within contents ("+t.join("; ")+")"):void 0}}),Macro.add("if",{skipArgs:!0,tags:["elseif","else"],handler:function(){try{for(var e=0,t=this.payload.length;t>e;++e){switch(this.payload[e].name){case"else":if(0!==this.payload[e].arguments.length)return/^\s*if\b/i.test(this.payload[e].arguments)?this.error('whitespace is not allowed between the "else" and "if" in <<elseif>> clause'+(e>0?" (#"+e+")":"")):this.error("<<else>> does not accept a conditional expression (perhaps you meant to use <<elseif>>), invalid: "+this.payload[e].arguments);break;default:if(0===this.payload[e].arguments.length)return this.error("no conditional expression specified for <<"+this.payload[e].name+">> clause"+(e>0?" (#"+e+")":""));if(config.macros.ifAssignmentError&&/[^!=&^|<>*/%+-]=[^=]/.test(this.payload[e].arguments))return this.error('assignment operator "=" found within <<'+this.payload[e].name+">> clause"+(e>0?" (#"+e+")":"")+" (perhaps you meant to use an equality operator: ==, ===, eq, is), invalid: "+this.payload[e].arguments)}if("else"===this.payload[e].name||Wikifier.evalExpression(this.payload[e].arguments)){new Wikifier(this.output,this.payload[e].contents);break}}}catch(t){return this.error("bad conditional expression in <<"+(0===e?"if":"elseif")+">> clause"+(e>0?" (#"+e+")":"")+": "+t.message)}}}),Macro.add("for",{skipArgs:!0,tags:null,handler:function(){var e,t,r,a=this.args.full.trim(),n=this.payload[0].contents.replace(/\n$/,""),i=!0,s=config.macros.maxLoopIterations;if(0===a.length)a=!0;else if(-1!==a.indexOf(";")){if(null===(r=a.match(/^([^;]*?)\s*;\s*([^;]*?)\s*;\s*([^;]*?)$/)))return this.error("invalid 3-part syntax, format: init ; condition ; post");e=r[1],a=r[2],t=r[3]}try{if(runtime.temp.break=null,e)try{Util.evalExpression(e)}catch(e){return this.error("bad init expression: "+e.message)}for(;Util.evalExpression(a);){if(--s<0)return this.error("exceeded configured maximum loop iterations ("+config.macros.maxLoopIterations+")");if(new Wikifier(this.output,i?n.replace(/^\n/,""):n),i&&(i=!1),null!=runtime.temp.break)if(1===runtime.temp.break)runtime.temp.break=null;else if(2===runtime.temp.break){runtime.temp.break=null;break}if(t)try{Util.evalExpression(t)}catch(e){return this.error("bad post expression: "+e.message)}}}catch(e){return this.error("bad conditional expression: "+e.message)}finally{runtime.temp.break=null}}}),Macro.add(["break","continue"],{skipArgs:!0,handler:function(){return this.contextHas(function(e){return"for"===e.name})?void(runtime.temp.break="continue"===this.name?1:2):this.error("must only be used in conjunction with its parent macro <<for>>")}}),Macro.add("set",{skipArgs:!0,handler:function(){return 0===this.args.full.length?this.error("no expression specified"):void Macro.evalStatements(this.args.full,this)}}),Macro.add("unset",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no $variable list specified");for(var e,t=this.args.full,r=/state\.active\.variables\.(\w+)/g;null!==(e=r.exec(t));){var a=e[1];State.variables.hasOwnProperty(a)&&delete State.variables[a]}}}),Macro.add("remember",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no expression specified");var e=this.args.full;if(Macro.evalStatements(e,this)){for(var t,r=storage.get("remember")||{},a=/state\.active\.variables\.(\w+)/g;null!==(t=a.exec(e));){var n=t[1];r[n]=State.variables[n]}if(!storage.set("remember",r))return this.error("unknown error, cannot remember: "+this.args.raw)}},init:function(){var e=storage.get("remember");e&&Object.keys(e).forEach(function(t){State.variables[t]=e[t]})}}),Macro.add("forget",{skipArgs:!0,handler:function(){if(0===this.args.full.length)return this.error("no $variable list specified");for(var e,t=this.args.full,r=/state\.active\.variables\.(\w+)/g,a=storage.get("remember"),n=!1;null!==(e=r.exec(t));){var i=e[1];State.variables.hasOwnProperty(i)&&delete State.variables[i],a&&a.hasOwnProperty(i)&&(n=!0,delete a[i])}return n&&!storage.set("remember",a)?this.error("unknown error, cannot update remember store"):void 0}}),Macro.add("run","set"),Macro.add("script",{skipArgs:!0,tags:null,handler:function(){Macro.evalStatements(this.payload[0].contents,this)}}),Macro.add(["button","click"],{tags:null,handler:function(){if(0===this.args.length)return this.error("no "+("click"===this.name?"link":"button")+" text specified");var e,t=function(){var e;return State.variables.hasOwnProperty("args")&&this.contextHas(function(e){return e.self.isWidget})&&(e=State.variables.args),e}.call(this),r=document.createElement("click"===this.name?"a":"button");if("object"==typeof this.args[0]&&this.args[0].isImage){var a=insertElement(r,"img");a.src=this.args[0].source,this.args[0].hasOwnProperty("passage")&&a.setAttribute("data-passage",this.args[0].passage),this.args[0].hasOwnProperty("title")&&(a.title=this.args[0].title),this.args[0].hasOwnProperty("align")&&(a.align=this.args[0].align),e=this.args[0].link}else{var n;"object"==typeof this.args[0]?(n=this.args[0].text,e=this.args[0].link):(n=this.args[0],e=this.args.length>1?this.args[1]:undefined),insertText(r,n)}null!=e?(r.setAttribute("data-passage",e),Story.has(e)?(r.classList.add("link-internal"),config.addVisitedLinkClass&&State.has(e)&&r.classList.add("link-visited")):r.classList.add("link-broken")):r.classList.add("link-internal"),r.classList.add("macro-"+this.name),jQuery(r).ariaClick({namespace:".macros",one:null!=e},getWikifyEvalHandler(this.payload[0].contents.trim(),t,null!=e?function(){State.play(e)}:undefined)),this.output.appendChild(r)}}),Macro.add("checkbox",{handler:function(){if(this.args.length<3){var e=[];return this.args.length<1&&e.push("$variable name"),this.args.length<2&&e.push("unchecked value"),this.args.length<3&&e.push("checked value"),this.error("no "+e.join(" or ")+" specified")}var t=this.args[0].trim(),r=Util.slugify(t),a=this.args[1],n=this.args[2],i=document.createElement("input");return"$"!==t[0]?this.error('$variable name "'+t+'" is missing its sigil ($)'):(i.type="checkbox",i.id="checkbox-"+r,i.name="checkbox-"+r,i.classList.add("macro-"+this.name),i.setAttribute("tabindex",0),this.args.length>3&&"checked"===this.args[3]?(i.checked=!0,Wikifier.setValue(t,n)):Wikifier.setValue(t,a),jQuery(i).on("change",function(){Wikifier.setValue(t,this.checked?n:a)}),void this.output.appendChild(i))}}),Macro.add("radiobutton",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("$variable name"),this.args.length<2&&e.push("checked value"),this.error("no "+e.join(" or ")+" specified")}var t=this.args[0].trim(),r=Util.slugify(t),a=this.args[1],n=document.createElement("input");return"$"!==t[0]?this.error('$variable name "'+t+'" is missing its sigil ($)'):(runtime.temp.hasOwnProperty("radiobutton")||(runtime.temp.radiobutton={}),runtime.temp.radiobutton.hasOwnProperty(r)||(runtime.temp.radiobutton[r]=0),n.type="radio",n.id="radiobutton-"+r+"-"+runtime.temp.radiobutton[r]++,n.name="radiobutton-"+r,n.classList.add("macro-"+this.name),n.setAttribute("tabindex",0),this.args.length>2&&"checked"===this.args[2]&&(n.checked=!0,Wikifier.setValue(t,a)),jQuery(n).on("change",function(){this.checked&&Wikifier.setValue(t,a)}),void this.output.appendChild(n))}}),Macro.add("textarea",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("$variable name"),this.args.length<2&&e.push("default value"),this.error("no "+e.join(" or ")+" specified")}var t=this.args[0].trim(),r=Util.slugify(t),a=this.args[1],n="autofocus"===this.args[2],i=document.createElement("textarea");return"$"!==t[0]?this.error('$variable name "'+t+'" is missing its sigil ($)'):(i.id="textarea-"+r,i.name="textarea-"+r,i.rows=4,i.cols=68,i.textContent=a,n&&i.setAttribute("autofocus","autofocus"),i.classList.add("macro-"+this.name),i.setAttribute("tabindex",0),Wikifier.setValue(t,a),jQuery(i).on("change",function(){Wikifier.setValue(t,this.value)}),this.output.appendChild(i),void(n&&(postdisplay["#autofocus:"+i.id]=function(e){setTimeout(function(){i.focus()},1),delete postdisplay[e]})))}}),Macro.add("textbox",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("$variable name"),this.args.length<2&&e.push("default value"),this.error("no "+e.join(" or ")+" specified")}var t,r=this.args[0].trim(),a=Util.slugify(r),n=this.args[1],i=!1,s=document.createElement("input");return"$"!==r[0]?this.error('$variable name "'+r+'" is missing its sigil ($)'):(this.args.length>3?(t=this.args[2],i="autofocus"===this.args[3]):this.args.length>2&&("autofocus"===this.args[2]?i=!0:t=this.args[2]),s.type="text",s.id="textbox-"+a,s.name="textbox-"+a,s.value=n,i&&s.setAttribute("autofocus","autofocus"),s.classList.add("macro-"+this.name),s.setAttribute("tabindex",0),Wikifier.setValue(r,n),jQuery(s).on("change",function(){Wikifier.setValue(r,this.value)}).on("keypress",function(e){13===e.which&&(e.preventDefault(),Wikifier.setValue(r,this.value),null!=t&&State.play(t))}),this.output.appendChild(s),void(i&&(postdisplay["#autofocus:"+s.id]=function(e){setTimeout(function(){s.focus()},1),delete postdisplay[e]})))}}),Macro.add(["addclass","toggleclass"],{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("selector"),this.args.length<2&&e.push("class names"),this.error("no "+e.join(" or ")+" specified")}var t=jQuery(this.args[0]);if(0===t.length)return this.error('no elements matched the selector "'+this.args[0]+'"');switch(this.name){case"addclass":t.addClass(this.args[1].trim());break;case"toggleclass":t.toggleClass(this.args[1].trim())}}}),Macro.add("removeclass",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);return 0===e.length?this.error('no elements matched the selector "'+this.args[0]+'"'):void(this.args.length>1?e.removeClass(this.args[1].trim()):e.removeClass())}}),Macro.add("copy",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);return 0===e.length?this.error('no elements matched the selector "'+this.args[0]+'"'):void jQuery(this.output).append(e.html())}}),Macro.add(["append","prepend","replace"],{tags:null,handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);if(0===e.length)return this.error('no elements matched the selector "'+this.args[0]+'"');if("replace"===this.name&&e.empty(),""!==this.payload[0].contents){var t=document.createDocumentFragment();switch(new Wikifier(t,this.payload[0].contents),this.name){case"replace":case"append":e.append(t);break;case"prepend":e.prepend(t)}}}}),Macro.add("remove",{handler:function(){if(0===this.args.length)return this.error("no selector specified");var e=jQuery(this.args[0]);return 0===e.length?this.error('no elements matched the selector "'+this.args[0]+'"'):void e.remove()}}),Macro.add("goto",{handler:function(){if(0===this.args.length)return this.error("no passage specified");var e;return e="object"==typeof this.args[0]?this.args[0].link:this.args[0],Story.has(e)?void setTimeout(function(){State.play(e)},40):this.error('passage "'+e+'" does not exist')}}),Macro.add("timed",{tags:["next"],timers:{},handler:function(){if(0===this.args.length)return this.error("no time value specified in <<timed>>");var e=[];try{e.push({delay:Math.max(10,Util.fromCSSTime(this.args[0].trim())),content:this.payload[0].contents})}catch(e){return this.error(e.message+" in <<timed>>")}if(this.payload.length>1)try{for(var t=1,r=this.payload.length;r>t;++t)e.push({delay:0===this.payload[t].arguments.length?e[e.length-1].delay:Math.max(10,Util.fromCSSTime(this.payload[t].arguments.trim())),content:this.payload[t].contents})}catch(e){return this.error(e.message+" in <<next>> (#"+t+")")}Object.defineProperty(e,"nextItem",{value:this.self.arrayNextItemFactory()}),this.self.registerTimeout(insertElement(this.output,"span",null,"macro-timed timed-insertion-container"),e)},arrayNextItemFactory:function(){return function(){return 0===this.length?null:this.shift()}},registerTimeout:function(e,t){var r=turns(),a=this.timers,n=null,i=t.nextItem(),s=function(){if(delete a[n],r===turns()){var o=i;null!==(i=t.nextItem())&&(a[n=setTimeout(s,i.delay)]=!0);var l=document.createDocumentFragment();new Wikifier(l,o.content),e.appendChild(l)}};a[n=setTimeout(s,i.delay)]=!0,predisplay.hasOwnProperty("#timed-timers-cleanup")||(predisplay["#timed-timers-cleanup"]=function(e){for(var t=Object.keys(a),r=0;r<t.length;++r)delete a[t[r]],clearTimeout(t[r]);delete predisplay[e]})}}),Macro.add("widget",{tags:null,handler:function(){if(0===this.args.length)return this.error("no widget name specified");var e=this.args[0];if(Macro.has(e)){if(!Macro.get(e).isWidget)return this.error('cannot clobber existing macro "'+e+'"');Macro.delete(e)}try{Macro.add(e,{isWidget:!0,handler:function(e){return function(){var t;try{State.variables.hasOwnProperty("args")&&(t=State.variables.args),State.variables.args=[];for(var r=0,a=this.args.length;a>r;++r)State.variables.args[r]=this.args[r];State.variables.args.raw=this.args.raw,State.variables.args.full=this.args.full;var n=document.createDocumentFragment(),i=document.createDocumentFragment(),s=[];for(new Wikifier(i,e);i.hasChildNodes();){var o=i.firstChild;o.classList&&o.classList.contains("error")&&s.push(o.textContent),n.appendChild(o)}if(0!==s.length)return this.error("error"+(1===s.length?"":"s")+" within widget contents ("+s.join("; ")+")");this.output.appendChild(n)}catch(e){return this.error("cannot execute widget: "+e.message)}finally{delete State.variables.args,"undefined"!=typeof t&&(State.variables.args=t)}}}(this.payload[0].contents)})}catch(t){return this.error('cannot create widget macro "'+e+'": '+t.message)}}}),Has.audio?(Macro.add("audio",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("track ID"),this.args.length<2&&e.push("actions"),this.error("no "+e.join(" or ")+" specified")}var t=Macro.get("cacheaudio").tracks,r=this.args[0];if(!t.hasOwnProperty(r))return this.error("no track by ID: "+r);for(var a,n,i,s,o,l,u,c,d=t[r],h=this.args.slice(1);h.length>0;){var p=h.shift();switch(p){case"play":case"pause":case"stop":a=p;break;case"fadein":a="fade",l=1;break;case"fadeout":a="fade",l=0;break;case"fadeto":if(0===h.length)return this.error("fadeto missing required level value");if(a="fade",c=h.shift(),l=parseFloat(c),isNaN(l)||!isFinite(l))return this.error("cannot parse fadeto: "+c);break;case"volume":if(0===h.length)return this.error("volume missing required level value");if(c=h.shift(),n=parseFloat(c),isNaN(n)||!isFinite(n))return this.error("cannot parse volume: "+c);break;case"mute":case"unmute":i="mute"===p;break;case"time":if(0===h.length)return this.error("time missing required seconds value");if(c=h.shift(),s=parseFloat(c),isNaN(s)||!isFinite(s))return this.error("cannot parse time: "+c);break;case"loop":case"unloop":o="loop"===p;break;case"goto":if(0===h.length)return this.error("goto missing required passage title");if(c=h.shift(),u="object"==typeof c?c.link:c,!Story.has(u))return this.error('passage "'+u+'" does not exist');break;default:return this.error("unknown action: "+p)}}try{switch(null!=n&&(d.volume=n),null!=s&&(d.time=s),null!=i&&(i?d.mute():d.unmute()),null!=o&&(o?d.loop():d.unloop()),null!=u&&d.oneEnd(function(){State.play(u)}),a){case"play":d.play();break;case"pause":d.pause();break;case"stop":d.stop();break;case"fade":d.volume===l&&(0===l?d.volume=1:1===l&&(d.volume=0)),d.fade(d.volume,l)}}catch(e){return this.error("error playing audio: "+e.message)}}}),Macro.add("stopallaudio",{handler:function(){var e=Macro.get("cacheaudio").tracks;Object.keys(e).forEach(function(t){e[t].stop()})}}),Macro.add("cacheaudio",{handler:function(){if(this.args.length<2){var e=[];return this.args.length<1&&e.push("track ID"),this.args.length<2&&e.push("sources"),this.error("no "+e.join(" or ")+" specified")}for(var t=this.self.types,r=this.self.canPlay,a=document.createElement("audio"),n=this.args[0],i=/^.+?(?:\.([^\.\/\\]+?))$/,s=1;s<this.args.length;++s){var o=this.args[s],l=i.exec(o);if(null!==l){var u=l[1].toLowerCase(),c=t.hasOwnProperty(u)?t[u]:"audio/"+u;if(r.hasOwnProperty(c)||(r[c]=""!==a.canPlayType(c).replace(/^no$/i,"")),r[c]){var d=document.createElement("source");d.src=o,d.type=c,a.appendChild(d)}}}a.hasChildNodes()&&(a.preload="auto",this.self.tracks[n]=new AudioWrapper(a))},types:Object.freeze({mp3:"audio/mpeg; codecs=mp3",ogg:"audio/ogg; codecs=vorbis",webm:"audio/webm; codecs=vorbis",wav:"audio/wav; codecs=1"}),canPlay:{},tracks:{}}),Macro.add("playlist",{handler:function(){if(0===this.args.length)return this.error("no actions specified");for(var e,t,r,a,n,i,s,o=this.self,l=this.args.slice(0);l.length>0;){var u=l.shift();switch(u){case"play":case"pause":case"stop":e=u;break;case"fadein":e="fade",i=1;break;case"fadeout":e="fade",i=0;break;case"fadeto":if(0===l.length)return this.error("fadeto missing required level value");if(e="fade",s=l.shift(),i=parseFloat(s),isNaN(i)||!isFinite(i))return this.error("cannot parse fadeto: "+s);break;case"volume":if(0===l.length)return this.error("volume missing required level value");if(s=l.shift(),t=parseFloat(s),isNaN(t)||!isFinite(t))return this.error("cannot parse volume: "+s);break;case"mute":case"unmute":r="mute"===u;break;case"loop":case"unloop":a="loop"===u;break;case"shuffle":case"unshuffle":n="shuffle"===u;break;default:return this.error("unknown action: "+u)}}try{switch(null!=t&&o.setVolume(t),null!=r&&(o.muted=r,r?o.mute():o.unmute()),null!=a&&(o.loop=a),null!=n&&(o.shuffle=n,o.buildList()),e){case"play":o.play();break;case"pause":o.pause();break;case"stop":o.stop();break;case"fade":o.volume===i&&(0===i?o.setVolume(1):1===i&&o.setVolume(0)),o.fade(i)}}catch(e){return this.error("error playing audio: "+e.message)}},play:function(){0===this.list.length&&this.buildList(),(null===this.current||this.current.isEnded())&&this.next(),this.current.play()},pause:function(){null!==this.current&&this.current.pause()},stop:function(){null!==this.current&&this.current.stop()},fade:function(e){0===this.list.length&&this.buildList(),null===this.current||this.current.isEnded()?this.next():this.current.volume=this.volume,this.current.fade(this.current.volume,e),this.volume=e},mute:function(){null!==this.current&&this.current.mute()},unmute:function(){null!==this.current&&this.current.unmute()},next:function(){this.current=this.list.shift(),this.current.volume=this.volume},setVolume:function(e){this.volume=e,null!==this.current&&(this.current.volume=e)},onEnd:function(){var thisp=Macro.get("playlist");if(0===thisp.list.length){if(!thisp.loop)return;thisp.buildList()}thisp.next(),thisp.muted&&thisp.mute(),thisp.current.play()},buildList:function(){this.list=this.tracks.slice(0),this.shuffle&&(this.list.shuffle(),this.list.length>1&&this.list[0]===this.current&&this.list.push(this.list.shift()))},tracks:[],list:[],current:null,volume:1,muted:!1,loop:!0,shuffle:!1}),Macro.add("setplaylist",{handler:function(){if(0===this.args.length)return this.error("no track ID(s) specified");for(var e=Macro.get("cacheaudio").tracks,t=Macro.get("playlist"),r=[],a=0;a<this.args.length;++a){var n=this.args[a];if(!e.hasOwnProperty(n))return this.error("no track by ID: "+n);var i=e[n].clone();i.stop(),i.unloop(),i.unmute(),i.volume=1,jQuery(i.audio).off("ended").on("ended.macros:playlist",t.onEnd),r.push(i)}null!==t.current&&t.current.pause(),t.tracks=r,t.list=[],t.current=null,t.volume=1,t.muted=!1,t.loop=!0,t.shuffle=!1}})):Macro.add(["audio","stopallaudio","cacheaudio","playlist","setplaylist"],{handler:function(){}});var Save=function(){function e(){if("cookie"===storage.name)return a(),config.saves.autosave=undefined,config.saves.slots=0,!1;config.saves.slots<0&&(config.saves.slots=0);var e=r(),t=!1;Array.isArray(e)&&(e={autosave:null,slots:e},t=!0),config.saves.slots!==e.slots.length&&(config.saves.slots<e.slots.length?(e.slots.reverse(),e.slots=e.slots.filter(function(e){return null===e&&this.count>0?(--this.count,!1):!0},{count:e.slots.length-config.saves.slots}),e.slots.reverse()):config.saves.slots>e.slots.length&&x(e.slots,config.saves.slots-e.slots.length),t=!0);var n=function(e){e.hasOwnProperty("data")?(delete e.mode,e.state={delta:State.deltaEncode(e.data)},delete e.data):e.state.hasOwnProperty("delta")?e.state.hasOwnProperty("index")||delete e.state.mode:(delete e.state.mode,e.state.delta=State.deltaEncode(e.state.history),delete e.state.history),e.state.index=e.state.delta.length-1,e.state.hasOwnProperty("rseed")&&(e.state.seed=e.state.rseed,delete e.state.rseed,e.state.delta.forEach(function(e,t,r){r[t].hasOwnProperty("rcount")&&(r[t].pull=r[t].rcount,delete r[t].rcount)}))};null!==e.autosave&&(e.autosave.hasOwnProperty("state")&&e.autosave.state.hasOwnProperty("delta")&&e.autosave.state.hasOwnProperty("index")&&!e.autosave.state.hasOwnProperty("rseed")||(n(e.autosave),t=!0));for(var i=0;i<e.slots.length;++i)null!==e.slots[i]&&(e.slots[i].hasOwnProperty("state")&&e.slots[i].state.hasOwnProperty("delta")&&e.slots[i].state.hasOwnProperty("index")&&!e.slots[i].state.hasOwnProperty("rseed")||(n(e.slots[i]),t=!0));return S(e)&&(storage.delete("saves"),t=!1),t&&E(e),A=e.slots.length-1,!0}function t(){return{autosave:null,slots:x([],config.saves.slots)}}function r(){var e=storage.get("saves");return null===e?t():e}function a(){return storage.delete("saves"),!0}function n(){return i()||d()}function i(){return"cookie"!==storage.name&&"undefined"!=typeof config.saves.autosave}function s(){var e=r();return null===e.autosave?!1:!0}function o(){var e=r();return e.autosave}function l(){var e=r();return null===e.autosave?!1:j(e.autosave)}function u(e,t){if("function"==typeof config.saves.isAllowed&&!config.saves.isAllowed())return!1;var a=r();return a.autosave=O(),a.autosave.title=e||Story.get(State.passage).description(),a.autosave.date=Date.now(),null!=t&&(a.autosave.metadata=t),E(a)}function c(){var e=r();return e.autosave=null,E(e)}function d(){return"cookie"!==storage.name&&-1!==A}function h(){return A+1}function p(){if(!d())return 0;for(var e=r(),t=0,a=0;a<e.slots.length;++a)null!==e.slots[a]&&++t;return t}function f(){return 0===p()}function g(e){if(0>e||e>A)return!1;var t=r();return e>=t.slots.length||null===t.slots[e]?!1:!0}function m(e){if(0>e||e>A)return null;var t=r();return e>=t.slots.length?null:t.slots[e]}function v(e){if(0>e||e>A)return!1;var t=r();return e>=t.slots.length||null===t.slots[e]?!1:j(t.slots[e])}function y(e,t,a){if("function"==typeof config.saves.isAllowed&&!config.saves.isAllowed())return UI.alert(strings.saves.disallowed),!1;if(0>e||e>A)return!1;var n=r();return e>=n.slots.length?!1:(n.slots[e]=O(),n.slots[e].title=t||Story.get(State.passage).description(),n.slots[e].date=Date.now(),null!=a&&(n.slots[e].metadata=a),E(n))}function b(e){if(0>e||e>A)return!1;var t=r();return e>=t.slots.length?!1:(t.slots[e]=null,E(t))}function w(){if("function"==typeof config.saves.isAllowed&&!config.saves.isAllowed())return void UI.alert(strings.saves.disallowed);var e=Story.domId+".save",t=LZString.compressToBase64(JSON.stringify(O()));saveAs(new Blob([t],{type:"text/plain;charset=UTF-8"}),e)}function k(e){var t=e.target.files[0],r=new FileReader;jQuery(r).on("load",function(e){if(e.target.result){var r;try{r=JSON.parse(/\.json$/i.test(t.name)||/^\{/.test(e.target.result)?e.target.result:LZString.decompressFromBase64(e.target.result))}catch(e){}j(r)}}),r.readAsText(t)}function x(e,t){for(var r=0;t>r;++r)e.push(null);return e}function S(e){for(var t=!0,r=0;r<e.slots.length;++r)if(null!==e.slots[r]){t=!1;break}return null===e.autosave&&t}function E(e){return S(e)?(storage.delete("saves"),!0):storage.set("saves",e)}function O(){var e={id:config.saves.id,state:State.marshalForSave()};return config.saves.version&&(e.version=config.saves.version),"function"==typeof config.saves.onSave&&config.saves.onSave(e),e.state.delta=State.deltaEncode(e.state.history),delete e.state.history,e}function j(e){try{if(!e||!e.hasOwnProperty("id")||!e.hasOwnProperty("state"))throw new Error(strings.errors.saveMissingData);if(delete e.state.mode,e.state.hasOwnProperty("index")||(e.state.index=e.state.delta.length-1),e.state.hasOwnProperty("rseed")&&(e.state.seed=e.state.rseed,delete e.state.rseed,e.state.delta.forEach(function(e,t,r){r[t].hasOwnProperty("rcount")&&(r[t].pull=r[t].rcount,delete r[t].rcount)})),e.state.history=State.deltaDecode(e.state.delta),delete e.state.delta,"function"==typeof config.saves.onLoad&&config.saves.onLoad(e),e.id!==config.saves.id)throw new Error(strings.errors.saveIdMismatch);State.unmarshalForSave(e.state)}catch(e){return UI.alert(e.message[0].toUpperCase()+e.message.slice(1)+".</p><p>"+strings.aborting+"."),!1}return!0}var A=-1;return Object.freeze(Object.defineProperties({},{init:{value:e},get:{value:r},clear:{value:a},ok:{value:n},autosave:{value:Object.freeze(Object.defineProperties({},{ok:{value:i},has:{value:s},get:{value:o},load:{value:l},save:{value:u},delete:{value:c}}))},slots:{value:Object.freeze(Object.defineProperties({},{ok:{value:d},length:{get:h},isEmpty:{value:f},count:{value:p},has:{value:g},get:{value:m},load:{value:v},save:{value:y},delete:{value:b}}))},export:{value:w},import:{value:k}}))}(),Setting=function(){function e(){if(storage.has("options")){var e=storage.get("options");null!==e&&(window.SugarCube.settings=settings=Object.assign(r(),e)),a(),storage.delete("options")}n(),g.forEach(function(e){if(e.hasOwnProperty("onInit")){var thisp={name:e.name,value:settings[e.name],default:e.default};e.hasOwnProperty("list")&&(thisp.list=e.list),e.onInit.call(thisp)}})}function t(){return Object.keys(settings).length>0?!g.some(function(e){return settings[e.name]!==e.default}):!0}function r(){return Object.create(null)}function a(){return 0===Object.keys(settings).length||t()?(storage.delete("settings"),!0):storage.set("settings",settings)}function n(){var e=r(),t=storage.get("settings");g.forEach(function(e){settings[e.name]=e.default}),null!==t&&(window.SugarCube.settings=settings=Object.assign(e,t));
}function i(){return window.SugarCube.settings=settings=r(),a()}function s(e){if(0===arguments.length)i(),g.forEach(function(e){settings[e.name]=e.default});else{if(null==e||!h(e))throw new Error('nonexistent setting "'+e+'"');settings[e]=p(e).default}return a()}function o(e,thisp){g.forEach(e,thisp)}function l(e,t,r){if(arguments.length<3){var a=[];throw arguments.length<1&&a.push("type"),arguments.length<2&&a.push("name"),arguments.length<3&&a.push("definition"),new Error("missing parameters, no "+a.join(" or ")+" specified")}if("object"!=typeof r)throw new TypeError("definition parameter must be an object");if(h(t))throw new Error('cannot clobber existing setting "'+t+'"');var n={type:e,name:t,label:null==r.label?"":String(r.label).trim()};switch(e){case m.Toggle:n.default=!!r.default;break;case m.List:if(!r.hasOwnProperty("list"))throw new Error("no list specified");if(!Array.isArray(r.list))throw new TypeError("list must be an array");if(0===r.list.length)throw new Error("list must not be empty");if(n.list=Object.freeze(r.list),null==r.default)n.default=r.list[0];else{var i=r.list.indexOf(r.default);if(-1===i)throw new Error("list does not contain default");n.default=r.list[i]}break;default:throw new Error("unknown Setting type: "+e)}"function"==typeof r.onInit&&(n.onInit=Object.freeze(r.onInit)),"function"==typeof r.onChange&&(n.onChange=Object.freeze(r.onChange)),g.push(Object.freeze(n))}function u(){l.apply(this,[m.Toggle].concat(Array.from(arguments)))}function c(){l.apply(this,[m.List].concat(Array.from(arguments)))}function d(){return 0===g.length}function h(e){return g.some(function(e){return e.name===this},e)}function p(e){return g.find(function(e){return e.name===this},e)}function f(e){h(e)&&delete settings[e];for(var t=0;t<g.length;++t)if(g[t].name===e){g.splice(t,1),f(e);break}}var g=[],m=Object.freeze({Toggle:0,List:1});return Object.freeze(Object.defineProperties({},{Types:{value:m},init:{value:e},create:{value:r},save:{value:a},load:{value:n},clear:{value:i},reset:{value:s},forEach:{value:o},add:{value:l},addToggle:{value:u},addList:{value:c},isEmpty:{value:d},has:{value:h},get:{value:p},delete:{value:f}}))}(),UI=function(){function e(){jQuery("#init-no-js, #init-lacking").remove(),_=document.createElement("style"),_.id="style-outline-patch",_.type="text/css",document.head.appendChild(_),I=function(){var e;try{var t=document.createElement("p");t.style.width="100%",t.style.height="200px";var r=document.createElement("div");r.style.position="absolute",r.style.left="0px",r.style.top="0px",r.style.width="100px",r.style.height="100px",r.style.visibility="hidden",r.style.overflow="hidden",r.appendChild(t),document.body.appendChild(r);var a=t.offsetWidth;r.style.overflow="auto";var n=t.offsetWidth;a===n&&(n=r.clientWidth),document.body.removeChild(r),e=a-n}catch(e){}return e||17}();var e=document.getElementById("store-area"),t=document.createDocumentFragment(),r=document.createElement("div");for(r.innerHTML='<div id="ui-bar"><div id="ui-bar-tray">'+String.format('<button id="ui-bar-toggle" tabindex="0" title="{0}" aria-label="{0}"></button>',strings.uiBar.toggle)+'<div id="ui-bar-history">'+String.format('<button id="history-backward" tabindex="0" title="{0}" aria-label="{0}"></button>',strings.uiBar.backward.replace(/%identity%/g,strings.identity))+String.format('<button id="history-jumpto" tabindex="0" title="{0}" aria-label="{0}"></button>',strings.uiBar.jumpto.replace(/%identity%/g,strings.identity))+String.format('<button id="history-forward" tabindex="0" title="{0}" aria-label="{0}"></button>',strings.uiBar.forward.replace(/%identity%/g,strings.identity))+'</div></div><div id="ui-bar-body"><header id="title" role="banner"><div id="story-banner"></div><h1 id="story-title"></h1><div id="story-subtitle"></div><div id="story-title-separator"></div><p id="story-author"></p></header><div id="story-caption"></div><nav id="menu" role="navigation"><ul id="menu-story"></ul><ul id="menu-core"><li id="menu-item-saves"><a tabindex="0">'+strings.saves.title+'</a></li><li id="menu-item-settings"><a tabindex="0">'+strings.settings.title+'</a></li><li id="menu-item-restart"><a tabindex="0">'+strings.restart.title+'</a></li><li id="menu-item-share"><a tabindex="0">'+strings.share.title+'</a></li></ul></nav></div></div><div id="ui-overlay" class="ui-close"></div><div id="ui-dialog" tabindex="0" role="dialog" aria-labelledby="ui-dialog-title"><div id="ui-dialog-titlebar"><h1 id="ui-dialog-title"></h1><button id="ui-dialog-close" class="ui-close" tabindex="0" aria-label="'+strings.close+'"></button></div><div id="ui-dialog-body"></div></div><div id="story" role="main"><div id="passages"></div></div>';r.hasChildNodes();)t.appendChild(r.firstChild);O=t.querySelector("#ui-bar"),j=t.querySelector("#ui-overlay"),A=t.querySelector("#ui-dialog"),C=t.querySelector("#ui-dialog-title"),P=t.querySelector("#ui-dialog-close"),T=t.querySelector("#ui-dialog-body"),e.parentNode.insertBefore(t,e),jQuery(document).on("tw:historyupdate",function(e,t){return function(){e.prop("disabled",State.length<2),t.prop("disabled",State.length===State.size)}}(jQuery("#history-backward"),jQuery("#history-forward"))).on("mousedown.outline-handler keydown.outline-handler",function(e){switch(e.type){case"mousedown":a(!0);break;case"keydown":a(!1)}})}function t(){if(config.ui.stowBarInitially||jQuery(window).width()<=800){var e=jQuery("#ui-bar,#story");e.addClass("no-transition"),O.classList.add("stowed"),setTimeout(function(){e.removeClass("no-transition")},100)}jQuery("#ui-bar-toggle").ariaClick({label:strings.uiBar.toggle},function(){jQuery(O).toggleClass("stowed")}),config.history.controls?(jQuery("#history-backward").prop("disabled",State.length<2).ariaClick({label:strings.uiBar.backward.replace(/%identity%/g,strings.identity)},function(){State.backward()}),(0===config.history.maxStates||config.history.maxStates>10)&&Story.lookup("tags","bookmark").length>0?jQuery("#history-jumpto").ariaClick({label:strings.uiBar.jumpto.replace(/%identity%/g,strings.identity)},function(){UI.jumpto()}):jQuery("#history-jumpto").remove(),jQuery("#history-forward").prop("disabled",State.length===State.size).ariaClick({label:strings.uiBar.forward.replace(/%identity%/g,strings.identity)},function(){State.forward()})):jQuery("#ui-bar-history").remove(),setPageElement("story-title","StoryTitle",Story.title),Story.has("StoryCaption")||jQuery("#story-caption").remove(),Story.has("StoryMenu")||jQuery("#menu-story").remove(),r(),w("#menu-item-saves a",null,i).text(strings.saves.title),Setting.isEmpty()?jQuery("#menu-item-settings").remove():w("#menu-item-settings a",null,o).text(strings.settings.title),w("#menu-item-restart a",null,s).text(strings.restart.title),Story.has("StoryShare")?w("#menu-item-share a",null,l).text(strings.share.title):jQuery("#menu-item-share").remove(),"complete"===document.readyState&&document.documentElement.classList.remove("init-loading"),document.addEventListener("readystatechange",function(){"complete"===document.readyState?config.loadDelay>0?setTimeout(function(){document.documentElement.classList.remove("init-loading")},config.loadDelay):document.documentElement.classList.remove("init-loading"):document.documentElement.classList.add("init-loading")},!1)}function r(){setPageElement("story-banner","StoryBanner"),setPageElement("story-subtitle","StorySubtitle"),setPageElement("story-author","StoryAuthor"),setPageElement("story-caption","StoryCaption");var e=document.getElementById("menu-story");null!==e&&(removeChildren(e),Story.has("StoryMenu")&&c("StoryMenu",e))}function a(e){var t=new StyleWrapper(_);e?t.set("*:focus{outline:none}"):t.clear()}function n(){var e=document.createElement("ul");jQuery(b(strings.jumpto.title,"jumpto list")).append(e);for(var t=State.size-1;t>=0;--t)if(t!==State.activeIndex){var r=Story.get(State.history[t].title);if(r&&r.tags.contains("bookmark")){var a=document.createElement("li"),n=document.createElement("a");jQuery(n).ariaClick({one:!0},function(e){return function(){State.goTo(e)}}(t)).addClass("ui-close").text(strings.jumpto.turn+" "+(State.expired+t+1)+": "+r.description()),a.appendChild(n),e.appendChild(a)}}e.hasChildNodes()||jQuery(e).append("<li><a><i>"+strings.jumpto.unavailable+"</i></a></li>")}function i(){function e(e,t,r,a){var n=document.createElement("li"),i=jQuery(document.createElement("button"));return i.attr("id","saves-"+e).html(r),t&&i.addClass(t),a?i.ariaClick(a):i.prop("disabled",!0),i.appendTo(n),n}function t(){function e(e,t,r,a,n){var i=jQuery(document.createElement("button"));return i.attr("id","saves-"+e+"-"+a).addClass(e).html(r),t&&i.addClass(t),n?"auto"===a?i.ariaClick({label:r+" "+strings.saves.labelAuto},function(){n()}):i.ariaClick({label:r+" "+strings.saves.labelSlot+" "+(a+1)},function(){n(a)}):i.prop("disabled",!0),i[0]}var t,r,a,n,s,o,l,u,c=Save.get(),d=document.createElement("tbody");Save.autosave.ok()&&(t=document.createElement("tr"),r=document.createElement("td"),a=document.createElement("td"),s=document.createElement("td"),l=document.createElement("td"),o=document.createElement("b"),o.innerHTML="A",o.title=strings.saves.labelAuto,r.appendChild(o),c.autosave?(n=e("load","ui-close",strings.saves.labelLoad,"auto",Save.autosave.load),a.appendChild(n),o=document.createElement("div"),o.appendChild(document.createTextNode(c.autosave.title)),s.appendChild(o),o=document.createElement("div"),o.classList.add("datestamp"),c.autosave.date?o.innerHTML=strings.saves.savedOn+" "+new Date(c.autosave.date).toLocaleString():o.innerHTML=strings.saves.savedOn+" <em>"+strings.saves.unknownDate+"</em>",s.appendChild(o),u=e("delete",null,strings.saves.labelDelete,"auto",function(){Save.autosave.delete(),i()}),l.appendChild(u)):(n=e("load",null,strings.saves.labelLoad,"auto"),a.appendChild(n),o=document.createElement("i"),o.innerHTML=strings.saves.emptySlot,s.appendChild(o),s.classList.add("empty"),u=e("delete",null,strings.saves.labelDelete,"auto"),l.appendChild(u)),t.appendChild(r),t.appendChild(a),t.appendChild(s),t.appendChild(l),d.appendChild(t));for(var h=0;h<c.slots.length;++h)t=document.createElement("tr"),r=document.createElement("td"),a=document.createElement("td"),s=document.createElement("td"),l=document.createElement("td"),r.appendChild(document.createTextNode(h+1)),c.slots[h]?(n=e("load","ui-close",strings.saves.labelLoad,h,Save.slots.load),a.appendChild(n),o=document.createElement("div"),o.appendChild(document.createTextNode(c.slots[h].title)),s.appendChild(o),o=document.createElement("div"),o.classList.add("datestamp"),c.slots[h].date?o.innerHTML=strings.saves.savedOn+" "+new Date(c.slots[h].date).toLocaleString():o.innerHTML=strings.saves.savedOn+" <em>"+strings.saves.unknownDate+"</em>",s.appendChild(o),u=e("delete",null,strings.saves.labelDelete,h,function(e){Save.slots.delete(e),i(),S()}),l.appendChild(u)):(n=e("save","ui-close",strings.saves.labelSave,h,Save.slots.save),a.appendChild(n),o=document.createElement("i"),o.innerHTML=strings.saves.emptySlot,s.appendChild(o),s.classList.add("empty"),u=e("delete",null,strings.saves.labelDelete,h),l.appendChild(u)),t.appendChild(r),t.appendChild(a),t.appendChild(s),t.appendChild(l),d.appendChild(t);var p=document.createElement("table");return p.id="saves-list",p.appendChild(d),p}var r,a,n=Save.ok(),s=Save.autosave.has()||!Save.slots.isEmpty();return b(strings.saves.title,"saves"),n&&(r=t(),r||(r=document.createElement("div"),r.id="saves-list",r.innerHTML="<i>"+strings.saves.unavailable+"</i>"),T.appendChild(r)),s||Has.fileAPI?(a=document.createElement("ul"),a.classList.add("buttons"),Has.fileAPI&&(a.appendChild(e("export","ui-close",strings.saves.labelExport,Save.export)),a.appendChild(e("import",null,strings.saves.labelImport,function(){jQuery("#saves-import-file",T).trigger("click")}))),n&&a.appendChild(e("clear",null,strings.saves.labelClear,s?function(){Save.clear(),i(),S()}:null)),T.appendChild(a),Has.fileAPI&&T.appendChild(function(){var e=document.createElement("input");return jQuery(e).css({display:"block",visibility:"hidden",position:"fixed",left:"-9999px",top:"-9999px",width:"1px",height:"1px"}).attr("type","file").attr("id","saves-import-file").attr("tabindex",-1).attr("aria-hidden",!0).on("change",function(e){Save.import(e),x()}),e}()),!0):(d(strings.saves.incapable.replace(/%identity%/g,strings.identity)),!1)}function s(){return jQuery(b(strings.restart.title,"restart")).append("<p>"+strings.restart.prompt+'</p><ul class="buttons"><li><button id="restart-ok" class="ui-close">'+(strings.restart.ok||strings.ok)+'</button></li><li><button id="restart-cancel" class="ui-close">'+(strings.restart.cancel||strings.cancel)+"</button></li></ul>"),jQuery("#ui-dialog-body #restart-ok").one("click",function(){State.restart()}),!0}function o(){return b(strings.settings.title,"settings"),Setting.forEach(function(e){var t,r=e.name,a=Util.slugify(r),n=document.createElement("div"),i=document.createElement("label"),s=document.createElement("div");switch(n.appendChild(i),n.appendChild(s),n.id="setting-body-"+a,i.id="setting-label-"+a,new Wikifier(i,e.label),null==settings[r]&&(settings[r]=e.default),e.type){case Setting.Types.Toggle:t=document.createElement("button"),settings[r]?jQuery(t).addClass("enabled").text(strings.settings.on):jQuery(t).text(strings.settings.off),jQuery(t).ariaClick(function(){settings[r]?(jQuery(this).removeClass("enabled").text(strings.settings.off),settings[r]=!1):(jQuery(this).addClass("enabled").text(strings.settings.on),settings[r]=!0),Setting.save(),e.hasOwnProperty("onChange")&&e.onChange.call({name:r,value:settings[r],default:e.default})});break;case Setting.Types.List:t=document.createElement("select");for(var o=0;o<e.list.length;++o){var l=document.createElement("option");jQuery(l).val(o).text(e.list[o]),t.appendChild(l)}jQuery(t).val(e.list.indexOf(settings[r])).attr("tabindex",0).on("change",function(){settings[r]=e.list[+this.value],Setting.save(),e.hasOwnProperty("onChange")&&e.onChange.call({name:r,value:settings[r],default:e.default,list:e.list})})}t.id="setting-control-"+a,s.appendChild(t),i.setAttribute("for",t.id),T.appendChild(n)}),jQuery(T).append('<ul class="buttons"><li><button id="settings-ok" class="ui-close">'+(strings.settings.ok||strings.ok)+'</button></li><li><button id="settings-reset" class="ui-close">'+strings.settings.reset+"</button></li></ul>"),jQuery("#ui-dialog-body #settings-reset").one("click",function(){Setting.reset(),window.location.reload()}),!0}function l(){return jQuery(b(strings.share.title,"share list")).append(c("StoryShare")),!0}function u(){return jQuery(b(strings.autoload.title,"autoload")).append("<p>"+strings.autoload.prompt+'</p><ul class="buttons"><li><button id="autoload-ok" class="ui-close">'+(strings.autoload.ok||strings.ok)+'</button></li><li><button id="autoload-cancel" class="ui-close">'+(strings.autoload.cancel||strings.cancel)+"</button></li></ul>"),jQuery(document.body).one("click.autoload",".ui-close",function(e){"autoload-ok"===e.target.id&&Save.autosave.load()||State.play(config.passages.start)}),!0}function c(e,t){null==t&&(t=document.createElement("ul"));var r=document.createDocumentFragment();if(new Wikifier(r,Story.get(e).processText().trim()),r.hasChildNodes())for(var a=null;r.hasChildNodes();){var n=r.firstChild;n.nodeType!==Node.ELEMENT_NODE||"A"!==n.nodeName.toUpperCase()?(r.removeChild(n),null!==a&&(a=null)):(null===a&&(a=document.createElement("li"),t.appendChild(a)),a.appendChild(n))}return t}function d(e,t,r){jQuery(b("Alert","alert")).append("<p>"+e+'</p><ul class="buttons"><li><button id="alert-ok" class="ui-close">'+(strings.alert.ok||strings.ok)+"</button></li></ul>"),k(t,r)}function h(){n(),k.apply(null,arguments)}function p(){i(),k.apply(null,arguments)}function f(e){s(),k(e)}function g(){o(),k.apply(null,arguments)}function m(){l(),k.apply(null,arguments)}function v(e){return A.classList.contains("open")&&(e?T.classList.contains(e):!0)}function y(){return T}function b(e,t){return jQuery(T).empty().removeClass(),null!=t&&jQuery(T).addClass(t),e=null==e?"":e+"",jQuery(C).empty().append(""===e?" ":e),T}function w(e,t,r,a,n){return jQuery(e).ariaClick(function(e){e.preventDefault(),"function"==typeof r&&r(e),k(t,n),"function"==typeof a&&a(e)})}function k(e,t){e=jQuery.extend({top:50},e),v()||(M=safeActiveElement()),jQuery(document.documentElement).addClass("ui-dialog-open"),jQuery(j).addClass("open"),null!==T.querySelector("img")&&jQuery(T).imagesLoaded().always(function(e){return function(){S({data:e})}}(e.top)),jQuery("body>:not(script,#store-area,#ui-bar,#ui-overlay,#ui-dialog)").attr("tabindex",-3).attr("aria-hidden",!0),jQuery("#ui-bar,#story").find("[tabindex]:not([tabindex^=-])").attr("tabindex",-2).attr("aria-hidden",!0);var r=E(e.top);jQuery(A).css(r).addClass("open").focus(),jQuery(window).on("resize.ui-resize",null,e.top,jQuery.throttle(40,S)),jQuery(document.body).on("click.ui-close",".ui-close",t,x).on("keypress.ui-close",".ui-close",function(e){(13===e.which||32===e.which)&&jQuery(this).trigger("click")})}function x(e){jQuery(document.body).off(".ui-close"),jQuery(window).off("resize.ui-resize"),jQuery(A).removeClass("open").css({left:"",right:"",top:"",bottom:""}),jQuery("#ui-bar,#story").find("[tabindex=-2]").removeAttr("aria-hidden").attr("tabindex",0),jQuery("body>[tabindex=-3]").removeAttr("aria-hidden").removeAttr("tabindex"),jQuery(C).empty(),jQuery(T).empty().removeClass(),jQuery(j).removeClass("open"),jQuery(document.documentElement).removeClass("ui-dialog-open"),null!==M&&(jQuery(M).focus(),M=null),e&&"function"==typeof e.data&&e.data(e)}function S(e){var t=jQuery(A),r=e&&"undefined"!=typeof e.data?e.data:50;if("block"===t.css("display")){t.css({display:"none"});var a=E(r);t.css(jQuery.extend({display:""},a))}}function E(e){null==e&&(e=50);var t=jQuery(window),r=jQuery(A),a={left:"",right:"",top:"",bottom:""};r.css(a);var n=t.width()-r.outerWidth(!0)-1,i=t.height()-r.outerHeight(!0)-1;return 32+I>=n&&(i-=I),32+I>=i&&(n-=I),32>=n?a.left=a.right=16:a.left=a.right=~~(n/2),32>=i?a.top=a.bottom=16:i/2>e?a.top=e:a.top=a.bottom=~~(i/2),Object.keys(a).forEach(function(e){""!==a[e]&&(a[e]+="px")}),a}var O=null,j=null,A=null,C=null,P=null,T=null,M=null,_=null,I=0;return Object.freeze(Object.defineProperties({},{init:{value:e},start:{value:t},setStoryElements:{value:r},patchOutlines:{value:a},buildDialogJumpTo:{value:n},buildDialogSaves:{value:i},buildDialogRestart:{value:s},buildDialogSettings:{value:o},buildDialogShare:{value:l},buildDialogAutoload:{value:u},buildLinkListFromPassage:{value:c},alert:{value:d},jumpto:{value:h},saves:{value:p},restart:{value:f},settings:{value:g},share:{value:m},isOpen:{value:v},body:{value:y},setup:{value:b},addClickHandler:{value:w},open:{value:k},close:{value:x}}))}(),Passage=function(){function e(e,t){if(this.title=Util.unescape(e),this.domId="passage-"+Util.slugify(this.title),t){if(this.element=t,this.tags=t.hasAttribute("tags")?t.getAttribute("tags").trim().splitOrEmpty(/\s+/):[],this.classes=[],this.tags.length>0){var r,a=[];r=/^(?:debug|nobr|passage|script|stylesheet|widget|twine\..*)$/i;for(var n=0;n<this.tags.length;++n)r.test(this.tags[n])||a.push(Util.slugify(this.tags[n]));a.length>0&&(t.className&&(a=a.concat(t.className.split(/\s+/))),this.classes=a.sort().filter(function(e,t,r){return 0===t||r[t-1]!==e}))}}else this.element=null,this.tags=[],this.classes=[]}var t=function(e){if(""===e)return"";var t=/(?:\\n|\\t|\\s|\\|\r)/g,r=RegExp(t.source),a=Object.freeze({"\\n":"\n","\\t":"	","\\s":"\\","\\":"\\","\r":""});return r.test(e)?e.replace(t,function(e){return a[e]}):e};return Object.defineProperties(e.prototype,{className:{get:function(){return this.classes.join(" ")}},text:{get:function(){return null==this.element?('<span class="error" title="%passage%">'+strings.errors.title+": "+strings.errors.nonexistentPassage+"</span>").replace(/%passage%/g,Util.escape(this.title)):t(this.element.textContent)}},description:{value:function(){if(null!=config.passages.descriptions)switch(typeof config.passages.descriptions){case"boolean":if(config.passages.descriptions)return this.title;break;case"object":if(config.passages.descriptions.hasOwnProperty(this.title))return config.passages.descriptions[this.title];break;case"function":var t=config.passages.descriptions.call(this);if(t)return t;break;default:throw new TypeError("config.passages.descriptions must be a boolean, object, or function")}return null==this._excerpt?e.getExcerptFromText(this.text):this._excerpt}},processText:{value:function(){var e=this.text;return this.tags.contains("nobr")&&(e=e.replace(/^\n+|\n+$/g,"").replace(/\n+/g," ")),this.tags.contains("Twine.image")&&(e="[img["+e+"]]"),e}},render:{value:function(){var t=insertElement(null,"div",this.domId,"passage");t.setAttribute("data-passage",this.title);for(var r=0;r<this.classes.length;++r)document.body.classList.add(this.classes[r]),t.classList.add(this.classes[r]);return Object.keys(prerender).forEach(function(e){"function"==typeof prerender[e]&&prerender[e].call(this,t,e)},this),Story.has("PassageHeader")&&new Wikifier(t,Story.get("PassageHeader").processText()),new Wikifier(t,this.processText()),Story.has("PassageFooter")&&new Wikifier(t,Story.get("PassageFooter").processText()),config.cleanupWikifierOutput&&convertBreaksToParagraphs(t),Object.keys(postrender).forEach(function(e){"function"==typeof postrender[e]&&postrender[e].call(this,t,e)},this),this._excerpt=e.getExcerptFromNode(t),t}}}),Object.defineProperties(e,{getExcerptFromNode:{value:function(e,t){if(!e.hasChildNodes())return"";var r=new RegExp("(\\S+(?:\\s+\\S+){0,"+(t>0?t-1:7)+"})"),a=e.textContent.trim();return""!==a&&(a=a.replace(/\s+/g," ").match(r)),a?a[1]+"…":"…"}},getExcerptFromText:{value:function(e,t){if(""===e)return"";var r=new RegExp("(\\S+(?:\\s+\\S+){0,"+(t>0?t-1:7)+"})"),a=e.replace(/<<.*?>>/g," ").replace(/<.*?>/g," ").trim().replace(/^\s*\|.*\|.*?$/gm,"").replace(/\[[<>]?img\[[^\]]*\]\]/g,"").replace(/\[\[([^|\]]*)(?:|[^\]]*)?\]\]/g,"$1").replace(/^\s*!+(.*?)$/gm,"$1").replace(/\'{2}|\/{2}|_{2}|@{2}/g,"").trim().replace(/\s+/g," ").match(r);return a?a[1]+"…":"…"}}}),e}(),Story=function(){function storyStart(){for(var i=0;i<_styles.length;++i)addStyle(_styles[i].text);for(var i=0;i<_scripts.length;++i)try{eval(_scripts[i].text)}catch(e){technicalAlert(_scripts[i].title,e.message)}for(var i=0;i<_widgets.length;++i)try{Wikifier.wikifyEval(_widgets[i].processText())}catch(e){technicalAlert(_widgets[i].title,e.message)}}function _storySetTitle(e){if(null==e||""===e)throw new Error("story title cannot be null or empty");document.title=_title=Util.unescape(e),_domId=Util.slugify(_title)}function storyTitle(){return _title}function storyDomId(){return _domId}function passagesHas(e){switch(typeof e){case"number":e+="";case"string":return _passages.hasOwnProperty(e);default:var t=typeof e;throw new TypeError("Story.has title parameter cannot be "+("object"===t?"an "+t:"a "+t))}}function passagesGet(e){switch(typeof e){case"number":e+="";case"string":return _passages.hasOwnProperty(e)?_passages[e]:new Passage(e||"(unknown)");default:var t=typeof e;throw new TypeError("Story.get title parameter cannot be "+("object"===t?"an "+t:"a "+t))}}function passagesLookup(e,t,r){r||(r="title");for(var a=Object.keys(_passages),n=[],i=0;i<a.length;++i){var s=_passages[a[i]];if(s.hasOwnProperty(e))switch(typeof s[e]){case"undefined":break;case"object":for(var o=0,l=s[e].length;l>o;++o)if(s[e][o]==t){n.push(s);break}break;default:s[e]==t&&n.push(s)}}return n.sort(function(e,t){return e[r]==t[r]?0:e[r]<t[r]?-1:1}),n}var _title="",_domId="",_passages={},_styles=[],_scripts=[],_widgets=[],storyInit;return storyInit=function(){if(config.passages.start=function(){var e="";return""!==e?e:"Start"}(),jQuery("#store-area").children(':not([tags~="Twine.private"],[tags~="annotation"])').each(function(){var e=jQuery(this),t=new Passage(e.attr("tiddler"),this);t.tags.contains("stylesheet")?_styles.push(t):t.tags.contains("script")?_scripts.push(t):t.tags.contains("widget")?_widgets.push(t):_passages[t.title]=t}),!_passages.hasOwnProperty("StoryTitle"))throw new Error("cannot find the StoryTitle special passage");var e=document.createDocumentFragment();new Wikifier(e,_passages.StoryTitle.processText().trim()),_storySetTitle(e.textContent.trim())},Object.freeze(Object.defineProperties({},{passages:{value:_passages},styles:{value:_styles},scripts:{value:_scripts},widgets:{value:_widgets},init:{value:storyInit},start:{value:storyStart},title:{get:storyTitle},domId:{get:storyDomId},has:{value:passagesHas},get:{value:passagesGet},lookup:{value:passagesLookup}}))}(),State=function(){function e(){if(Story.has("StoryInit"))try{Wikifier.wikifyEval(Story.get("StoryInit").text)}catch(e){technicalAlert("StoryInit",e.message)}if(config.history.hasOwnProperty("mode"))throw new Error("config.history.mode has been deprecated and is no longer used by SugarCube, please remove it from your code");if(config.history.hasOwnProperty("tracking"))throw new Error("config.history.tracking has been deprecated, use config.history.maxStates instead");if(config.history.maxStates=Math.max(1,Number(config.history.maxStates)),(isNaN(config.history.maxStates)||!isFinite(config.history.maxStates))&&(config.history.maxStates=100),1===config.history.maxStates&&(config.history.controls=!1),null==config.passages.start)throw new Error("starting passage not selected");if(!Story.has(config.passages.start))throw new Error('starting passage ("'+config.passages.start+'") not found');if(!r()){var e=!0;switch(typeof config.saves.autoload){case"boolean":config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(e=!Save.autosave.load());break;case"string":"prompt"===config.saves.autoload&&Save.autosave.ok()&&Save.autosave.has()&&(e=!1,UI.buildDialogAutoload(),UI.open());break;case"function":Save.autosave.ok()&&Save.autosave.has()&&config.saves.autoload()&&(e=!Save.autosave.load())}e&&R(config.passages.start)}}function t(){session.delete("state"),window.location.reload()}function r(){if(session.has("state")){var e=session.get("state");return null==e?!1:(n(e),!0)}return!1}function a(e){var t={index:W};return e?t.history=clone(Q):t.delta=M(Q),0!==F&&(t.expired=F),""!==H&&(t.last=H),""!==B&&(t.unique=B),null!==q&&(t.seed=q.seed),t}function n(e,t){if(null==e)throw new Error("state object is null or undefined");if(!e.hasOwnProperty(t?"history":"delta")||0===e[t?"history":"delta"].length)throw new Error("state object has no history or history is empty");if(!e.hasOwnProperty("index"))throw new Error("state object has no index");if(null!==q&&!e.hasOwnProperty("seed"))throw new Error("state object has no seed, but PRNG is enabled");if(null===q&&e.hasOwnProperty("seed"))throw new Error("state object has seed, but PRNG is disabled");Q=t?clone(e.history):_(e.delta),W=e.index,F=e.hasOwnProperty("expired")?e.expired:0,H=e.hasOwnProperty("last")?e.last:"",B=e.hasOwnProperty("unique")?e.unique:"",$=null,e.hasOwnProperty("seed")&&(q.seed=e.seed),m(W),D()}function i(){return a(!0)}function s(e){return n(e,!0)}function o(){return F}function l(){return H}function u(){return B}function c(){return $}function d(e,t){return{title:null==e?"":String(e),variables:null==t?{}:clone(t)}}function h(){return U}function p(){return W}function f(){return U.title}function g(){return U.variables}function m(e){if(null==e)throw new Error("moment activation attempted with null or undefined");switch(typeof e){case"object":U=clone(e);break;case"number":if(w())throw new Error("moment activation attempted with index on empty history");if(0>e||e>=b())throw new RangeError("moment activation attempted with out-of-bounds index; need [0, "+(b()-1)+"], got "+e);U=clone(Q[e]);break;default:throw new TypeError('moment activation attempted with a "'+typeof e+'"; must be an object or valid history stack index')}return null!==q&&(q=SeedablePRNG.unmarshal({seed:q.seed,pull:U.pull})),session.set("state",a()),jQuery.event.trigger("tw:historyupdate"),U}function v(){return Q}function y(){return W+1}function b(){return Q.length}function w(){return 0===Q.length}function k(){return 0!==Q.length?Q[Q.length-1]:null}function x(){return 0!==Q.length?Q[0]:null}function S(e){return w()||0>e||e>W?null:Q[e]}function E(e){return w()?null:(e=1+(e?Math.abs(e):0),e>y()?null:Q[y()-e])}function O(e){if(w()||null==e||""===e)return!1;for(var t=W;t>=0;--t)if(Q[t].title===e)return!0;return!1}function j(e){if(null==e)return y();if(y()<b()&&Q.splice(y(),b()-y()),Q.push(e),q&&(k().pull=q.pull),0!==config.history.maxStates)for(;b()>config.history.maxStates;)H=Q.shift().title,H!==x().title&&(B=H),++F;return W=b()-1,m(W),y()}function A(e){return null==e||0>e||e>=b()||e===W?!1:(W=e,m(W),D(),!0)}function C(e){return null==e||0===e?!1:A(W+e)}function P(){return C(-1)}function T(){return C(1)}function M(e){if(!Array.isArray(e))return null;if(0===e.length)return[];for(var t=[clone(e[0])],r=1,a=e.length;a>r;++r)t.push(Util.diff(e[r-1],e[r]));return t}function _(e){if(!Array.isArray(e))return null;if(0===e.length)return[];for(var t=[clone(e[0])],r=1,a=e.length;a>r;++r)t.push(Util.patch(t[r-1],e[r]));return t}function I(e,t){if(!w())throw new Error("State.initPRNG must be called during initialization, within either a script section (Twine 1: a script-tagged passage, Twine 2: Story JavaScript) or the StoryInit special passage");q=new SeedablePRNG(e,t),U.pull=q.pull}function L(){return q?q.random():Math.random()}function N(e,t,r){var a=!1;switch(r){case undefined:break;case"replace":case"back":a=!0;break;default:throw new Error('State.display option parameter called with obsolete value "'+r+'"; please notify the developer')}R(e,a)}function D(){return R(U.title,!0)}function R(e,t){runtime.temp={};var r=Story.get(e);if(Object.keys(prehistory).forEach(function(e){"function"==typeof prehistory[e]&&prehistory[e].call(this,e)},r),t||j(d(r.title,U.variables)),document.body.className&&(document.body.className=""),Object.keys(predisplay).forEach(function(e){"function"==typeof predisplay[e]&&predisplay[e].call(this,e)},r),Story.has("PassageReady"))try{Wikifier.wikifyEval(Story.get("PassageReady").text)}catch(e){technicalAlert("PassageReady",e.message)}var a=r.render();$=Date.now();var n=document.getElementById("passages");if(n.hasChildNodes())if("number"==typeof config.passages.transitionOut||"string"==typeof config.passages.transitionOut&&""!==config.passages.transitionOut&&""!==config.transitionEndEventName)for(var i=Array.from(n.childNodes),s=0;s<i.length;++s){var o=i[s];if(o.nodeType===Node.ELEMENT_NODE&&o.classList.contains("passage")){if(o.classList.contains("passage-out"))continue;o.id="out-"+o.id,o.classList.add("passage-out"),"string"==typeof config.passages.transitionOut?jQuery(o).on(config.transitionEndEventName,function(e){this.parentNode&&e.originalEvent.propertyName===config.passages.transitionOut&&this.parentNode.removeChild(this)}):setTimeout(function(){o.parentNode&&o.parentNode.removeChild(o)},config.passages.transitionOut)}else o.parentNode.removeChild(o)}else removeChildren(n);if(a.classList.add("passage-in"),n.appendChild(a),setTimeout(function(){a.classList.remove("passage-in")},1),document.title=config.passages.displayTitles&&r.title!==config.passages.start?r.title+" | "+Story.title:Story.title,window.scroll(0,0),Story.has("PassageDone"))try{Wikifier.wikifyEval(Story.get("PassageDone").text)}catch(e){technicalAlert("PassageDone",e.message)}switch(Object.keys(postdisplay).forEach(function(e){"function"==typeof postdisplay[e]&&postdisplay[e].call(this,e)},r),config.ui.updateStoryElements&&UI.setStoryElements(),UI.patchOutlines(!0),jQuery("#story").find("a[href]:not(.link-external)").addClass("link-external").end().find("a,link,button,input,select,textarea").not("[tabindex]").attr("tabindex",0),typeof config.saves.autosave){case"boolean":config.saves.autosave&&Save.autosave.save();break;case"string":r.tags.contains(config.saves.autosave)&&Save.autosave.save();break;case"object":Array.isArray(config.saves.autosave)&&r.tags.some(function(e){
return config.saves.autosave.contains(e)})&&Save.autosave.save()}return a}var Q=[],U=d(),W=-1,F=0,H="",B="",$=null,q=null;return Object.freeze(Object.defineProperties({},{init:{value:e},restart:{value:t},marshalForSave:{value:i},unmarshalForSave:{value:s},expired:{get:o},expiredLast:{get:l},expiredUnique:{get:u},lastPlay:{get:c},active:{get:h},activeIndex:{get:p},passage:{get:f},variables:{get:g},history:{get:v},length:{get:y},size:{get:b},isEmpty:{value:w},top:{value:k},bottom:{value:x},index:{value:S},peek:{value:E},has:{value:O},goTo:{value:A},go:{value:C},backward:{value:P},forward:{value:T},deltaEncode:{value:M},deltaDecode:{value:_},initPRNG:{value:I},random:{value:L},display:{value:N},show:{value:D},play:{value:R}}))}(),History=State,visitedTag=visitedTags;window.SugarCube={};var version=Object.freeze({title:"SugarCube",major:2,minor:0,patch:0,prerelease:"beta.8",build:6174,date:new Date("2015-09-28T20:01:22.952Z"),extensions:{},toString:function(){return this.major+"."+this.minor+"."+this.patch+(this.prerelease?"-"+this.prerelease:"")+"+"+this.build},short:function(){return this.title+" (v"+this.major+"."+this.minor+"."+this.patch+(this.prerelease?"-"+this.prerelease:"")+")"},long:function(){return this.title+" v"+this.toString()+" ("+this.date.toUTCString()+")"}}),runtime=Object.defineProperties({},{temp:{writable:!0,value:{}}}),config=Object.seal({addVisitedLinkClass:!1,cleanupWikifierOutput:!1,loadDelay:0,history:Object.seal({controls:!0,maxStates:100}),macros:Object.seal({ifAssignmentError:!0,maxLoopIterations:1e3}),passages:Object.seal({descriptions:undefined,displayTitles:!1,start:undefined,transitionOut:undefined}),saves:Object.seal({autoload:undefined,autosave:undefined,id:"untitled-story",isAllowed:undefined,onLoad:undefined,onSave:undefined,slots:8,version:undefined}),ui:Object.seal({stowBarInitially:!1,updateStoryElements:!0}),transitionEndEventName:function(){for(var e={transition:"transitionend",MSTransition:"msTransitionEnd",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend"},t=Object.keys(e),r=document.createElement("div"),a=0;a<t.length;++a)if(r.style[t[a]]!==undefined)return e[t[a]];return""}()}),macros={},tale=Story,state=State,storage={},session={},settings={},setup={},prehistory={},predisplay={},postdisplay={},prerender={},postrender={};jQuery(function(){try{document.normalize&&document.normalize(),Story.init(),storage=new KeyValueStore("webStorage",!0,Story.domId),session=new KeyValueStore("webStorage",!1,Story.domId),config.saves.id=Story.domId,UI.init(),session.has("rcWarn")||"cookie"!==storage.name||(session.set("rcWarn",1),window.alert(strings.warnings.degraded.replace(/%identity%/g,strings.identity))),Story.start(),Save.init(),Setting.init(),Macro.init(),State.init(),UI.start()}catch(e){return fatalAlert(null,e.message)}window.SugarCube={Browser:Browser,Has:Has,Macro:Macro,Passage:Passage,Save:Save,Setting:Setting,State:State,Story:Story,UI:UI,Util:Util,Wikifier:Wikifier,config:config,macros:macros,runtime:runtime,session:session,settings:settings,setup:setup,storage:storage,version:version}})}(window,window.document,jQuery);}
	</script>
</body>
</html>

